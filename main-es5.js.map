{"version":3,"sources":["webpack:///src/app/components/start/start.component.ts","webpack:///src/app/components/start/start.component.html","webpack:///src/app/services/wallet/wallet.service.ts","webpack:///src/app/services/message/message.service.ts","webpack:///util (ignored)","webpack:///buffer (ignored)?63e7","webpack:///util (ignored)?4c0f","webpack:///util (ignored)?42b2","webpack:///fs (ignored)?4b4e","webpack:///src/app/components/settings/settings.component.ts","webpack:///src/app/components/settings/settings.component.html","webpack:///util (ignored)?f34d","webpack:///src/app/components/header/header.component.ts","webpack:///src/app/components/header/header.component.html","webpack:///src/app/services/operation/operation.service.ts","webpack:///buffer (ignored)","webpack:///src/app/components/new-implicit/new-implicit.component.html","webpack:///src/app/components/new-implicit/new-implicit.component.ts","webpack:///src/app/services/coordinator/coordinator.service.ts","webpack:///src/app/services/deeplink/deeplink.service.ts","webpack:///crypto (ignored)","webpack:///crypto (ignored)?41a1","webpack:///fs (ignored)","webpack:///src/app/services/indexer/indexer.service.ts","webpack:///src/methods/node.js (ignored)","webpack:///node.js (ignored)","webpack:///src/app/pipes/error-handling.pipe.ts","webpack:///src/app/views/error/404.component.ts","webpack:///src/app/views/error/404.component.html","webpack:///src/app/components/torus/torus.component.html","webpack:///src/app/components/torus/torus.component.ts","webpack:///buffer (ignored)?2c4a","webpack:///src/app/components/connect-ledger/connect-ledger.component.html","webpack:///src/app/components/connect-ledger/connect-ledger.component.ts","webpack:///src/environments/environment.ts","webpack:///src/app/interfaces.ts","webpack:///src/app/services/token/token.service.ts","webpack:///src/app/services/torus/torus.service.ts","webpack:///src/app/components/embedded/signin/signin.component.html","webpack:///src/app/components/embedded/signin/signin.component.ts","webpack:///src/app/components/footer/footer.component.ts","webpack:///src/app/components/footer/footer.component.html","webpack:///src/app/components/send/send.component.html","webpack:///src/app/components/send/send.component.ts","webpack:///src/app/services/lookup/lookup.service.ts","webpack:///src/app/pipes/time-ago.pipe.ts","webpack:///node_modules/moment/locale sync ^\\.\\/.*$","webpack:///src/app/components/accounts/accounts.component.ts","webpack:///src/app/components/accounts/accounts.component.html","webpack:///src/app/components/permission-request/permission-request.component.ts","webpack:///src/app/components/permission-request/permission-request.component.html","webpack:///src/app/app.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/services/encryption/encryption.service.ts","webpack:///src/app/services/input-validation/input-validation.service.ts","webpack:///src/app/components/agreement/terms-of-use/terms-of-use.component.ts","webpack:///src/app/components/agreement/terms-of-use/terms-of-use.component.html","webpack:///src/app/components/logged-in/logged-in.component.ts","webpack:///src/app/components/logged-in/logged-in.component.html","webpack:///src/app/services/delegate/delegate.service.ts","webpack:///src/data/bakers-list.ts","webpack:///src/app/pipes/delegator-name.pipe.ts","webpack:///src/app/services/export/export.service.ts","webpack:///src/app/app.module.ts","webpack:///src/app/services/indexer/tzkt/tzkt.service.ts","webpack:///src/app/components/token/token.component.ts","webpack:///src/app/components/token/token.component.html","webpack:///src/$_lazy_route_resource lazy namespace object","webpack:///src/app/services/estimate/estimate.service.ts","webpack:///src/app/views/error/500.component.ts","webpack:///src/app/views/error/500.component.html","webpack:///src/app/components/spinner/spinner.component.ts","webpack:///src/app/components/spinner/spinner.component.html","webpack:///src/app/components/embedded/embedded.component.html","webpack:///src/app/components/embedded/embedded.component.ts","webpack:///src/app/components/delegate/delegate.component.html","webpack:///src/app/components/delegate/delegate.component.ts","webpack:///src/app/components/agreement/privacy-policy/privacy-policy.component.ts","webpack:///src/app/components/agreement/privacy-policy/privacy-policy.component.html","webpack:///src/app/pipes/truncate.pipe.ts","webpack:///src/app/services/ledger/ledger.service.ts","webpack:///src/app/components/receive/receive.component.ts","webpack:///src/app/components/receive/receive.component.html","webpack:///src/app/services/tzrate/tzrate.service.ts","webpack:///src/app/components/account-view/account-view.component.ts","webpack:///src/app/components/account-view/account-view.component.html","webpack:///src/app/services/wallet/wallet.ts","webpack:///src/app/components/qr-scanner/qr-scanner.component.html","webpack:///src/app/components/qr-scanner/qr-scanner.component.ts","webpack:///src/app/components/mnemonic-import/mnemonic-import.component.ts","webpack:///src/app/components/mnemonic-import/mnemonic-import.component.html","webpack:///src/app/services/beacon/beacon.service.ts","webpack:///src/app/components/activate/activate.component.ts","webpack:///src/app/components/activate/activate.component.html","webpack:///src/app/components/agreement/agreement.component.ts","webpack:///src/app/components/agreement/agreement.component.html","webpack:///src/app/services/activity/activity.service.ts","webpack:///src/app/services/import/import.service.ts","webpack:///src/app/components/uri-handler/uri-handler.component.ts","webpack:///src/app/components/uri-handler/uri-handler.component.html","webpack:///src/app/components/sign-expr/sign-expr.component.html","webpack:///src/app/components/sign-expr/sign-expr.component.ts","webpack:///src/app/app-routing.module.ts","webpack:///src/app/components/new-wallet/new-wallet.component.html","webpack:///src/app/components/new-wallet/new-wallet.component.ts","webpack:///src/app/components/messages/messages.component.ts","webpack:///src/app/components/messages/messages.component.html","webpack:///src/app/services/balance/balance.service.ts","webpack:///src/main.ts"],"names":["StartComponent","walletService","translate","router","route","deeplinkService","location","animationActive","queryParams","filter","params","type","subscribe","set","replaceState","wallet","navigate","selector","templateUrl","styleUrls","WalletService","encryptionService","operationService","torusService","storageId","generateMnemonic","mnemonic","password","passphrase","hdSeed","seed","mnemonicToSeed","entropy","Buffer","from","mnemonicToEntropy","keyPair","seed2keyPair","keyPairFromAccountIndex","encrypt","encrypted","encryptedSeed","chiphertext","iv","iv2","bumpIV","encryptedEntropy","data","exportKeyStoreInit","HdWallet","FullWallet","pkh","pk","pwd","console","log","decrypt","salt","IV","sk","implicitAccounts","spPrivKeyToKeyPair","getTorusKeyPair","verifier","id","getImplicitAccount","Error","account","derivationPath","seedToKeyPair","entropyToMnemonic","slice","pk2pkh","pkToPkh","push","length","storeWallet","kt","manager","implicitAccount","origAcc","originatedAccounts","warn","address","getAccounts","findIndex","a","index","addImplicitAccount","instanceId","sessionStorage","removeItem","localStorage","storeKey","provider","version","walletType","Date","now","setItem","JSON","stringify","localStorageId","getLocalStorageId","getStorage","walletData","getItem","parsed","parse","parsedWalletData","wd","deserializeStoredWallet","clearWallet","name","initTorus","origin","XTZrate","totalBalanceUSD","totalBalanceXTZ","lookups","implicit","impAcc","balanceUSD","balanceXTZ","delegate","activitiesCounter","state","toString","activities","activityMigration","tokens","originated","map","activity","source","undefined","destination","isEmbeddedTorusWallet","MessageService","spinnerOn","spinnerText","messages","defaultTime","pairingCompleteMsg","message","seconds","msg","timeout","email","amount","username","twitterId","handler","loader","delay","setTimeout","i","splice","addSuccess","text","beaconService","SettingsComponent","messageService","wideAccounts","getImplicitAccounts","syncBeaconState","onResize","window","innerWidth","HeaderComponent","lookupService","coordinatorService","settings","CONSTANTS","impAccs","stopAll","clear","displayName","logout","activeAccount","httpOptions","headers","OperationService","http","errorHandlingPipe","tokenService","nodeURL","NODE_URL","prefix","tz1","Uint8Array","tz2","tz3","edpk","sppk","edsk","spsk","edsig","spsig","sig","o","B","TZ","KT","microTez","feeHardCap","secret","getHeader","pipe","header","fop","branch","hash","contents","kind","post","opbytes","sopbytes","Array","join","protocol","signature","preApplyResult","final","opCheck","err","errHandler","newPkh","success","payload","opHash","fee","keys","get","actions","counter","Number","script","getManagerScript","times","gas_limit","storage_limit","balance","public_key","operation","transactions","tokenTransfer","createTransactionObject","currentFee","gasLimit","storageLimit","invocation","getAsset","decimals","contractAddress","getFA12Transaction","to","getFA2Transaction","parameters","transactionOp","managerTransaction","getContractPkhTransaction","getContractKtTransaction","delegationOp","getContractDelegation","getContractUnDelegation","origination","localForge","localOpbytes","chain_id","applied","checkApplied","unsignedOperation","signed","sign","sbytes","metadata","operation_result","originated_contracts","sig2edsig","tz2address","noReveal","decompress","torusReq","jsonrpc","method","pub_key_X","X","pub_key_Y","Y","url","NETWORK","ans","result","PublicKey","status","errors","internal_operation_results","error","transform","statusText","forge","localForgedBytes","contract","listings","operationLevel","operationHash","opHashes","opIndex","op","managerPubkey","manager_pubkey","opBytes","verify","buf2hex","b58cdecode","b58cencode","privateKey","publicKey","validMnemonic","e","pkDecoded","secretKey","match","hex2buf","keyFromPrivate","prefixVal","getPublic","getY","toArray","pad","fill","concat","getX","pubX","pubY","key","keyFromPublic","x","y","decodedPk","hexPk","secp256k1","compressed","uncompressed","uncompressPublicKey","xy","hex","h","parseInt","buffer","byteArray","hexParts","paddedHex","prefixx","n","enc","bytes","includes","canonical","r","s","count","value","byte","add","entrypoint","prim","args","string","pkHex","code","annots","storage","opJson","addresses","amounts","fa12ref","tokenId","fa2ref","NewImplicitComponent","modalService","cdRef","modalOpen","errorMsg","openPkhSpot","scrollBarWidth","document","body","offsetWidth","style","marginRight","overflow","inputElem","pwdView","nativeElement","focus","addWarning","startSpinner","incrementAccountIndex","start","closeModal","stopSpinner","State","CoordinatorService","activityService","tzrateService","balanceService","delegateService","scheduler","Map","defaultDelayActivity","MAINNET","shortDelayActivity","defaultDelayPrice","accounts","startXTZ","tzrateInterval","getTzrate","setInterval","size","scheduleData","UpToDate","interval","update","stateCounter","updateAccountData","addressExists","addUnconfirmedOperations","Wait","changeState","setDelay","updateTransactions","upToDate","Updating","acc","getAccount","latestActivity","age","getTime","timestamp","shift","newState","clearInterval","time","stop","updateAccountBalance","handleDelegateResponse","transaction","block","unshift","delegation","DeeplinkService","pairingJson","extractPairingJson","qrPayload","providedIn","IndexerService","tzktService","getContractAddresses","knownTokenIds","accountInfo","getOperations","getTokenMetadata","ErrorHandlingPipe","ERROR_LIST","errorId","withObj","replace","errorMessage","indexOf","P404Component","TorusComponent","importService","activeLogin","loginTorus","userInfo","importWalletFromPk","typeOfLogin","verifierId","then","addError","ConnectLedgerComponent","ledgerService","inputValidationService","activePanel","defaultPath","defaultText","pendingLedgerConfirmation","isHDDerivationPathCustom","path","getPublicAddress","importFromPk","validPublicKey","setDefaultPath","getPk","environment","production","NAME","BLOCK_EXPLORER_URL","ASSETS","category","symbol","description","displayUrl","thumbnailUrl","symbolPreference","nonTransferable","booleanAmount","TRUSTED_TOKEN_CONTRACTS","WalletType","PeriodKind","TokenService","indexerService","AUTO_DISCOVER","contracts","exploredIds","loadMetadata","tokenIdArray","split","token","tokenIds","contractKeys","Object","contractKey","tokenKeys","tokenKey","currentKeys","newKeys","explore","isNaN","tokenType","tokenCategory","defaultImg","displayUri","thumbnailUri","addAsset","saveMetadata","firstCheck","lastCheck","reCheck","metadataJson","contractAddresses","baseUnit","div","toFixed","GOOGLE","REDDIT","TWITTER","AUTH_DOMAIN","TorusService","torus","nodeDetails","verifierMaps","testnet","clientId","caseSensitiveVerifierID","mainnet","_loginToConnectionMap","domain","verifierMap","proxy","network","verifierMapKeys","torusdirectsdk","baseUrl","enableLogging","proxyContractAddress","init","skipSw","selectedVerifier","fetchNodeDetails","proxyAddress","getNodeDetails","torusNodeEndpoints","torusNodePub","torusIndexes","sanitizedVerifierId","toLocaleLowerCase","twitterLookup","spPointsToPkh","req","fetch","referrerPolicy","json","jwtParams","login_hint","triggerLogin","loginDetails","SigninComponent","loading","loginResponse","emit","loginData","Promise","resolve","FooterComponent","darkText","setFooter","events","event","altFooter","zeroTxParams","gas","burn","SendComponent","estimateService","beaconMode","operationResponse","defaultTransactionParams","costPerByte","torusVerifier","torusPendingLookup","torusLookupAddress","torusLookupId","torusTwitterId","advancedForm","sendMax","hideAmount","batchParameters","batchParamIndex","parametersFormat","burnFee","isMultipleDestinations","toMultipleDestinationsString","toMultipleDestinations","activeView","showTransactions","simSemaphore","formInvalid","latestSimError","prevEquiClass","ledgerError","showBtn","changes","operationRequest","operationDetails","loadBeaconPayload","openModal","entries","num","updateParameters","updateDefaultValues","validateBatch","beaconTokenTransfer","asset","toPkh","activeAccountChange","parametersToMicheline","isKnownTokenContract","parseTokenTransfer","clearForm","amountChange","amountInputView","preLoadData","checkInput","clearFee","prepTransactions","checkBalance","isLedgerWallet","getKeys","sendTransaction","broadCastLedgerTransaction","sendResponse","pwdValid","instant","accountBalance","numberWithCommas","parts","stopPropagation","checkMaxAmount","max","maxToSend","maxAmount","minus","getTokenBalance","finalCheck","toAddress","meta","alias","transfer","boost","torusNotification","requestLedgerSignature","signOperation","signHash","ledgerPreHash","signedOp","signedOperation","broadcast","clearTorus","micheline","invalidInputMultiple","invalidInputSingle","plus","tx","gt","maxKt","maxTz","estimateFees","totalAmount","prevSimError","equiClass","callback","res","updateMaxAmount","estimate","sender","txs","customLimits","numberOfTxs","txsLimit","reveal","torusAccount","torusLookup","indent","newline","checkReceiverAndAmount","toMultipleDestinationsArray","trim","validationError","forEach","item","singleSendDataArray","singleSendDataCheckresult","batchSpace","totalSent","display","totalFee","getTotalFee","getTotalBurn","mul","validateReceiverAddress","lookupPkh","formatAmount","emailNotify","redditNotify","twitterNotify","recipientKind","short","input","charCode","which","keyCode","preventDefault","getAssetName","LookupType","LookupService","records","pendingLookups","initCheck","lookupType","indexTop","torusKeyLookup","Verifiers","Google","Reddit","verifierArray","Twitter","mark","record","entry","j","party","Alias","TimeAgoPipe","sec","secs","mn","mns","hr","hrs","day","days","month","months","year","years","timeNow","diff","output","minutes","pure","webpackContext","webpackContextResolve","__webpack_require__","webpackContextKeys","module","exports","$event","AccountsComponent","startAll","copyToClipboard","shortAddress","PermissionRequestComponent","permissionResponse","selectedAccount","permissionRequest","removeBeaconMsg","reset","scope","AppComponent","embedded","setDefaultLang","languagePreference","browserLang","getBrowserLang","use","checkEmbedded","loadStoredWallet","scrollTo","addEventListener","handleStorageEvent","oldValue","newValue","reload","lang","language","startsWith","EncryptionService","plaintext","encrypt_v2","decrypt_v1","decrypt_v2","aesCtr","ctr","fromBytes","toBytes","salty","cipher","createCipher","byteStringBuffer","createBuffer","finish","toHex","mode","tag","chipher","decipher","createDecipher","pass","bumps","buf","InputValidationService","mnemonics","score","validAddress","loginType","redditAccount","twitterAccount","re","test","decimalsPart","expr","RegExp","m","TermsOfUseComponent","LoggedInComponent","DelegateService","getDelegate","BAKERSLIST","baker_name","identity","image","DelegatorNamePipe","b","ExportService","blob","Blob","filename","DEFAULT_PERFECT_SCROLLBAR_CONFIG","suppressScrollX","HttpLoaderFactory","AppModule","forRoot","provide","useFactory","deps","declarations","imports","providers","bootstrap","TzktService","bcd","response","originatedContract","unknownTokenIds","token_id","sort","last_action","digest","hasInternals","target","extractEntrypoint","newDelegate","contractBalance","obj","ops","transfers","tokenTxs","operations","tokenKind","tags","contractMetadata","tokenMetadata","datas","flattern","uriToUrl","all","merged","isArray","childKeys","childKey","getBigMapIds","bigMapId","extractTokenMetadata","extractContractMetadata","fetchApi","tokenBigMap","lookFor","strings","numbers","booleans","child","children","child2","child3","toUpperCase","offChainMeta","contractBigMap","contractMeta","interfaces","admin","uri","TokenComponent","tokenBalance","searchTimeMs","webpackEmptyAsyncContext","hardGasLimit","hardStorageLimit","EstimateService","revealGasLimit","queue","chainId","toPromise","getCounter","getManager","retry","_estimate","extraGas","simulation","simulate","limits","content","getOpUsage","gasUsage","storageUsage","averageGasLimit","averageStorageLimit","dtp","recommendFee","balance_updates","balanceUpdate","change","consumed_gas","internalResult","Math","round","customUsage","getUsageException","minimalFee","feePerByte","feePerGasUnit","gasUnits","numberOfOperations","ceil","totalGasLimit","totalStorageLimit","P500Component","SpinnerComponent","MessageTypes","EmbeddedComponent","allowedOrigins","login","operationRequests","handleRequest","evt","loginRequest","beaconTypeGuard","noWalletError","logoutRequest","logoutResponse","background","attachEvent","filteredUserInfo","generateInstanceId","userData","importAccount","abort","failed","resp","parent","postMessage","base58encode","DelegateComponent","exportService","recommendedFee","revealFee","pkhFee","ktFee","checkReveal","toPkhView","invalidInput","storedFee","storedDelegate","sendDelegation","modalRef1","hide","modalRef2","modalRef3","isRevealed","revealed","checkSource","downloadOperationData","PrivacyPolicyComponent","TruncatePipe","endTrail","limit","trail","returnString","endTrailstring","substring","LedgerService","transport","create","setTransport","transportCheck","xtz","getAddress","hex2pk","ReceiveComponent","showReceiveFormat","btnOutline","dropdownItem","getQR","getElementById","activeAddress","errorCorrectionLevel","scaleFactor","color","light","canvas","template1","show","modal1","TzrateService","apiUrl","price","tezos","usd","updateFiatBalances","tot","AccountViewComponent","timeAgoPipe","trigger","snapshot","paramMap","operationType","getCounterparty","baseURL","sentKind","Wallet","originatedAccount","LegacyWalletV1","encrypedSeed","LegacyWalletV2","LegacyWalletV3","TorusWallet","EmbeddedTorusWallet","LedgerWallet","Account","ImplicitAccount","OriginatedAccount","ktAddress","managerPkh","managerPk","Activity","Token","QrScannerComponent","manualInput","scan","hasCamera","WORKER_PATH","qrScanner","videoplayer","handleQrCode","pairInfo","pairingInfo","QRtoPairingJson","preNotifyPairing","addPeer","ev","pairingString","clipboardData","getData","MnemonicImportComponent","showTacos","MIN_PWD_LENGTH","importOption","hdImport","pwdStrength","Downloaded","fileName","firefox","checkBrowser","navigator","userAgent","toLowerCase","validPwd","pwd1","pwd2","createEncryptedWallet","passwordStrengthDisplay","downloadWallet","importWalletFromObject","keyFile","typeCheckFile","pwdRequired","walletJson","importWalletFromJson","files","fileToUpload","validateFile","fileNotSupported","reader","FileReader","readAsText","onload","importPreCheck","ext","lastIndexOf","BeaconService","client","peers","permissions","pairInfoJson","peersJson","newPublicKey","peer","addBeaconWait","getPeers","getPermissions","removePeer","senderId","peerResponse","removeAppMetadata","removeAllPermissions","removePermission","accountIdentifier","respondWithError","NOT_GRANTED_ERROR","NETWORK_NOT_SUPPORTED","ABORTED_ERROR","NO_PRIVATE_KEY_FOUND_ERROR","TOO_MANY_OPERATIONS","UNKNOWN_ERROR","PARAMETERS_INVALID_ERROR","BROADCAST_ERROR","errorType","requestMessage","beaconId","respond","PermissionResponse","scopes","SignPayloadResponse","signingType","ActivateComponent","activate","activateFailed","AgreementComponent","displayAgreement","accepted","overflowY","open","ActivityService","maxTransactions","getTransactonsCounter","handleUnknownTokenIds","updateTokenBalances","getAllTransactions","tok","searchMetadata","updateTokenBalance","oldActivities","oldState","promptNewActivities","counterParty","check","newActivities","timeDiff","withLookup","counterPartyAddress","ImportService","initStorage","findContracts","verifierDetails","ledgerImport","torusImport","updateTwitterName","addOriginatedAccount","UriHandlerComponent","signRequest","connectApp","connect","SignPayloadRequest","rejectOnNetwork","PermissionRequest","OperationRequest","handlePermissionRequest","isSupportedOperationRequest","rejectOnUnknown","isSupportedSignPayload","popPairingJson","isConnected","OPERATION_REQUEST","SIGN","rejectOnSourceAddress","sourceAddress","rejectOnTooManyOps","rejectOnPermission","invalidParameters","rejectOnParameters","hexString","parsedPayload","fromHexString","rejectOnUserAbort","rejectOnBroadcastError","OperationResponse","transactionHash","approvePermissionRequest","approveSignPayloadRequest","signResponse","SignExprComponent","pwdInvalid","isMessage","isMessageSigning","acceptSigning","isTorusWallet","hexsigToEdsig","routes","component","redirectTo","title","AppRoutingModule","relativeLinkResolution","NewWalletComponent","userMnemonic","hideBlur","ekfDownloaded","generateSeed","createNewWallet","MNEMONIC","array","wordsToVerify","mnemonicLength","floor","random","wordInput","blur","MessagesComponent","subject","hostname","mailtoFormat","redditPmFormat","twitterPmFormat","encodeURI","encodedBody","getHostName","accountType","t","BalanceService","getAccountBalance","getBalance","newBalance","updateTotalBalance","bootstrapModule"],"mappings":"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","file":"main-es5.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { DeeplinkService } from '../../services/deeplink/deeplink.service';\r\nimport 'rxjs/add/operator/filter';\r\nimport { Location } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-start',\r\n  templateUrl: './start.component.html',\r\n  styleUrls: ['./start.component.scss']\r\n})\r\nexport class StartComponent implements OnInit {\r\n  constructor(\r\n    private walletService: WalletService,\r\n    public translate: TranslateService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private deeplinkService: DeeplinkService,\r\n    private location: Location,\r\n  ) {\r\n  }\r\n  animationActive = true;\r\n\r\n  async ngOnInit() {\r\n    this.route.queryParams\r\n      .filter(params => params.type)\r\n      .subscribe(params => {\r\n        this.deeplinkService.set(params);\r\n        this.location.replaceState('');\r\n      }\r\n    );\r\n    if (this.walletService.wallet) {\r\n      this.router.navigate(['/accounts']);\r\n    }\r\n  }\r\n}\r\n","<div id=\"wrapper\">\r\n  <div>\r\n    <div class=\"top-container\">\r\n      <div class=\"logo-holder\">\r\n        <object class=\"logo\" data=\"../../../assets/img/logo-start.svg\" type=\"image/svg+xml\"></object>\r\n        <p>Kukai is a Tezos web wallet based on three principles: Security, Community and Reliability.</p>\r\n      </div>\r\n      <div id=\"mobile-menu-container\">\r\n        <a routerLink=\"/import/\" class=\"menu-item\">\r\n          <div class=\"content\">\r\n            <H1>Import wallet</H1>\r\n            <div class=\"icon\">\r\n              <img src=\"../../../assets/img/import-wallet.svg\">\r\n            </div>\r\n          </div>\r\n        </a>\r\n        <a routerLink=\"/new-wallet/\" class=\"menu-item\">\r\n          <div class=\"content\">\r\n            <H1>New wallet</H1>\r\n            <div class=\"icon\">\r\n              <img src=\"../../../assets/img/new-wallet.svg\">\r\n            </div>\r\n          </div>\r\n        </a>\r\n        <a routerLink=\"/connect-ledger/\" class=\"menu-item\">\r\n          <div class=\"content\">\r\n            <H1>Connect Ledger</H1>\r\n            <div class=\"icon\">\r\n              <img src=\"../../../assets/img/ledger-wallet.svg\">\r\n            </div>\r\n          </div>\r\n        </a>\r\n        <a routerLink=\"/direct-auth/\" class=\"menu-item\">\r\n          <div class=\"content\">\r\n            <H1>DirectAuth</H1>\r\n            <div class=\"icon\">\r\n              <img src=\"../../../assets/img/circle.svg\">\r\n            </div>\r\n          </div>\r\n        </a>\r\n      </div>\r\n      <div class=\"monk-holder\" [class.animationActive]=\"animationActive\">\r\n        <object class=\"monk\" data=\"../../../assets/img/monk.svg\" type=\"image/svg+xml\"></object>\r\n        <object class=\"monk-shadow\" data=\"../../../assets/img/shadow.svg\" type=\"image/svg+xml\"></object>\r\n      </div>\r\n    </div>\r\n    <div id=\"menu-container\">\r\n      <a routerLink=\"/import/\" class=\"menu-item\">\r\n        <div class=\"icon\">\r\n          <img src=\"../../../assets/img/import-wallet.svg\">\r\n        </div>\r\n        <div class=\"content\">\r\n          <H1>Import wallet</H1>\r\n          <p>Import an existing wallet using your encrypted keystore file, seed words or fundraiser credentials</p>\r\n        </div>\r\n      </a>\r\n      <a routerLink=\"/new-wallet/\" class=\"menu-item\">\r\n        <div class=\"icon\">\r\n          <img src=\"../../../assets/img/new-wallet.svg\">\r\n        </div>\r\n        <div class=\"content\">\r\n          <H1>New wallet</H1>\r\n          <p>Create a new HD wallet on the Tezos blockchain and safely record your seed words to backup your accounts</p>\r\n        </div>\r\n      </a>\r\n      <a routerLink=\"/connect-ledger/\" class=\"menu-item\">\r\n        <div class=\"icon\">\r\n          <img src=\"../../../assets/img/ledger-wallet.svg\">\r\n        </div>\r\n        <div class=\"content\">\r\n          <H1>Connect Ledger</H1>\r\n          <p>Keep your private keys safely on your Ledger device and use Kukai to access your wallet</p>\r\n        </div>\r\n      </a>\r\n      <a routerLink=\"/direct-auth/\" class=\"menu-item\">\r\n        <div class=\"icon\">\r\n          <img src=\"../../../assets/img/circle.svg\">\r\n        </div>\r\n        <div class=\"content\">\r\n          <H1>DirectAuth</H1>\r\n          <p>One-Click login with your Google, Reddit or Twitter account</p>\r\n        </div>\r\n      </a>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\"bottom-container\">\r\n  <img class=\"blue-wave\" src=\"../../../assets/img/blue-wave.svg\">\r\n  <div></div>\r\n</div>","import { Injectable } from '@angular/core';\r\nimport { KeyPair, WalletType, Activity } from './../../interfaces';\r\nimport {\r\n  WalletObject,\r\n  HdWallet,\r\n  FullWallet,\r\n  LegacyWalletV1,\r\n  LegacyWalletV2,\r\n  LegacyWalletV3,\r\n  ImplicitAccount,\r\n  LedgerWallet,\r\n  TorusWallet,\r\n  EmbeddedTorusWallet,\r\n  OriginatedAccount,\r\n} from './wallet';\r\nimport { EncryptionService } from '../encryption/encryption.service';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { TorusService } from '../torus/torus.service';\r\nimport { utils, hd } from '@tezos-core-tools/crypto-utils';\r\n\r\n@Injectable()\r\nexport class WalletService {\r\n  storeKey: 'kukai-wallet';\r\n  storageId = 0;\r\n  wallet: WalletObject;\r\n\r\n  constructor(\r\n    private encryptionService: EncryptionService,\r\n    private operationService: OperationService,\r\n    private torusService: TorusService\r\n  ) {}\r\n  /*\r\n    Wallet creation\r\n  */\r\n  createNewWallet(): string {\r\n    return utils.generateMnemonic(24);\r\n  }\r\n  async createEncryptedWallet(\r\n    mnemonic: string,\r\n    password: string,\r\n    passphrase: string = '',\r\n    hdSeed: boolean\r\n  ): Promise<any> {\r\n    const seed = utils.mnemonicToSeed(mnemonic, passphrase, hdSeed);\r\n    const entropy: Buffer = Buffer.from(utils.mnemonicToEntropy(mnemonic));\r\n    let keyPair: KeyPair;\r\n    if (!hdSeed) {\r\n      keyPair = this.operationService.seed2keyPair(seed);\r\n    } else {\r\n      keyPair = hd.keyPairFromAccountIndex(seed, 0);\r\n    }\r\n    const encrypted = await this.encryptionService.encrypt(seed, password, 3);\r\n    const encryptedSeed: string = encrypted.chiphertext;\r\n    const iv: string = encrypted.iv;\r\n    const iv2: string = this.encryptionService.bumpIV(iv, 1);\r\n    const encryptedEntropy: string = (await this.encryptionService.encrypt(\r\n      entropy,\r\n      password,\r\n      3,\r\n      iv2\r\n    )).chiphertext;\r\n    return {\r\n      data: this.exportKeyStoreInit(\r\n        hdSeed ? WalletType.HdWallet : WalletType.FullWallet,\r\n        encryptedSeed,\r\n        encryptedEntropy,\r\n        iv\r\n      ),\r\n      pkh: keyPair.pkh,\r\n      pk: keyPair.pk,\r\n      seed: seed,\r\n    };\r\n  }\r\n  async getKeys(pwd: string, pkh?: string): Promise<KeyPair> {\r\n    let seed;\r\n    if (this.wallet instanceof LegacyWalletV1) {\r\n      console.log('v1');\r\n      seed = await this.encryptionService.decrypt(\r\n        this.wallet.encryptedSeed,\r\n        pwd,\r\n        this.wallet.salt,\r\n        1\r\n      );\r\n      console.log('done');\r\n    } else if (this.wallet instanceof LegacyWalletV2) {\r\n      seed = await this.encryptionService.decrypt(\r\n        this.wallet.encryptedSeed,\r\n        pwd,\r\n        this.wallet.IV,\r\n        2\r\n      );\r\n    } else if (\r\n      this.wallet instanceof LegacyWalletV3 ||\r\n      this.wallet instanceof HdWallet\r\n    ) {\r\n      seed = await this.encryptionService.decrypt(\r\n        this.wallet.encryptedSeed,\r\n        pwd,\r\n        this.wallet.IV,\r\n        3\r\n      );\r\n    } else if (this.wallet instanceof LedgerWallet) {\r\n      console.log(this.wallet);\r\n      const keyPair: KeyPair = {\r\n        sk: null,\r\n        pk: this.wallet.implicitAccounts[0].pk,\r\n        pkh: this.wallet.implicitAccounts[0].pkh,\r\n      };\r\n      return keyPair;\r\n    } else if (this.wallet instanceof EmbeddedTorusWallet) {\r\n      return this.operationService.spPrivKeyToKeyPair(this.wallet.sk);\r\n    } else if (this.wallet instanceof TorusWallet) {\r\n      const keyPair = await this.torusService.getTorusKeyPair(this.wallet.verifier, this.wallet.id);\r\n      if (this.wallet.getImplicitAccount(keyPair.pkh)) {\r\n        return keyPair;\r\n      } else {\r\n        throw new Error('Signed with wrong account');\r\n      }\r\n      return null;\r\n    }  else {\r\n      return null;\r\n    }\r\n    if (!seed) {\r\n      return null;\r\n    }\r\n    if (this.wallet instanceof HdWallet) {\r\n      if (!pkh) {\r\n        throw new Error('No pkh provided');\r\n      }\r\n      const account = this.wallet.getImplicitAccount(pkh);\r\n      if (!account.derivationPath) {\r\n        throw new Error('No derivationPath found');\r\n      }\r\n      return hd.seedToKeyPair(seed, account.derivationPath);\r\n    } else if (this.wallet instanceof LegacyWalletV1) {\r\n      const keyPair = this.operationService.seed2keyPair(seed);\r\n      if (!keyPair.pkh || !pkh || keyPair.pkh !== pkh) {\r\n        return null;\r\n      } else {\r\n        return keyPair;\r\n      }\r\n    } else {\r\n      return this.operationService.seed2keyPair(seed);\r\n    }\r\n  }\r\n  async revealMnemonicPhrase(pwd: string): Promise<string> {\r\n    if (\r\n      this.wallet &&\r\n      (this.wallet instanceof HdWallet || this.wallet instanceof LegacyWalletV3)\r\n    ) {\r\n      const iv = this.encryptionService.bumpIV(this.wallet.IV, 1);\r\n      const entropy = await this.encryptionService.decrypt(\r\n        this.wallet.encryptedEntropy,\r\n        pwd,\r\n        iv,\r\n        3\r\n      );\r\n      if (entropy) {\r\n        return utils.entropyToMnemonic(entropy);\r\n      } else {\r\n        console.log('Invalid password');\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  addImplicitAccount(pk: string, derivationPath?: string | number) {\r\n    let pkh;\r\n    console.log(pk);\r\n    if (pk && pk.slice(0, 4) === 'sppk') {\r\n      pkh = this.operationService.pk2pkh(pk);\r\n    } else {\r\n      pkh = utils.pkToPkh(pk);\r\n    }\r\n    if (pkh) {\r\n      this.wallet.implicitAccounts.push(\r\n        new ImplicitAccount(pkh, pk, typeof derivationPath === 'number' ? `44'/1729'/${derivationPath}'/0'` : derivationPath)\r\n      );\r\n      console.log('Adding new implicit account...');\r\n      console.log(\r\n        this.wallet.implicitAccounts[this.wallet.implicitAccounts.length - 1]\r\n      );\r\n      this.storeWallet();\r\n    }\r\n  }\r\n  addOriginatedAccount(kt: string, manager: string) {\r\n    const implicitAccount = this.wallet.getImplicitAccount(manager);\r\n    if (implicitAccount) {\r\n      const origAcc = new OriginatedAccount(\r\n        kt,\r\n        implicitAccount.pkh,\r\n        implicitAccount.pk\r\n      );\r\n      implicitAccount.originatedAccounts.push(origAcc);\r\n      this.storeWallet();\r\n    } else {\r\n      console.warn(`Manager address $(manager) not found`);\r\n    }\r\n  }\r\n  /*addUnusedAccount(account: any) {\r\n    if (this.wallet instanceof HdWallet) {\r\n      this.wallet.unusedAccounts.push(account);\r\n    }\r\n  }*/\r\n  addressExists(address: string): boolean {\r\n    return (\r\n      this.wallet.getAccounts().findIndex((a) => a.address === address) !== -1\r\n    );\r\n  }\r\n  async incrementAccountIndex(password: string): Promise<string> {\r\n    if (this.wallet instanceof HdWallet) {\r\n      const seed = await this.encryptionService.decrypt(\r\n        this.wallet.encryptedSeed,\r\n        password,\r\n        this.wallet.IV,\r\n        3\r\n      );\r\n      if (seed) {\r\n        const keyPair: KeyPair = hd.seedToKeyPair(seed, `44'/1729'/${this.wallet.index}'/0'`);\r\n        this.addImplicitAccount(keyPair.pk, this.wallet.index);\r\n        this.wallet.index++;\r\n        this.storeWallet();\r\n        return keyPair.pkh;\r\n      } else {\r\n        return ''; // Wrong pwd\r\n      }\r\n    }\r\n  }\r\n  /*\r\n    Clear wallet data from browser\r\n  */\r\n  clearWallet(instanceId: string = '') {\r\n    this.wallet = null;\r\n    this.storageId = 0;\r\n    if (instanceId) {\r\n      sessionStorage.removeItem(instanceId);\r\n    } else {\r\n      localStorage.removeItem(this.storeKey);\r\n    }\r\n  }\r\n  /*\r\n  Used to decide wallet type\r\n  */\r\n  isFullWallet(): boolean {\r\n    return this.wallet instanceof FullWallet;\r\n  }\r\n  isViewOnlyWallet(): boolean {\r\n    return false;\r\n  }\r\n  isObserverWallet(): boolean {\r\n    return false;\r\n  }\r\n  isLedgerWallet(): boolean {\r\n    return this.wallet instanceof LedgerWallet;\r\n  }\r\n  isHdWallet(): boolean {\r\n    return this.wallet instanceof HdWallet;\r\n  }\r\n  isTorusWallet(): boolean {\r\n    return this.wallet instanceof TorusWallet;\r\n  }\r\n  isEmbeddedTorusWallet(): boolean {\r\n    return this.wallet instanceof EmbeddedTorusWallet;\r\n  }\r\n  exportKeyStoreInit(\r\n    type: WalletType,\r\n    encryptedSeed: string,\r\n    encryptedEntropy: string,\r\n    iv: string\r\n  ) {\r\n    const data: any = {\r\n      provider: 'Kukai',\r\n      version: 3.0,\r\n      walletType: type,\r\n      encryptedSeed,\r\n      encryptedEntropy,\r\n      iv,\r\n    };\r\n    return data;\r\n  }\r\n  /*\r\n    Read and write to localStorage\r\n  */\r\n  initStorage(instanceId: string = '') {\r\n    this.storageId = Date.now();\r\n    if (instanceId) {\r\n      sessionStorage.setItem(\r\n        instanceId,\r\n        JSON.stringify({ localStorageId: this.storageId })\r\n      );\r\n    } else {\r\n      localStorage.setItem(\r\n        this.storeKey,\r\n        JSON.stringify({ localStorageId: this.storageId })\r\n      );\r\n    }\r\n  }\r\n  storeWallet() {\r\n    const localStorageId = this.getLocalStorageId();\r\n    if (this.storageId && localStorageId && this.storageId === localStorageId) {\r\n      let type = 'unknown';\r\n      if (this.wallet instanceof HdWallet) {\r\n        type = 'HdWallet';\r\n      } else if (this.wallet instanceof LegacyWalletV1) {\r\n        type = 'LegacyWalletV1';\r\n      } else if (this.wallet instanceof LegacyWalletV2) {\r\n        type = 'LegacyWalletV2';\r\n      } else if (this.wallet instanceof LegacyWalletV3) {\r\n        type = 'LegacyWalletV3';\r\n      } else if (this.wallet instanceof LedgerWallet) {\r\n        type = 'LedgerWallet';\r\n      } else if (this.wallet instanceof EmbeddedTorusWallet) {\r\n        type = 'EmbeddedTorusWallet';\r\n      } else if (this.wallet instanceof TorusWallet) {\r\n        type = 'TorusWallet';\r\n      }\r\n      this.getStorage().setItem(\r\n        (this.wallet instanceof EmbeddedTorusWallet) ? this.wallet.instanceId : this.storeKey,\r\n        JSON.stringify({ type, localStorageId: this.storageId, data: this.wallet })\r\n      );\r\n    } else {\r\n      console.log('Outdated storage id');\r\n    }\r\n  }\r\n  getLocalStorageId() {\r\n    const walletData = this.wallet instanceof EmbeddedTorusWallet ? sessionStorage.getItem(this.wallet.instanceId) : localStorage.getItem(this.storeKey);\r\n    if (walletData) {\r\n      const parsed = JSON.parse(walletData);\r\n      if (parsed && parsed.localStorageId) {\r\n        return parsed.localStorageId;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  loadStoredWallet(instanceId = '') {\r\n    const walletData = instanceId ? sessionStorage.getItem(instanceId) : localStorage.getItem(this.storeKey);\r\n    if (walletData && walletData !== 'undefined') {\r\n      const parsedWalletData = JSON.parse(walletData);\r\n      console.log(parsedWalletData);\r\n      if (parsedWalletData.type && parsedWalletData.data && parsedWalletData.localStorageId) {\r\n        this.storageId = parsedWalletData.localStorageId;\r\n        const wd = parsedWalletData.data;\r\n        this.deserializeStoredWallet(wd, parsedWalletData.type);\r\n        console.log(this.wallet);\r\n      } else {\r\n        console.log('couldnt load a wallet');\r\n        this.clearWallet(instanceId);\r\n      }\r\n    } else {\r\n      console.log('couldnt load a wallet');\r\n      this.clearWallet(instanceId);\r\n    }\r\n  }\r\n  deserializeStoredWallet(wd: any, type: string) {\r\n    switch (type) {\r\n      case 'HdWallet':\r\n        this.wallet = new HdWallet(\r\n          wd.IV,\r\n          wd.encryptedSeed,\r\n          wd.encryptedEntropy\r\n        );\r\n        if (this.wallet instanceof HdWallet) {\r\n          this.wallet.index = wd.index;\r\n        }\r\n        break;\r\n      case 'LegacyWalletV1':\r\n        this.wallet = new LegacyWalletV1(wd.salt, wd.encryptedSeed);\r\n        break;\r\n      case 'LegacyWalletV2':\r\n        this.wallet = new LegacyWalletV2(wd.IV, wd.encryptedSeed);\r\n        break;\r\n      case 'LegacyWalletV3':\r\n        this.wallet = new LegacyWalletV3(\r\n          wd.IV,\r\n          wd.encryptedSeed,\r\n          wd.encryptedEntropy\r\n        );\r\n        break;\r\n      case 'LedgerWallet':\r\n        this.wallet = new LedgerWallet();\r\n        break;\r\n      case 'TorusWallet':\r\n        this.wallet = new TorusWallet(wd.verifier, wd.id, wd.name);\r\n        this.torusService.initTorus();\r\n        break;\r\n      case 'EmbeddedTorusWallet':\r\n        this.wallet = new EmbeddedTorusWallet(wd.verifier, wd.id, wd.name, wd.origin, wd.sk, wd.instanceId);\r\n        this.torusService.initTorus();\r\n        break;\r\n      default:\r\n    }\r\n    this.wallet.XTZrate = wd.XTZrate;\r\n    this.wallet.totalBalanceUSD = wd.totalBalanceUSD;\r\n    this.wallet.totalBalanceXTZ = wd.totalBalanceXTZ;\r\n    if (wd.lookups) {\r\n      this.wallet.lookups = wd.lookups;\r\n    }\r\n    for (const implicit of wd.implicitAccounts) {\r\n      const impAcc: ImplicitAccount = new ImplicitAccount(\r\n        implicit.pkh,\r\n        implicit.pk,\r\n        implicit.derivationPath ? implicit.derivationPath : null\r\n      );\r\n      impAcc.balanceUSD = implicit.balanceUSD;\r\n      impAcc.balanceXTZ = implicit.balanceXTZ;\r\n      impAcc.delegate = implicit.delegate;\r\n      if (implicit.activitiesCounter) { // prevent storage from breaking (1.11)\r\n        impAcc.state = implicit.activitiesCounter.toString();\r\n      } else {\r\n        impAcc.state = implicit.state;\r\n      }\r\n      impAcc.activities = this.activityMigration(implicit.activities);\r\n      if (implicit.tokens) {\r\n        impAcc.tokens = implicit.tokens;\r\n      }\r\n      for (const originated of implicit.originatedAccounts) {\r\n        const origAcc = new OriginatedAccount(\r\n          originated.address,\r\n          impAcc.pkh,\r\n          impAcc.pk\r\n        );\r\n        origAcc.balanceUSD = originated.balanceUSD;\r\n        origAcc.balanceXTZ = originated.balanceXTZ;\r\n        origAcc.delegate = originated.delegate;\r\n        if (originated.activitiesCounter) { // prevent storage from breaking (1.11)\r\n          origAcc.state = originated.activitiesCounter.toString();\r\n        } else {\r\n          origAcc.state = originated.state;\r\n        }\r\n        origAcc.activities = this.activityMigration(originated.activities);\r\n        impAcc.originatedAccounts.push(origAcc);\r\n      }\r\n      this.wallet.implicitAccounts.push(impAcc);\r\n    }\r\n  }\r\n  activityMigration(activities: any[]): Activity[] { // prevent storage from breaking (1.11)\r\n    return activities.map(activity => {\r\n      if (activity.source.address === undefined) {\r\n        activity.source = { address: activity.source };\r\n      }\r\n      if (activity.destination.address === undefined) {\r\n        activity.destination = { address: activity.destination };\r\n      }\r\n      return activity;\r\n    });\r\n  }\r\n  private getStorage() {\r\n    return this.isEmbeddedTorusWallet() ? sessionStorage : localStorage;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class MessageService {\r\n  spinnerOn = false;\r\n  spinnerText = '';\r\n  messages: any[] = [];\r\n  defaultTime = 10;\r\n  readonly pairingCompleteMsg = 'Pairing complete! Waiting for permission request...';\r\n  add(message: string, seconds: number = this.defaultTime) {\r\n    const type = 'info';\r\n    console.log(type + ': ' + message);\r\n    this.messages.push({\r\n      type: type,\r\n      msg: message,\r\n      timeout: seconds * 1000\r\n    });\r\n  }\r\n  addError(message: string, seconds: number = this.defaultTime) {\r\n    const type = 'danger';\r\n    console.log(type + ': ' + message);\r\n    this.messages.push({\r\n      type: type,\r\n      msg: message,\r\n      timeout: seconds * 1000\r\n    });\r\n  }\r\n  addWarning(message: string, seconds: number = this.defaultTime) {\r\n    const type = 'warning';\r\n    console.log(type + ': ' + message);\r\n    this.messages.push({\r\n      type: type,\r\n      msg: message,\r\n      timeout: seconds * 1000\r\n    });\r\n  }\r\n  addSuccess(message: string, seconds: number = this.defaultTime) {\r\n    const type = 'success';\r\n    console.log(type + ': ' + message);\r\n    this.messages.push({\r\n      type: type,\r\n      msg: message,\r\n      timeout: seconds * 1000\r\n    });\r\n  }\r\n  emailNotify(email: string, amount: string) {\r\n    console.log(email);\r\n    const type = 'success';\r\n    this.messages.push({\r\n      type: type,\r\n      timeout: 0,\r\n      msg: 'email',\r\n      email,\r\n      amount\r\n    });\r\n  }\r\n  redditNotify(username: string, amount: string) {\r\n    console.log(username);\r\n    const type = 'success';\r\n    this.messages.push({\r\n      type: type,\r\n      timeout: 0,\r\n      msg: 'Reddit',\r\n      username,\r\n      amount\r\n    });\r\n  }\r\n  twitterNotify(twitterId: string, handler: string, amount: string) {\r\n    console.log(twitterId);\r\n    const type = 'success';\r\n    this.messages.push({\r\n      type: type,\r\n      timeout: 0,\r\n      msg: 'Twitter',\r\n      twitterId,\r\n      handler,\r\n      amount\r\n    });\r\n  }\r\n  addBeaconWait(message: string) {\r\n    const type = 'info';\r\n    this.messages.push({\r\n      type: type,\r\n      msg: message,\r\n      timeout: 30 * 1000,\r\n      loader: true\r\n    });\r\n  }\r\n  async removeBeaconMsg(delay = false) {\r\n    setTimeout(() => {\r\n      for (let i = 0; i < this.messages.length; i++) {\r\n        if (this.messages[i].loader) {\r\n          this.messages.splice(i, 1);\r\n          this.addSuccess(this.pairingCompleteMsg, 10);\r\n          break;\r\n        } else if (this.messages[i].msg === this.pairingCompleteMsg) {\r\n          this.messages.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n    }, delay ? 500 : 0);\r\n  }\r\n  clear() {\r\n    this.messages = [];\r\n  }\r\n  async startSpinner(text: string = '') {\r\n    this.spinnerText = text;\r\n    this.spinnerOn = true;\r\n  }\r\n  async stopSpinner() {\r\n    this.spinnerText = '';\r\n    this.spinnerOn = false;\r\n  }\r\n}\r\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","import { Component, OnInit, HostListener } from '@angular/core';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { BeaconService } from '../../services/beacon/beacon.service';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { Router } from '@angular/router';\r\nimport { SlicePipe } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-settings',\r\n  templateUrl: './settings.component.html',\r\n  styleUrls: ['./settings.component.scss']\r\n})\r\nexport class SettingsComponent implements OnInit {\r\n  implicitAccounts = [];\r\n  wideAccounts = false;\r\n  constructor(\r\n    public beaconService: BeaconService,\r\n    private messageService: MessageService,\r\n    private walletService: WalletService,\r\n    private router: Router) { }\r\n\r\n  ngOnInit(): void {\r\n    if (this.walletService.wallet) {\r\n      this.implicitAccounts = this.walletService.wallet.getImplicitAccounts();\r\n      this.beaconService.syncBeaconState();\r\n      this.onResize();\r\n    } else {\r\n      this.router.navigate(['']);\r\n    }\r\n  }\r\n  accountAvailable(pkh: string): boolean {\r\n    const index = this.implicitAccounts.findIndex((impAcc: any) => impAcc.pkh === pkh);\r\n    if (index === -1) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  @HostListener('window:resize')\r\n  onResize() {\r\n    this.wideAccounts = (window.innerWidth > 600);\r\n  }\r\n  formatAddress(address: string) {\r\n    if (this.wideAccounts) {\r\n      return address;\r\n    } else {\r\n      return address.slice(0, 6) + '...' + address.slice(-4);\r\n    }\r\n  }\r\n}\r\n","<app-header [settings]=true></app-header>\r\n<div class=\"settings\">\r\n  <H3>Connect with dApps</H3>\r\n  <div class=\"seperator\"></div>\r\n  <div class=\"handler\">\r\n    <div>\r\n      <h4>Scan a QR code</h4>\r\n      <p>Connect to dApps on <u>another device</u> by scanning a QR code.</p>\r\n    </div>\r\n    <div>\r\n      <app-qr-scanner></app-qr-scanner>\r\n    </div>\r\n  </div>\r\n  <H3>Peers</H3>\r\n  <table *ngIf=\"beaconService.peers.length\">\r\n    <thead>\r\n      <tr>\r\n        <th>Name</th>\r\n        <th>Relay server</th>\r\n        <th><span (click)=\"beaconService.removePeers()\">Remove&nbsp;all</span></th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor=\"let peer of beaconService.peers; index as i\">\r\n        <td>{{ peer.name }}</td>\r\n        <td>{{ peer.relayServer }}</td>\r\n        <td (click)=\"beaconService.removePeer(i)\"><img (click)=\"beaconService.removePeer(i)\" src=\"../../../assets/img/cross.svg\"></td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <H3>Permissions</H3>\r\n  <table *ngIf=\"beaconService.permissions.length\">\r\n    <thead>\r\n      <tr>\r\n        <th>Name</th>\r\n        <th>Address</th>\r\n        <th><span (click)=\"beaconService.removePermissions()\">Remove&nbsp;all</span></th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor=\"let permission of beaconService.permissions; index as i\"\r\n        [class.inactive]=\"!accountAvailable(permission.address)\">\r\n        <td>{{ permission.appMetadata.name }}</td>\r\n        <td>{{ formatAddress(permission.address) }}</td>\r\n        <td><img (click)=\"beaconService.removePermission(i)\" src=\"../../../assets/img/cross.svg\"></td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>","/* (ignored) */","import { Component, OnInit, Input, ChangeDetectorRef } from '@angular/core';\r\nimport { Router, NavigationEnd } from '@angular/router';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { Account, TorusWallet } from '../../services/wallet/wallet';\r\nimport { LookupService } from '../../services/lookup/lookup.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { CONSTANTS as _CONSTANTS } from '../../../environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-header',\r\n  templateUrl: './header.component.html',\r\n  styleUrls: ['./header.component.scss']\r\n})\r\nexport class HeaderComponent implements OnInit {\r\n  @Input() activeAccount: Account;\r\n  @Input() settings = false;\r\n  impAccs: Account[];\r\n  readonly CONSTANTS = _CONSTANTS;\r\n  constructor(\r\n    private router: Router,\r\n    public walletService: WalletService,\r\n    public lookupService: LookupService,\r\n    private coordinatorService: CoordinatorService,\r\n    private messageService: MessageService,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    if (this.walletService.wallet) {\r\n      this.impAccs = this.walletService.wallet.implicitAccounts;\r\n    }\r\n  }\r\n  logout() {\r\n    this.coordinatorService.stopAll();\r\n    this.messageService.clear();\r\n    this.walletService.clearWallet();\r\n    this.lookupService.clear();\r\n    this.router.navigate(['']);\r\n  }\r\n  getUsername() {\r\n    if (this.walletService.wallet instanceof TorusWallet) {\r\n      return this.walletService.wallet.displayName();\r\n    }\r\n    return '';\r\n  }\r\n  getVerifier() {\r\n    if (this.walletService.wallet instanceof TorusWallet) {\r\n      return this.walletService.wallet.verifier;\r\n    }\r\n    return '';\r\n  }\r\n}\r\n","<div id=\"top-container\">\r\n  <a routerLink=\"/accounts\" class=\"logo\">\r\n    <img *ngIf=\"!settings\" id=\"logo\" src=\"../../../assets/img/kukai-logo.svg\">\r\n    <img *ngIf=\"settings\" id=\"logo\" src=\"../../../assets/img/kukai-logo2.svg\">\r\n  </a>\r\n  <div class=\"middle\">\r\n    <ng-container *ngIf=\"!activeAccount\">\r\n      <ng-container *ngIf=\"settings\">\r\n        <a class=\"accounts light\" routerLink=\"/accounts\">\r\n          Accounts\r\n        </a>\r\n        <img src=\"../../../assets/img/slash2.svg\">\r\n        <span>Settings</span>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"!settings\">\r\n        <a class=\"accounts solo\" routerLink=\"/accounts\">\r\n          Accounts\r\n        </a>\r\n      </ng-container>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"activeAccount\">\r\n      <a class=\"accounts\" routerLink=\"/accounts\">\r\n        Accounts\r\n      </a>\r\n      <img src=\"../../../assets/img/slash.svg\">\r\n      <div class=\"dropdown\">\r\n        <div class=\"dropbtn\"><span>{{ activeAccount.shortAddress() }}</span><img\r\n            src=\"../../../assets/img/chevron-down.svg\"></div>\r\n        <div class=\"dropdown-content\">\r\n          <ng-container *ngFor=\"let impAcc of impAccs\">\r\n            <a routerLink=\"/account/{{impAcc.address}}\" [class.selected]=\"impAcc.address === activeAccount.address\">\r\n              {{ impAcc.shortAddress() }}\r\n            </a>\r\n            <ng-container *ngFor=\"let origAcc of impAcc.originatedAccounts\">\r\n              <a routerLink=\"/account/{{origAcc.address}}\" [class.selected]=\"origAcc.address === activeAccount.address\">\r\n                {{ origAcc.shortAddress() }}\r\n              </a>\r\n            </ng-container>\r\n          </ng-container>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n  <div class=\"dropdown right\">\r\n    <div id=\"menu\" class=\"dropbtn\">\r\n      <img src=\"../../../assets/img/user.svg\">\r\n    </div>\r\n    <div class=\"dropdown-content right\">\r\n      <a routerLink=\"/settings\">Settings</a>\r\n      <a (click)=\"logout()\">Logout</a>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div id=\"header-list\" [class.invert]=\"settings\">\r\n  <div class=\"left\" *ngIf=\"!CONSTANTS.MAINNET\">\r\n    {{ CONSTANTS.NETWORK.toUpperCase() }} VERSION\r\n  </div>\r\n  <div class=\"main\">\r\n    <ng-container *ngIf=\"getVerifier()\"><img class=\"verifier-logo\"\r\n        src=\"../../../assets/img/{{ getVerifier() }}-logo.svg\">&nbsp;</ng-container>{{ getUsername() }}\r\n  </div>\r\n</div>","import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { of, Observable, from as fromPromise } from 'rxjs';\r\nimport { catchError, flatMap, timeout } from 'rxjs/operators';\r\nimport { Buffer } from 'buffer';\r\nimport * as libs from 'libsodium-wrappers';\r\nimport * as Bs58check from 'bs58check';\r\nimport * as bip39 from 'bip39';\r\nimport Big from 'big.js';\r\nimport { localForger } from '@taquito/local-forging';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\nimport { ErrorHandlingPipe } from '../../pipes/error-handling.pipe';\r\nimport * as elliptic from 'elliptic';\r\nimport { instantiateSecp256k1, hexToBin, binToHex } from '@bitauth/libauth';\r\nimport { TokenService } from '../token/token.service';\r\nimport { isEqual } from 'lodash';\r\n\r\nconst httpOptions = { headers: { 'Content-Type': 'application/json' } };\r\n\r\nexport interface KeyPair {\r\n  sk: string | null;\r\n  pk: string | null;\r\n  pkh: string;\r\n}\r\n@Injectable()\r\nexport class OperationService {\r\n  nodeURL = CONSTANTS.NODE_URL;\r\n  prefix = {\r\n    tz1: new Uint8Array([6, 161, 159]),\r\n    tz2: new Uint8Array([6, 161, 161]),\r\n    tz3: new Uint8Array([6, 161, 164]),\r\n    edpk: new Uint8Array([13, 15, 37, 217]),\r\n    sppk: new Uint8Array([3, 254, 226, 86]),\r\n    edsk: new Uint8Array([43, 246, 78, 7]),\r\n    spsk: new Uint8Array([17, 162, 224, 201]),\r\n    edsig: new Uint8Array([9, 245, 205, 134, 18]),\r\n    spsig: new Uint8Array([13, 115, 101, 19, 63]),\r\n    sig: new Uint8Array([4, 130, 43]),\r\n    o: new Uint8Array([5, 116]),\r\n    B: new Uint8Array([1, 52]),\r\n    TZ: new Uint8Array([3, 99, 29]),\r\n    KT: new Uint8Array([2, 90, 121])\r\n  };\r\n  microTez = new Big(1000000);\r\n  feeHardCap = 10; //tez\r\n  constructor(\r\n    private http: HttpClient,\r\n    private translate: TranslateService,\r\n    private errorHandlingPipe: ErrorHandlingPipe,\r\n    private tokenService: TokenService\r\n  ) { }\r\n  /*\r\n    Returns an observable for the activation of an ICO identity\r\n  */\r\n  activate(pkh: string, secret: string): Observable<any> {\r\n    return this.getHeader()\r\n      .pipe(flatMap((header: any) => {\r\n        const fop: any = {\r\n          branch: header.hash,\r\n          contents: [{\r\n            kind: 'activate_account',\r\n            pkh: pkh,\r\n            secret: secret\r\n          }]\r\n        };\r\n        return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/forge/operations', fop)\r\n          .pipe(flatMap((opbytes: any) => {\r\n            const sopbytes: string = opbytes + Array(129).join('0');\r\n            fop.protocol = header.protocol;\r\n            fop.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\r\n            return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/preapply/operations', [fop])\r\n              .pipe(flatMap((preApplyResult: any) => {\r\n                console.log(JSON.stringify(preApplyResult));\r\n                return this.http.post(this.nodeURL + '/injection/operation',\r\n                  JSON.stringify(sopbytes), httpOptions)\r\n                  .pipe(flatMap((final: any) => {\r\n                    return this.opCheck(final);\r\n                  }));\r\n              }));\r\n          }));\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  opCheck(final: any, newPkh: string = null): Observable<any> {\r\n    if (typeof (final) === 'string' && final.length === 51) {\r\n      return of(\r\n        {\r\n          success: true,\r\n          payload: {\r\n            opHash: final,\r\n            newPkh: newPkh\r\n          }\r\n        });\r\n    } else {\r\n      return of(\r\n        {\r\n          success: false,\r\n          payload: {\r\n            opHash: null,\r\n            msg: final\r\n          }\r\n        });\r\n    }\r\n  }\r\n  /*\r\n    Returns an observable for the origination of new accounts.\r\n  */\r\n  originate(pkh: string, amount: number, fee: number = 0, keys: KeyPair): Observable<any> {\r\n    return this.getHeader()\r\n      .pipe(flatMap((header: any) => {\r\n        return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/counter', {})\r\n          .pipe(flatMap((actions: number) => {\r\n            return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/manager_key', {})\r\n              .pipe(flatMap((manager: any) => {\r\n                if (fee >= this.feeHardCap) {\r\n                  throw new Error('TooHighFee');\r\n                }\r\n                let counter: number = Number(actions);\r\n                const script = this.getManagerScript(keys.pkh);\r\n                const fop: any = {\r\n                  branch: header.hash,\r\n                  contents: [\r\n                    {\r\n                      kind: 'origination',\r\n                      source: keys.pkh,\r\n                      fee: this.microTez.times(fee).toString(),\r\n                      counter: (++counter).toString(),\r\n                      gas_limit: '15678',\r\n                      storage_limit: '509',\r\n                      balance: this.microTez.times(amount).toString(),\r\n                      script: script\r\n                    }\r\n                  ]\r\n                };\r\n                if (manager === null) {\r\n                  fop.contents[1] = fop.contents[0];\r\n                  fop.contents[0] = {\r\n                    kind: 'reveal',\r\n                    source: keys.pkh,\r\n                    fee: '0',\r\n                    counter: (counter).toString(),\r\n                    gas_limit: '1000',\r\n                    storage_limit: '0',\r\n                    public_key: keys.pk\r\n                  };\r\n                  fop.contents[1].counter = (Number(fop.contents[1].counter) + 1).toString();\r\n                }\r\n                return this.operation(fop, header, keys, true);\r\n              }));\r\n          }));\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  /*\r\n    Returns an observable for the transaction of tez.\r\n  */\r\n  transfer(from: string, transactions: any, fee: number, keys: KeyPair, tokenTransfer: string = ''): Observable<any> {\r\n    return this.getHeader()\r\n      .pipe(flatMap((header: any) => {\r\n        return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/counter', {})\r\n          .pipe(flatMap((actions: any) => {\r\n            return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/manager_key', {})\r\n              .pipe(flatMap((manager: any) => {\r\n                if (fee >= this.feeHardCap) {\r\n                  throw new Error('TooHighFee');\r\n                }\r\n                const counter: number = Number(actions);\r\n                const fop = this.createTransactionObject(header.hash, counter, manager, transactions, keys.pkh, keys.pk, from, fee, tokenTransfer);\r\n                return this.operation(fop, header, keys);\r\n              }));\r\n          }));\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  createTransactionObject(hash: string, counter: number, manager: string, transactions: any,\r\n    pkh: string, pk: string, from: string, fee: number, tokenTransfer: string): any {\r\n    const fop: any = {\r\n      branch: hash,\r\n      contents: []\r\n    };\r\n    if (manager === null) { // Reveal\r\n      fop.contents.push({\r\n        kind: 'reveal',\r\n        source: pkh,\r\n        fee: '0',\r\n        counter: (++counter).toString(),\r\n        gas_limit: '1000',\r\n        storage_limit: '0',\r\n        public_key: pk\r\n      });\r\n    }\r\n    for (let i = 0; i < transactions.length; i++) {\r\n      const currentFee = i === transactions.length - 1 ? this.microTez.times(fee).toString() : '0';\r\n      const gasLimit = transactions[i].gasLimit.toString();\r\n      const storageLimit = transactions[i].storageLimit.toString();\r\n      if (tokenTransfer) {\r\n        console.log('Invoke contract: ' + tokenTransfer);\r\n        let invocation: any;\r\n        const { kind, decimals, contractAddress, id } = this.tokenService.getAsset(tokenTransfer);\r\n        if (kind === 'FA1.2') {\r\n          invocation = this.getFA12Transaction(pkh, transactions[i].to, Big(10 ** decimals).times(transactions[i].amount).toString());\r\n        } else if (kind === 'FA2') {\r\n          invocation = this.getFA2Transaction(pkh, transactions[i].to, Big(10 ** decimals).times(transactions[i].amount).toString(), id);\r\n        } else {\r\n          throw new Error('Unrecognized token kind');\r\n        }\r\n        fop.contents.push({\r\n          kind: 'transaction',\r\n          source: pkh,\r\n          fee: currentFee,\r\n          counter: (++counter).toString(),\r\n          gas_limit: gasLimit,\r\n          storage_limit: storageLimit,\r\n          amount: '0',\r\n          destination: contractAddress,\r\n          parameters: invocation\r\n        });\r\n      } else if (from.slice(0, 2) === 'tz') {\r\n        const transactionOp: any = {\r\n          kind: 'transaction',\r\n          source: from,\r\n          fee: currentFee,\r\n          counter: (++counter).toString(),\r\n          gas_limit: gasLimit,\r\n          storage_limit: storageLimit,\r\n          amount: this.microTez.times(transactions[i].amount).toString(),\r\n          destination: transactions[i].to,\r\n        };\r\n        if (transactions[i].parameters) {\r\n          transactionOp.parameters = transactions[i].parameters;\r\n        }\r\n        fop.contents.push(transactionOp);\r\n      } else if (from.slice(0, 2) === 'KT') {\r\n        if (transactions[i].to.slice(0, 2) === 'tz') {\r\n          const managerTransaction = this.getContractPkhTransaction(transactions[i].to, this.microTez.times(transactions[i].amount).toString());\r\n          fop.contents.push({\r\n            kind: 'transaction',\r\n            source: pkh,\r\n            fee: currentFee,\r\n            counter: (++counter).toString(),\r\n            gas_limit: gasLimit,\r\n            storage_limit: storageLimit,\r\n            amount: '0',\r\n            destination: from,\r\n            parameters: managerTransaction\r\n          });\r\n        } else if (transactions[i].to.slice(0, 2) === 'KT') {\r\n          const managerTransaction = this.getContractKtTransaction(transactions[i].to, this.microTez.times(transactions[i].amount).toString());\r\n          fop.contents.push({\r\n            kind: 'transaction',\r\n            source: pkh,\r\n            fee: currentFee,\r\n            counter: (++counter).toString(),\r\n            gas_limit: gasLimit,\r\n            storage_limit: storageLimit,\r\n            amount: '0',\r\n            destination: from,\r\n            parameters: managerTransaction\r\n          });\r\n        }\r\n      }\r\n    }\r\n    return fop;\r\n  }\r\n  /*\r\n    Returns an observable for the delegation of baking rights.\r\n  */\r\n  delegate(from: string, to: string, fee: number = 0, keys: KeyPair): Observable<any> {\r\n    return this.getHeader()\r\n      .pipe(flatMap((header: any) => {\r\n        return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/counter', {})\r\n          .pipe(flatMap((actions: any) => {\r\n            return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + keys.pkh + '/manager_key', {})\r\n              .pipe(flatMap((manager: any) => {\r\n                if (fee >= this.feeHardCap) {\r\n                  throw new Error('TooHighFee');\r\n                }\r\n                let counter: number = Number(actions);\r\n                let delegationOp: any;\r\n                if (from.slice(0, 2) === 'tz') {\r\n                  delegationOp = {\r\n                    kind: 'delegation',\r\n                    source: from,\r\n                    fee: this.microTez.times(fee).toString(),\r\n                    counter: (++counter).toString(),\r\n                    gas_limit: '1000',\r\n                    storage_limit: '0',\r\n                  };\r\n                  if (to !== '') {\r\n                    delegationOp.delegate = to;\r\n                  }\r\n                } else if (from.slice(0, 2) === 'KT') {\r\n                  delegationOp = {\r\n                    kind: 'transaction',\r\n                    source: keys.pkh,\r\n                    fee: this.microTez.times(fee).toString(),\r\n                    counter: (++counter).toString(),\r\n                    gas_limit: '4380',\r\n                    storage_limit: '0',\r\n                    amount: '0',\r\n                    destination: from,\r\n                    parameters: (to !== '') ? this.getContractDelegation(to) : this.getContractUnDelegation()\r\n                  };\r\n                }\r\n                const fop: any = {\r\n                  branch: header.hash,\r\n                  contents: [\r\n                    delegationOp\r\n                  ]\r\n                };\r\n                if (manager === null) {\r\n                  fop.contents[1] = fop.contents[0];\r\n                  fop.contents[0] = {\r\n                    kind: 'reveal',\r\n                    source: keys.pkh,\r\n                    fee: '0',\r\n                    counter: (counter).toString(),\r\n                    gas_limit: '1000',\r\n                    storage_limit: '0',\r\n                    public_key: keys.pk\r\n                  };\r\n                  fop.contents[1].counter = (Number(fop.contents[1].counter) + 1).toString();\r\n                }\r\n                return this.operation(fop, header, keys);\r\n              }));\r\n          }));\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  /*\r\n  Help function for operations\r\n  */\r\n  operation(fop: any, header: any, keys: KeyPair, origination: boolean = false): Observable<any> {\r\n    console.log('fop to send: ' + JSON.stringify(fop));\r\n    return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/forge/operations', fop)\r\n      .pipe(flatMap((opbytes: any) => {\r\n        return this.localForge(fop)\r\n          .pipe(flatMap((localOpbytes: string) => {\r\n            if (opbytes !== localOpbytes) {\r\n              throw new Error('ValidationError');\r\n            }\r\n            if (!keys.sk) {\r\n              fop.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\r\n              return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/scripts/run_operation', { operation: fop, chain_id: header.chain_id })\r\n                .pipe(flatMap((applied: any) => {\r\n                  console.log('applied: ' + JSON.stringify(applied));\r\n                  this.checkApplied([applied]);\r\n                  return of(\r\n                    {\r\n                      success: true,\r\n                      payload: {\r\n                        unsignedOperation: opbytes\r\n                      }\r\n                    });\r\n                }));\r\n            } else {\r\n              fop.protocol = header.protocol;\r\n              const signed = this.sign('03' + opbytes, keys.sk);\r\n              const sopbytes = signed.sbytes;\r\n              fop.signature = signed.edsig;\r\n              return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/preapply/operations', [fop])\r\n                .pipe(flatMap((applied: any) => {\r\n                  console.log('applied: ' + JSON.stringify(applied));\r\n                  this.checkApplied(applied);\r\n                  console.log('sop: ' + sopbytes);\r\n                  return this.http.post(this.nodeURL + '/injection/operation', JSON.stringify(sopbytes), httpOptions)\r\n                    .pipe(\r\n                      timeout(20000)\r\n                    )\r\n                    .pipe(flatMap((final: any) => {\r\n                      let newPkh = null;\r\n                      if (origination) {\r\n                        newPkh = applied[0].contents[fop.contents.length - 1].\r\n                          metadata.operation_result.originated_contracts[0];\r\n                      }\r\n                      return this.opCheck(final, newPkh);\r\n                    }));\r\n                }));\r\n            }\r\n          }));\r\n      }));\r\n  }\r\n  /*\r\n    Broadcast a signed operation to the network\r\n  */\r\n  broadcast(sopbytes: string): Observable<any> {\r\n    console.log('Broadcast...');\r\n    const opbytes = sopbytes.slice(0, sopbytes.length - 128);\r\n    const edsig = this.sig2edsig(sopbytes.slice(sopbytes.length - 128));\r\n    return fromPromise(localForger.parse(opbytes)).pipe(flatMap((fop: any) => {\r\n      fop.signature = edsig;\r\n      return this.getHeader().pipe(flatMap((header: any) => {\r\n        fop.protocol = header.protocol;\r\n        return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/preapply/operations', [fop])\r\n          .pipe(flatMap((parsed: any) => {\r\n            let newPkh = null;\r\n            for (let i = 0; i < parsed[0].contents.length; i++) {\r\n              if (parsed[0].contents[i].kind === 'origination') {\r\n                newPkh = parsed[0].contents[i].metadata.operation_result.originated_contracts[0];\r\n              }\r\n            }\r\n            return this.http.post(this.nodeURL + '/injection/operation', JSON.stringify(sopbytes), httpOptions)\r\n              .pipe(flatMap((final: any) => {\r\n                return this.opCheck(final, newPkh);\r\n              }));\r\n          }));\r\n      }));\r\n    })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  torusKeyLookup(tz2address: string): Observable<any> {\r\n    // Make it into Promise\r\n    // Zero padding\r\n    if (tz2address.length !== 36 || tz2address.slice(0, 3) !== 'tz2') {\r\n      throw new Error('InvalidTorusAddress');\r\n    }\r\n    return this.http.get(this.nodeURL + `/chains/main/blocks/head/context/contracts/${tz2address}/manager_key`, {})\r\n      .pipe(flatMap((manager: any) => {\r\n        if (manager === null) {\r\n          return of({ noReveal: true });\r\n        } else {\r\n          return fromPromise(this.decompress(manager)).pipe(flatMap((pk: any) => {\r\n            const torusReq = {\r\n              jsonrpc: '2.0',\r\n              method: 'KeyLookupRequest',\r\n              id: 10,\r\n              params: {\r\n                pub_key_X: pk.X,\r\n                pub_key_Y: pk.Y\r\n              }\r\n            };\r\n            const url = CONSTANTS.NETWORK === 'mainnet' ? 'https://torus-19.torusnode.com/jrpc' : 'https://teal-15-1.torusnode.com/jrpc';\r\n            return this.http.post(url, JSON.stringify(torusReq), httpOptions)\r\n              .pipe(flatMap((ans: any) => {\r\n                try {\r\n                  if (ans.result.PublicKey.X === pk.X &&\r\n                    ans.result.PublicKey.Y === pk.Y) {\r\n                    return of(ans);\r\n                  } else {\r\n                    return of(null);\r\n                  }\r\n                } catch {\r\n                  return of(null);\r\n                }\r\n              }));\r\n          }));\r\n        }\r\n      }));\r\n  }\r\n  checkApplied(applied: any) {\r\n    for (let i = 0; i < applied[0].contents.length; i++) {\r\n      if (applied[0].contents[i].metadata.operation_result.status !== 'applied') {\r\n        console.log('throw error ->');\r\n        if (applied[0].contents[i].metadata.operation_result.errors) {\r\n          console.log('Error in operation_result');\r\n          throw applied[0].contents[i].metadata.operation_result.errors[\r\n          applied[0].contents[i].metadata.operation_result.errors.length - 1\r\n          ];\r\n        } else if (applied[0].contents[i].metadata.internal_operation_results &&\r\n          applied[0].contents[i].metadata.internal_operation_results[0].result.errors) {\r\n          console.log('Error in internal_operation_results');\r\n          throw applied[0].contents[i].metadata.internal_operation_results[0].result.errors[\r\n          applied[0].contents[i].metadata.internal_operation_results[0].result.errors.length - 1\r\n          ];\r\n        } else {\r\n          throw new Error('Uncatched error in preapply');\r\n        }\r\n      }\r\n    }\r\n  }\r\n  errHandler(error: any): Observable<any> {\r\n    console.log(JSON.stringify(error));\r\n    if (error.error && error.error[0]) {\r\n      error = error.error[0];\r\n    }\r\n    if (error.message) {\r\n      error = this.errorHandlingPipe.transform(error.message);\r\n    } else if (error.id) {\r\n      if (error.with) {\r\n        error = this.errorHandlingPipe.transform(error.id, error.with);\r\n      } else if (error.id === 'failure' && error.msg) {\r\n        error = this.errorHandlingPipe.transform(error.msg);\r\n      } else {\r\n        error = this.errorHandlingPipe.transform(error.id);\r\n      }\r\n    } else if (error.statusText) {\r\n      error = error.statusText;\r\n    } else if (typeof error === 'string') {\r\n      error = this.errorHandlingPipe.transform(error);\r\n    } else {\r\n      console.warn('Error not categorized', error);\r\n      error = 'Unrecogized error';\r\n    }\r\n    return of(\r\n      {\r\n        success: false,\r\n        payload: {\r\n          msg: error\r\n        }\r\n      }\r\n    );\r\n  }\r\n  // Local forge with Taquito\r\n  localForge(operation: any): Observable<string> {\r\n    return fromPromise(localForger.forge(operation)).pipe(flatMap((localForgedBytes: string) => {\r\n      return of(localForgedBytes);\r\n    }));\r\n  }\r\n  getHeader(): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/header');\r\n  }\r\n  getBalance(pkh: string): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh + '/balance')\r\n      .pipe(flatMap((balance: any) => {\r\n        return of(\r\n          {\r\n            success: true,\r\n            payload: {\r\n              balance: balance\r\n            }\r\n          }\r\n        );\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  getDelegate(pkh: string): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh)\r\n      .pipe(flatMap((contract: any) => {\r\n        let delegate = '';\r\n        if (contract.delegate) {\r\n          delegate = contract.delegate;\r\n        }\r\n        return of(\r\n          {\r\n            success: true,\r\n            payload: {\r\n              delegate: delegate\r\n            }\r\n          }\r\n        );\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  getVotingRights(): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/votes/listings')\r\n      .pipe(flatMap((listings: any) => {\r\n        return of(\r\n          {\r\n            success: true,\r\n            payload: listings\r\n          }\r\n        );\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  isRevealed(pkh: string): Observable<boolean> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh + '/manager_key', {})\r\n      .pipe(flatMap((manager: any) => {\r\n        if (manager === null) {\r\n          return of(false);\r\n        } else {\r\n          return of(true);\r\n        }\r\n      }\r\n      )).pipe(catchError(err => {\r\n        return of(true);\r\n      })); // conservative action\r\n  }\r\n  getAccount(pkh: string): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh)\r\n      .pipe(flatMap((contract: any) => {\r\n        let delegate = '';\r\n        if (contract.delegate) {\r\n          delegate = contract.delegate;\r\n        }\r\n        return of(\r\n          {\r\n            success: true,\r\n            payload: {\r\n              balance: contract.balance,\r\n              manager: contract.manager,\r\n              delegate: delegate,\r\n              counter: contract.counter\r\n            }\r\n          }\r\n        );\r\n      })).pipe(catchError(err => this.errHandler(err)));\r\n  }\r\n  getVerifiedOpBytes(operationLevel, operationHash, pkh, pk): Observable<string> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/' + operationLevel + '/operation_hashes', {})\r\n      .pipe(flatMap((opHashes: any) => {\r\n        const opIndex = opHashes[3].findIndex(a => a === operationHash);\r\n        return this.http.get(this.nodeURL + '/chains/main/blocks/' + operationLevel + '/operations', {})\r\n          .pipe(flatMap((op: any) => {\r\n            let ans = '';\r\n            op = op[3][opIndex];\r\n            const sig = op.signature;\r\n            delete op.chain_id;\r\n            delete op.signature;\r\n            delete op.hash;\r\n            delete op.protocol;\r\n            for (let i = 0; i < op.contents.length; i++) {\r\n              delete op.contents[i].metadata;\r\n              if (op.contents[i].managerPubkey) { // Fix for mainnet\r\n                op.contents[i].manager_pubkey = op.contents[i].managerPubkey;\r\n                delete op.contents[i].managerPubkey;\r\n              }\r\n            }\r\n            return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/forge/operations', op)\r\n              .pipe(flatMap((opBytes: any) => {\r\n                if (this.pk2pkh(pk) === pkh) {\r\n                  if (this.verify(opBytes, sig, pk)) {\r\n                    ans = opBytes + this.buf2hex(this.b58cdecode(sig, this.prefix.sig));\r\n                  } else {\r\n                    throw new Error('InvalidSignature');\r\n                  }\r\n                } else {\r\n                  throw new Error('InvalidPublicKey');\r\n                }\r\n                return of(ans);\r\n              }));\r\n          }));\r\n      }));\r\n  }\r\n  getConstants(): Observable<any> {\r\n    return this.http.get(this.nodeURL + '/chains/main/blocks/head/context/constants');\r\n  }\r\n  seed2keyPair(seed: Buffer): KeyPair {\r\n    if (!seed) {\r\n      throw new Error('NullSeed');\r\n    }\r\n    const keyPair = libs.crypto_sign_seed_keypair(seed);\r\n    return {\r\n      sk: this.b58cencode(keyPair.privateKey, this.prefix.edsk),\r\n      pk: this.b58cencode(keyPair.publicKey, this.prefix.edpk),\r\n      pkh: this.b58cencode(libs.crypto_generichash(20, keyPair.publicKey), this.prefix.tz1)\r\n    };\r\n  }\r\n  mnemonic2seed(mnemonic: string, passphrase: string = '') {\r\n    if (!this.validMnemonic(mnemonic)) {\r\n      throw new Error('InvalidMnemonic');\r\n    }\r\n    return (bip39.mnemonicToSeedSync(mnemonic, passphrase)).slice(0, 32);\r\n  }\r\n  mnemonic2entropy(mnemonic: string, passphrase: string = '') {\r\n    if (!this.validMnemonic(mnemonic)) {\r\n      throw new Error('InvalidMnemonic');\r\n    }\r\n    return bip39.mnemonicToEntropy(mnemonic);\r\n  }\r\n  validMnemonic(mnemonic: string) {\r\n    return bip39.validateMnemonic(mnemonic);\r\n  }\r\n  validAddress(address: string) {\r\n    try {\r\n      this.b58cdecode(address, this.prefix.tz1);\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n  pk2pkh(pk: string): string {\r\n    if (pk.length === 54 && pk.slice(0, 4) === 'edpk') {\r\n      const pkDecoded = this.b58cdecode(pk, this.prefix.edpk);\r\n      return this.b58cencode(libs.crypto_generichash(20, pkDecoded), this.prefix.tz1);\r\n    } else if (pk.length === 55 && pk.slice(0, 4) === 'sppk') {\r\n      const pkDecoded = this.b58cdecode(pk, this.prefix.edpk);\r\n      return this.b58cencode(libs.crypto_generichash(20, pkDecoded), this.prefix.tz2);\r\n    }\r\n    throw new Error('Invalid public key');\r\n  }\r\n  spPrivKeyToKeyPair(secretKey: string) {\r\n    let sk;\r\n    if (secretKey.match(/^[0-9a-f]{64}$/g)) {\r\n      sk = this.b58cencode(this.hex2buf(secretKey), this.prefix.spsk);\r\n    } else if (secretKey.match(/^spsk[1-9a-km-zA-HJ-NP-Z]{50}$/g)) {\r\n      sk = secretKey;\r\n    } else {\r\n      throw new Error('Invalid private key');\r\n    }\r\n    const keyPair = (new elliptic.ec('secp256k1')).keyFromPrivate(\r\n      new Uint8Array(this.b58cdecode(sk, this.prefix.spsk))\r\n    );\r\n    const prefixVal = keyPair.getPublic().getY().toArray()[31] % 2 ? 3 : 2; // Y odd / even\r\n    const pad = new Array(32).fill(0); // Zero-padding\r\n    const publicKey = new Uint8Array(\r\n      [prefixVal].concat(pad.concat(keyPair.getPublic().getX().toArray()).slice(-32)\r\n      ));\r\n    const pk = this.b58cencode(publicKey, this.prefix.sppk);\r\n    const pkh = this.pk2pkh(pk);\r\n    return { sk, pk, pkh };\r\n  }\r\n  spPointsToPkh(pubX: string, pubY: string): string {\r\n    const key = (new elliptic.ec('secp256k1')).keyFromPublic({ x: pubX, y: pubY });\r\n    const prefixVal = key.getPublic().getY().toArray()[31] % 2 ? 3 : 2;\r\n    const pad = new Array(32).fill(0);\r\n    const publicKey = new Uint8Array(\r\n      [prefixVal].concat(pad.concat(key.getPublic().getX().toArray()).slice(-32)\r\n      ));\r\n    const pk = this.b58cencode(publicKey, this.prefix.sppk);\r\n    const pkh = this.pk2pkh(pk);\r\n    return pkh;\r\n  }\r\n  async decompress(pk: string): Promise<any> {\r\n    const decodedPk = this.b58cdecode(pk, this.prefix.sppk);\r\n    const hexPk = this.buf2hex(decodedPk);\r\n    const secp256k1 = await instantiateSecp256k1();\r\n    const compressed = hexToBin(hexPk);\r\n    const uncompressed = secp256k1.uncompressPublicKey(compressed);\r\n    const xy = binToHex(uncompressed).slice(2);\r\n    return { X: xy.slice(0, 64), Y: xy.slice(64, 128) };\r\n  }\r\n  hex2pk(hex: string): string {\r\n    return this.b58cencode(this.hex2buf(hex.slice(2, 66)), this.prefix.edpk);\r\n  }\r\n  hex2buf(hex) {\r\n    return new Uint8Array(hex.match(/[\\da-f]{2}/gi).map(function (h) {\r\n      return parseInt(h, 16);\r\n    }));\r\n  }\r\n  buf2hex(buffer) {\r\n    const byteArray = new Uint8Array(buffer), hexParts = [];\r\n    for (let i = 0; i < byteArray.length; i++) {\r\n      const hex = byteArray[i].toString(16);\r\n      const paddedHex = ('00' + hex).slice(-2);\r\n      hexParts.push(paddedHex);\r\n    }\r\n    return hexParts.join('');\r\n  }\r\n  b58cencode(payload: any, prefixx?: Uint8Array) {\r\n    const n = new Uint8Array(prefixx.length + payload.length);\r\n    n.set(prefixx);\r\n    n.set(payload, prefixx.length);\r\n    return Bs58check.encode(Buffer.from(this.buf2hex(n), 'hex'));\r\n  }\r\n  b58cdecode(enc, prefixx) {\r\n    let n = Bs58check.decode(enc);\r\n    n = n.slice(prefixx.length);\r\n    return n;\r\n  }\r\n  ledgerPreHash(opbytes: string): string {\r\n    return this.buf2hex(libs.crypto_generichash(32, this.hex2buf(opbytes)));\r\n  }\r\n  sign(bytes: string, sk: string): any {\r\n    if (!['03', '05'].includes(bytes.slice(0, 2))) {\r\n      throw new Error('Invalid prefix');\r\n    }\r\n    if (sk.slice(0, 4) === 'spsk') {\r\n      const hash = libs.crypto_generichash(32, this.hex2buf(bytes));\r\n      bytes = bytes.slice(2);\r\n      const key = (new elliptic.ec('secp256k1')).keyFromPrivate(new Uint8Array(this.b58cdecode(sk, this.prefix.spsk)));\r\n      let sig = key.sign(hash, { canonical: true });\r\n      sig = new Uint8Array(sig.r.toArray().concat(sig.s.toArray()));\r\n      const spsig = this.b58cencode(sig, this.prefix.spsig);\r\n      const sbytes = bytes + this.buf2hex(sig);\r\n      return {\r\n        bytes: bytes,\r\n        sig: sig,\r\n        edsig: spsig,\r\n        sbytes: sbytes,\r\n      };\r\n    } else {\r\n      const hash = libs.crypto_generichash(32, this.hex2buf(bytes));\r\n      bytes = bytes.slice(2);\r\n      const sig = libs.crypto_sign_detached(hash, this.b58cdecode(sk, this.prefix.edsk), 'uint8array');\r\n      const edsig = this.b58cencode(sig, this.prefix.edsig);\r\n      const sbytes = bytes + this.buf2hex(sig);\r\n      return {\r\n        bytes: bytes,\r\n        sig: sig,\r\n        edsig: edsig,\r\n        sbytes: sbytes,\r\n      };\r\n    }\r\n  }\r\n  hexsigToEdsig(hex: string): string {\r\n    return this.b58cencode(this.hex2buf(hex), this.prefix.edsig);\r\n  }\r\n  verify(bytes: string, sig: string, pk: string): Boolean {\r\n    console.log('bytes', bytes);\r\n    const hash = libs.crypto_generichash(32, this.hex2buf(bytes));\r\n    const signature = this.b58cdecode(sig, this.prefix.edsig);\r\n    const publicKey = this.b58cdecode(pk, this.prefix.edpk);\r\n    return libs.crypto_sign_verify_detached(signature, hash, publicKey);\r\n  }\r\n  sig2edsig(sig: string): any {\r\n    return this.b58cencode(this.hex2buf(sig), this.prefix.edsig);\r\n  }\r\n  decodeString(bytes: string): string {\r\n    return Buffer.from(this.hex2buf(bytes)).toString('utf-8');\r\n  }\r\n  zarithDecode(hex: string): any {\r\n    let count = 0;\r\n    let value = 0;\r\n    while (1) {\r\n      const byte = Number('0x' + hex.slice(0 + count * 2, 2 + count * 2));\r\n      value += ((byte & 127) * (128 ** count));\r\n      count++;\r\n      if ((byte & 128) !== 128) {\r\n        break;\r\n      }\r\n    }\r\n    return {\r\n      value: value,\r\n      count: count\r\n    };\r\n  }\r\n  zarithDecodeInt(hex: string): any {\r\n    let count = 0;\r\n    let value = Big(0);\r\n    while (1) {\r\n      const byte = Number('0x' + hex.slice(0 + count * 2, 2 + count * 2));\r\n      if (count === 0) {\r\n        value = Big(((byte & 63) * (128 ** count))).add(value);\r\n      } else {\r\n        value = Big(((byte & 127) * 2) >> 1).times(64 * 128 ** (count - 1)).add(value);\r\n      }\r\n      count++;\r\n      if ((byte & 128) !== 128) {\r\n        break;\r\n      }\r\n    }\r\n    return {\r\n      value: value,\r\n      count: count\r\n    };\r\n  }\r\n  getContractDelegation(pkh: string) {\r\n    return {\r\n      entrypoint: 'do',\r\n      value:\r\n        [{ prim: 'DROP' },\r\n        {\r\n          prim: 'NIL',\r\n          args: [{ prim: 'operation' }]\r\n        },\r\n        {\r\n          prim: 'PUSH',\r\n          args:\r\n            [{ prim: 'key_hash' },\r\n            {\r\n              string: pkh\r\n            }]\r\n        },\r\n        { prim: 'SOME' }, { prim: 'SET_DELEGATE' },\r\n        { prim: 'CONS' }]\r\n    };\r\n  }\r\n  getContractUnDelegation() {\r\n    return {\r\n      entrypoint: 'do',\r\n      value:\r\n        [{ prim: 'DROP' },\r\n        {\r\n          prim: 'NIL',\r\n          args: [{ prim: 'operation' }],\r\n        }, {\r\n          prim: 'NONE',\r\n          args: [{ prim: 'key_hash' }],\r\n        },\r\n        { prim: 'SET_DELEGATE' },\r\n        { prim: 'CONS' }]\r\n    };\r\n  }\r\n  getContractPkhTransaction(to: string, amount: string) {\r\n    return {\r\n      entrypoint: 'do',\r\n      value:\r\n        [{ prim: 'DROP' },\r\n        { prim: 'NIL', args: [{ prim: 'operation' }] },\r\n        {\r\n          prim: 'PUSH',\r\n          args:\r\n            [{ prim: 'key_hash' },\r\n            {\r\n              string: to\r\n            }]\r\n        },\r\n        { prim: 'IMPLICIT_ACCOUNT' },\r\n        {\r\n          prim: 'PUSH',\r\n          args:\r\n            [{ prim: 'mutez' }, { 'int': amount }]\r\n        },\r\n        { prim: 'UNIT' }, { prim: 'TRANSFER_TOKENS' },\r\n        { prim: 'CONS' }]\r\n    };\r\n  }\r\n  getContractKtTransaction(to: string, amount: string) {\r\n    return {\r\n      entrypoint: 'do',\r\n      value: [{ prim: 'DROP' },\r\n      { prim: 'NIL', args: [{ prim: 'operation' }] },\r\n      {\r\n        prim: 'PUSH',\r\n        args:\r\n          [{ prim: 'address' },\r\n          { string: to }]\r\n      },\r\n      { prim: 'CONTRACT', args: [{ prim: 'unit' }] },\r\n      [{\r\n        prim: 'IF_NONE',\r\n        args:\r\n          [[[{ prim: 'UNIT' }, { prim: 'FAILWITH' }]],\r\n          []]\r\n      }],\r\n      {\r\n        prim: 'PUSH',\r\n        args: [{ prim: 'mutez' }, { 'int': amount }]\r\n      },\r\n      { prim: 'UNIT' }, { prim: 'TRANSFER_TOKENS' },\r\n      { prim: 'CONS' }]\r\n    };\r\n  }\r\n  getManagerScript(pkh: string) {\r\n    let pkHex: string;\r\n    if (pkh.slice(0, 2) === 'tz') {\r\n      pkHex = '00' + this.buf2hex(this.b58cdecode(pkh, this.prefix.tz1));\r\n    } else {\r\n      pkHex = pkh;\r\n    }\r\n    return {\r\n      code: [\r\n        {\r\n          prim: 'parameter',\r\n          args: [\r\n            {\r\n              prim: 'or',\r\n              args: [\r\n                {\r\n                  prim: 'lambda',\r\n                  args: [\r\n                    {\r\n                      prim: 'unit'\r\n                    },\r\n                    {\r\n                      prim: 'list',\r\n                      args: [\r\n                        {\r\n                          prim: 'operation'\r\n                        }\r\n                      ]\r\n                    }\r\n                  ],\r\n                  annots: [\r\n                    '%do'\r\n                  ]\r\n                },\r\n                {\r\n                  prim: 'unit',\r\n                  annots: [\r\n                    '%default'\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          prim: 'storage',\r\n          args: [\r\n            {\r\n              prim: 'key_hash'\r\n            }\r\n          ]\r\n        },\r\n        {\r\n          prim: 'code',\r\n          args: [\r\n            [\r\n              [\r\n                [\r\n                  {\r\n                    prim: 'DUP'\r\n                  },\r\n                  {\r\n                    prim: 'CAR'\r\n                  },\r\n                  {\r\n                    prim: 'DIP',\r\n                    args: [\r\n                      [\r\n                        {\r\n                          prim: 'CDR'\r\n                        }\r\n                      ]\r\n                    ]\r\n                  }\r\n                ]\r\n              ],\r\n              {\r\n                prim: 'IF_LEFT',\r\n                args: [\r\n                  [\r\n                    {\r\n                      prim: 'PUSH',\r\n                      args: [\r\n                        {\r\n                          prim: 'mutez'\r\n                        },\r\n                        {\r\n                          'int': '0'\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      prim: 'AMOUNT'\r\n                    },\r\n                    [\r\n                      [\r\n                        {\r\n                          prim: 'COMPARE'\r\n                        },\r\n                        {\r\n                          prim: 'EQ'\r\n                        }\r\n                      ],\r\n                      {\r\n                        prim: 'IF',\r\n                        args: [\r\n                          [\r\n\r\n                          ],\r\n                          [\r\n                            [\r\n                              {\r\n                                prim: 'UNIT'\r\n                              },\r\n                              {\r\n                                prim: 'FAILWITH'\r\n                              }\r\n                            ]\r\n                          ]\r\n                        ]\r\n                      }\r\n                    ],\r\n                    [\r\n                      {\r\n                        prim: 'DIP',\r\n                        args: [\r\n                          [\r\n                            {\r\n                              prim: 'DUP'\r\n                            }\r\n                          ]\r\n                        ]\r\n                      },\r\n                      {\r\n                        prim: 'SWAP'\r\n                      }\r\n                    ],\r\n                    {\r\n                      prim: 'IMPLICIT_ACCOUNT'\r\n                    },\r\n                    {\r\n                      prim: 'ADDRESS'\r\n                    },\r\n                    {\r\n                      prim: 'SENDER'\r\n                    },\r\n                    [\r\n                      [\r\n                        {\r\n                          prim: 'COMPARE'\r\n                        },\r\n                        {\r\n                          prim: 'EQ'\r\n                        }\r\n                      ],\r\n                      {\r\n                        prim: 'IF',\r\n                        args: [\r\n                          [\r\n\r\n                          ],\r\n                          [\r\n                            [\r\n                              {\r\n                                prim: 'UNIT'\r\n                              },\r\n                              {\r\n                                prim: 'FAILWITH'\r\n                              }\r\n                            ]\r\n                          ]\r\n                        ]\r\n                      }\r\n                    ],\r\n                    {\r\n                      prim: 'UNIT'\r\n                    },\r\n                    {\r\n                      prim: 'EXEC'\r\n                    },\r\n                    {\r\n                      prim: 'PAIR'\r\n                    }\r\n                  ],\r\n                  [\r\n                    {\r\n                      prim: 'DROP'\r\n                    },\r\n                    {\r\n                      prim: 'NIL',\r\n                      args: [\r\n                        {\r\n                          prim: 'operation'\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      prim: 'PAIR'\r\n                    }\r\n                  ]\r\n                ]\r\n              }\r\n            ]\r\n          ]\r\n        }\r\n      ],\r\n      storage:\r\n        { bytes: pkHex }\r\n    };\r\n  }\r\n  getFA12Transaction(from: string, to: string, amount: string) {\r\n    return {\r\n      entrypoint: 'transfer',\r\n      value: {\r\n        args: [\r\n          {\r\n            string: from\r\n          }, {\r\n            args: [\r\n              {\r\n                string: to\r\n              }, {\r\n                int: amount\r\n              }\r\n            ],\r\n            prim: 'Pair'\r\n          }\r\n        ],\r\n        prim: 'Pair'\r\n      }\r\n    };\r\n  }\r\n  getFA2Transaction(from: string, to: string, amount: string, id: number) {\r\n    return {\r\n      entrypoint: 'transfer',\r\n      value: [\r\n        {\r\n          prim: 'Pair',\r\n          args: [\r\n            {\r\n              string: from\r\n            },\r\n            [\r\n              {\r\n                prim: 'Pair',\r\n                args: [\r\n                  {\r\n                    string: to\r\n                  },\r\n                  {\r\n                    prim: 'Pair',\r\n                    args: [\r\n                      {\r\n                        'int': id.toString()\r\n                      },\r\n                      {\r\n                        'int': amount\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n  parseTokenTransfer(op: any): { tokenId: string, to: string, amount: string } {\r\n    const opJson = JSON.stringify(op.parameters);\r\n    const addresses = opJson.match(/\\{\\\"string\\\":\\\"[^\\\"]*/g)?.map(s => {\r\n      return s.slice(11);\r\n    });\r\n    const amounts = opJson.match(/\\{\\\"int\\\":\\\"[^\\\"]*/g)?.map(i => {\r\n      return i.slice(8);\r\n    });\r\n    if (!addresses || !amounts) {\r\n      return null;\r\n    }\r\n    if (addresses.length === 2) {\r\n      if (amounts.length === 1) {\r\n        const fa12ref = this.getFA12Transaction(addresses[0], addresses[1], amounts[0]);\r\n        if (isEqual(fa12ref, op.parameters)) {\r\n          return { tokenId: `${op.destination}:0`, to: addresses[1], amount: amounts[0] };\r\n        }\r\n      } else if (amounts.length === 2) {\r\n        const fa2ref = this.getFA2Transaction(addresses[0], addresses[1], amounts[1], Number(amounts[0]));\r\n        if (isEqual(fa2ref, op.parameters)) {\r\n          return { tokenId: `${op.destination}:${amounts[0]}`, to: addresses[1], amount: amounts[1] };\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n}\r\n","/* (ignored) */","<img class=\"add\" *ngIf=\"walletService.isHdWallet()\" src=\"../../../assets/img/add.svg\" (click)=\"openModal()\">\r\n<!-- The Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModal()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1>Add a new account</H1>\r\n    </div>\r\n    <!-- Prepare delegation -->\r\n    <div class=\"km-body\">\r\n      <p>Add a new account to your HD wallet. Enter your password to confirm.</p>\r\n      <div class=\"row-group\" style=\"margin: 1.25rem 0 1.5rem;\">\r\n        <input #pwdInput [(ngModel)]=\"password\" class=\"text password\" autocomplete=\"current-password\" placeholder=\"Password\" type=\"password\" (input)=\"this.errorMsg = ''\" (change)=\"this.errorMsg = ''\">\r\n        <button  class=\"blue confirm\" (click)=\"addPkh()\">Confirm</button>\r\n      </div>\r\n      <span *ngIf=\"this.errorMsg\" class=\"danger margin\">{{ this.errorMsg }}</span>\r\n    </div>\r\n  </div>\r\n</div>","import { Component, OnInit, ViewChild, TemplateRef, ChangeDetectorRef, ElementRef } from '@angular/core';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { HdWallet } from '../../services/wallet/wallet';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { BsModalService, BsModalRef } from 'ngx-bootstrap/modal';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n@Component({\r\n  selector: 'app-new-implicit',\r\n  templateUrl: './new-implicit.component.html',\r\n  styleUrls: ['./new-implicit.component.scss'],\r\n})\r\nexport class NewImplicitComponent implements OnInit {\r\n  @ViewChild('pwdInput') pwdView: ElementRef;\r\n  modalOpen = false;\r\n  password = '';\r\n  errorMsg = '';\r\n  modalRef1: BsModalRef;\r\n  constructor(\r\n    public walletService: WalletService,\r\n    private coordinatorService: CoordinatorService,\r\n    private modalService: BsModalService,\r\n    private messageService: MessageService,\r\n    private cdRef: ChangeDetectorRef\r\n  ) {}\r\n  openModal() {\r\n    if (this.openPkhSpot()) {\r\n      // hide body scrollbar\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflow = 'hidden';\r\n      this.clear();\r\n      this.modalOpen = true;\r\n      setTimeout(() => {\r\n        const inputElem = <HTMLInputElement>this.pwdView.nativeElement;\r\n        inputElem.focus();\r\n      }, 100);\r\n    } else {\r\n      this.messageService.addWarning('Can\\'t create additional accounts when an unused account already exists');\r\n    }\r\n  }\r\n  closeModal() {\r\n    // restore body scrollbar\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.clear();\r\n    this.modalOpen = false;\r\n  }\r\n  ngOnInit(): void {}\r\n  async addPkh() {\r\n    if (this.openPkhSpot()) {\r\n      this.messageService.startSpinner('Creating new account');\r\n      const pkh = await this.walletService.incrementAccountIndex(this.password);\r\n      if (pkh) {\r\n        this.coordinatorService.start(pkh);\r\n        this.closeModal();\r\n      } else {\r\n        this.errorMsg = 'Wrong password!';\r\n      }\r\n      this.messageService.stopSpinner();\r\n    } else {\r\n      console.log('blocked!');\r\n    }\r\n  }\r\n  openPkhSpot(): boolean {\r\n    const state: string = this.walletService.wallet.implicitAccounts[\r\n      this.walletService.wallet.implicitAccounts.length - 1\r\n    ].state;\r\n    const balance: number = this.walletService.wallet.implicitAccounts[\r\n      this.walletService.wallet.implicitAccounts.length - 1\r\n    ].balanceXTZ;\r\n    return (\r\n      this.walletService.wallet instanceof HdWallet &&\r\n      ( state.length > 0 || (balance !== null && balance > 0))\r\n    );\r\n  }\r\n  clear() {\r\n    this.password = '';\r\n    this.errorMsg = '';\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivityService } from '../activity/activity.service';\r\nimport { TzrateService } from '../tzrate/tzrate.service';\r\nimport { BalanceService } from '../balance/balance.service';\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { DelegateService } from '../delegate/delegate.service';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { ErrorHandlingPipe } from '../../pipes/error-handling.pipe';\r\nimport { Account } from '../wallet/wallet';\r\nimport Big from 'big.js';\r\nimport { TokenService } from '../token/token.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\n\r\nexport interface ScheduleData {\r\n  pkh: string;\r\n  state: State;\r\n  interval: any;\r\n  stateCounter: number;\r\n}\r\nenum State {\r\n  UpToDate,\r\n  Wait,\r\n  Updating,\r\n}\r\n\r\n@Injectable()\r\nexport class CoordinatorService {\r\n  scheduler: Map<string, any> = new Map<string, any>(); // pkh + delay\r\n  defaultDelayActivity = CONSTANTS.MAINNET ? 60000 : 30000; // 60/30s\r\n  shortDelayActivity = 5000; // 5s\r\n  tzrateInterval: any;\r\n  defaultDelayPrice = CONSTANTS.MAINNET ? 300000 : 3600000; // 5/60m\r\n  accounts: Account[];\r\n  constructor(\r\n    private activityService: ActivityService,\r\n    private tzrateService: TzrateService,\r\n    private walletService: WalletService,\r\n    private balanceService: BalanceService,\r\n    private delegateService: DelegateService,\r\n    private operationService: OperationService,\r\n    private errorHandlingPipe: ErrorHandlingPipe,\r\n    private tokenService: TokenService\r\n  ) {}\r\n  startAll() {\r\n    if (this.walletService.wallet) {\r\n      this.accounts = this.walletService.wallet.getAccounts();\r\n      for (let i = 0; i < this.accounts.length; i++) {\r\n        this.start(this.accounts[i].address);\r\n      }\r\n      this.startXTZ();\r\n    } else {\r\n      console.log('no wallet found');\r\n    }\r\n  }\r\n  startXTZ() {\r\n    if (!this.tzrateInterval) {\r\n      console.log('Start scheduler XTZ');\r\n      this.tzrateService.getTzrate();\r\n      this.tzrateInterval = setInterval(\r\n        () => this.tzrateService.getTzrate(),\r\n        this.defaultDelayPrice\r\n      );\r\n    }\r\n  }\r\n  async start(pkh: string) {\r\n    if (pkh && !this.scheduler.get(pkh)) {\r\n      this.accounts = this.walletService.wallet.getAccounts();\r\n      console.log('Start scheduler ' + this.scheduler.size + ' ' + pkh);\r\n      const scheduleData: ScheduleData = {\r\n        pkh: pkh,\r\n        state: State.UpToDate,\r\n        interval: setInterval(\r\n          () => this.update(pkh),\r\n          this.defaultDelayActivity\r\n        ),\r\n        stateCounter: 0,\r\n      };\r\n      this.scheduler.set(pkh, scheduleData);\r\n      this.update(pkh);\r\n      this.updateAccountData(pkh);\r\n    }\r\n  }\r\n  async boost(pkh: string, metadata: any = null) {\r\n    // Expect action\r\n    console.log('boost ' + pkh);\r\n    if (this.walletService.addressExists(pkh)) {\r\n      if (metadata) {\r\n        this.addUnconfirmedOperations(pkh, metadata);\r\n      }\r\n      if (!this.scheduler.get(pkh)) {\r\n        await this.start(pkh);\r\n      }\r\n      if (this.scheduler.get(pkh).state !== State.Wait) {\r\n        this.changeState(pkh, State.Wait);\r\n        this.update(pkh);\r\n        const counter = this.scheduler.get(pkh).stateCounter;\r\n        setTimeout(() => {\r\n          // Failsafe\r\n          if (\r\n            this.scheduler?.size &&\r\n            this.scheduler.get(pkh).stateCounter === counter\r\n          ) {\r\n            console.log('Timeout from wait state');\r\n            this.changeState(pkh, State.UpToDate);\r\n          }\r\n        }, 150000);\r\n      }\r\n    }\r\n  }\r\n  async update(pkh) {\r\n    this.setDelay(pkh, this.defaultDelayActivity);\r\n    this.activityService.updateTransactions(pkh).subscribe(\r\n      (ans: any) => {\r\n        switch (this.scheduler.get(pkh) ? this.scheduler.get(pkh).state : -1) {\r\n          case State.UpToDate: {\r\n            if (!ans.upToDate) {\r\n              this.changeState(pkh, State.Updating);\r\n            }\r\n            break;\r\n          }\r\n          case State.Wait: {\r\n            if (!ans.upToDate) {\r\n              this.changeState(pkh, State.Updating);\r\n            } else {\r\n              this.setDelay(pkh, this.shortDelayActivity);\r\n            }\r\n            break;\r\n          }\r\n          case State.Updating: {\r\n            if (ans.upToDate) {\r\n              this.changeState(pkh, State.UpToDate);\r\n            } else {\r\n              this.setDelay(pkh, this.shortDelayActivity);\r\n            }\r\n            break;\r\n          }\r\n          default: {\r\n            console.log('No state found!');\r\n            break;\r\n          }\r\n        }\r\n        const acc = this.walletService.wallet.getAccount(pkh);\r\n        if (acc && acc.activities.length) {\r\n          const latestActivity = acc.activities[0];\r\n          if (latestActivity.status === 0) {\r\n            const age = new Date().getTime() - new Date(latestActivity.timestamp).getTime();\r\n            if (age > 360000) {\r\n              acc.activities.shift();\r\n              this.walletService.storeWallet();\r\n            }\r\n          }\r\n        }\r\n      },\r\n      err => console.log('Error in update(): ' + JSON.stringify(err)),\r\n      () => {\r\n        console.log(`account[${this.accounts.findIndex((a) => a.address === pkh)}][${\r\n          typeof this.scheduler.get(pkh)?.state !== 'undefined' ? this.scheduler.get(pkh).state : '*'}]: <<`);\r\n      }\r\n    );\r\n  }\r\n  changeState(pkh: string, newState: State) {\r\n    const scheduleData: ScheduleData = this.scheduler.get(pkh);\r\n    scheduleData.state = newState;\r\n    if (newState === State.UpToDate || newState === State.Updating) {\r\n      this.updateAccountData(pkh);\r\n    }\r\n    if (newState === State.Wait || newState === State.Updating) {\r\n      clearInterval(scheduleData.interval);\r\n      scheduleData.interval = setInterval(\r\n        () => this.update(pkh),\r\n        this.shortDelayActivity\r\n      );\r\n    }\r\n    scheduleData.stateCounter++;\r\n    this.scheduler.set(pkh, scheduleData);\r\n  }\r\n  setDelay(pkh: string, time: number) {\r\n    const scheduleData: ScheduleData = this.scheduler.get(pkh);\r\n    if (scheduleData.interval) {\r\n      clearInterval(scheduleData.interval);\r\n    }\r\n    scheduleData.interval = setInterval(() => this.update(pkh), time);\r\n    this.scheduler.set(pkh, scheduleData);\r\n  }\r\n  stopAll() {\r\n    if (this.walletService.wallet) {\r\n      console.log('Stop all schedulers');\r\n      for (\r\n        let i = 0;\r\n        i < this.accounts.length;\r\n        i++\r\n      ) {\r\n        this.stop(this.accounts[i].address);\r\n      }\r\n      clearInterval(this.tzrateInterval);\r\n      this.tzrateInterval = null;\r\n    }\r\n  }\r\n  async stop(pkh) {\r\n    console.log(\r\n      'Stop scheduler ' + this.accounts.findIndex((a) => a.address === pkh)\r\n    );\r\n    clearInterval(this.scheduler.get(pkh).interval);\r\n    this.scheduler.get(pkh).interval = null;\r\n    this.scheduler.delete(pkh);\r\n  }\r\n  updateAccountData(pkh: string) {\r\n    // Maybe also check for originations to account?\r\n    console.log('update account data for ' + pkh);\r\n    this.operationService.getAccount(pkh).subscribe((ans: any) => {\r\n      if (ans.success) {\r\n        this.balanceService.updateAccountBalance(\r\n          this.walletService.wallet.getAccount(pkh),\r\n          Number(ans.payload.balance)\r\n        );\r\n        const acc = this.walletService.wallet.getAccount(pkh);\r\n        this.delegateService.handleDelegateResponse(acc, ans.payload.delegate);\r\n      } else {\r\n        console.log('updateAccountData -> getAccount failed ', ans.payload.msg);\r\n      }\r\n    });\r\n  }\r\n  addUnconfirmedOperations(from: string, metadata: any) {\r\n    if (metadata.transactions) {\r\n      console.log('Unconfirmed transactions:');\r\n      console.log(metadata.transactions);\r\n      const decimals = metadata.tokenTransfer && this.tokenService.getAsset(metadata.tokenTransfer) ? this.tokenService.getAsset(metadata.tokenTransfer).decimals : 6;\r\n      for (const op of metadata.transactions) {\r\n        const transaction = {\r\n          type: 'transaction',\r\n          status: 0,\r\n          amount: Big(op.amount).times(10 ** decimals).toString(),\r\n          fee: null,\r\n          source: { address: from },\r\n          destination: { address: op.to },\r\n          hash: metadata.opHash,\r\n          block: null,\r\n          timestamp: new Date().getTime(),\r\n          tokenId: metadata.tokenTransfer ? metadata.tokenTransfer : undefined,\r\n          entrypoint: op.parameters?.entrypoint ? op.parameters.entrypoint : ''\r\n        };\r\n        let account = this.walletService.wallet.getAccount(from);\r\n        account.activities.unshift(transaction);\r\n        account = this.walletService.wallet.getAccount(op.to);\r\n        if (account) {\r\n          account.activities.unshift(transaction);\r\n        }\r\n      }\r\n    } else if (metadata.delegate !== undefined) {\r\n      const delegation = {\r\n        type: 'delegation',\r\n        status: 0,\r\n        amount: null,\r\n        fee: null,\r\n        source: { address: from },\r\n        destination: { address: metadata.delegate },\r\n        hash: metadata.opHash,\r\n        block: null,\r\n        timestamp: new Date().getTime()\r\n      };\r\n      const account = this.walletService.wallet.getAccount(from);\r\n      account.activities.unshift(delegation);\r\n    } else {\r\n      console.log('Unknown metadata', metadata);\r\n    }\r\n    this.walletService.storeWallet();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Params } from '@angular/router';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DeeplinkService {\r\n  private pairingJson = '';\r\n  constructor(\r\n    private operationService: OperationService,\r\n    private walletService: WalletService,\r\n    private messageService: MessageService\r\n  ) { }\r\n  set(params: Params) {\r\n    console.log(params);\r\n    this.pairingJson = this.extractPairingJson(params);\r\n    if (this.pairingJson && !this.walletService.wallet) {\r\n      this.messageService.addWarning('Access your wallet to complete the pairing');\r\n    }\r\n    console.log(this.pairingJson);\r\n  }\r\n  extractPairingJson(params: Params): string {\r\n    if (params.type === 'tzip10' && params.data) {\r\n      try {\r\n        return this.operationService.b58cdecode(params.data, '').toString();\r\n      } catch (e) {\r\n        return '';\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  popPairingJson(): string {\r\n    const pairingJson = this.pairingJson;\r\n    this.pairingJson = '';\r\n    return pairingJson;\r\n  }\r\n  QRtoPairingJson(qrPayload: string): string {\r\n    if (qrPayload.length > 26 && qrPayload.slice(0, 26) === 'tezos://?type=tzip10&data=') {\r\n      qrPayload = qrPayload.slice(26);\r\n    }\r\n    try {\r\n      return this.operationService.b58cdecode(qrPayload, '').toString();\r\n    } catch {}\r\n    return '';\r\n  }\r\n}\r\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","import { Injectable } from '@angular/core';\r\nimport { ConseilService } from './conseil/conseil.service';\r\nimport { TzktService } from './tzkt/tzkt.service';\r\nimport { WalletObject } from '../wallet/wallet';\r\n\r\nexport interface Indexer {\r\n  getContractAddresses(pkh: string): Promise<any>;\r\n  accountInfo(address: string): Promise<any>;\r\n  getOperations(address: string, knownTokenIds: string[], wallet: WalletObject): Promise<any>;\r\n}\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class IndexerService {\r\n  constructor(\r\n    public tzktService: TzktService\r\n  ) {}\r\n  async getContractAddresses(address: string): Promise<any> {\r\n    return this.tzktService.getContractAddresses(address);\r\n  }\r\n  async accountInfo(address: string, knownTokenIds: string[] = []): Promise<any> {\r\n    return this.tzktService.accountInfo(address, knownTokenIds);\r\n  }\r\n  async getOperations(address: string, knownTokenIds: string[], wallet: WalletObject): Promise<any> {\r\n    return this.tzktService.getOperations(address, knownTokenIds, wallet);\r\n  }\r\n  async getTokenMetadata(contractAddress: string, id: number): Promise<any> {\r\n    return this.tzktService.getTokenMetadata(contractAddress, id);\r\n  }\r\n}\r\n","/* (ignored) */","/* (ignored) */","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n/*\r\n    Informs users on most common errors\r\n    RPC errors doc: http://tezos.gitlab.io/mainnet/api/errors.html\r\n*/\r\n\r\n@Pipe({\r\n  name: 'errorHandling',\r\n})\r\nexport class ErrorHandlingPipe implements PipeTransform {\r\n  ERROR_LIST = [\r\n    {\r\n      msg: 'A fatal assertion failed',\r\n      id: 'proto.alpha.assertion',\r\n    },\r\n    {\r\n      msg: 'The block\\'s proof-of-work stamp is insufficient',\r\n      id: 'proto.alpha.baking.insufficient_proof_of_work',\r\n    },\r\n    {\r\n      msg: 'A block was not signed with the expected private key.',\r\n      id: 'proto.alpha.baking.invalid_block_signature',\r\n    },\r\n    {\r\n      msg: 'The gap of fitness is out of bounds',\r\n      id: 'proto.alpha.baking.invalid_fitness_gap',\r\n    },\r\n    {\r\n      msg: 'The block\\'s signature is invalid',\r\n      id: 'proto.alpha.baking.invalid_signature',\r\n    },\r\n    {\r\n      msg:\r\n        'The block timestamp is before the first slot for this baker at this level',\r\n      id: 'proto.alpha.baking.timestamp_too_early',\r\n    },\r\n    {\r\n      msg: 'The operation is signed by a delegate without endorsement rights.',\r\n      id: 'proto.alpha.baking.unexpected_endorsement',\r\n    },\r\n    {\r\n      msg: 'A double-baking evidence is inconsistent (two distinct delegates)',\r\n      id: 'proto.alpha.block.inconsistent_double_baking_evidence',\r\n    },\r\n    {\r\n      msg:\r\n        'A double-endorsement evidence is inconsistent (two distinct delegates)',\r\n      id: 'proto.alpha.block.inconsistent_double_endorsement_evidence',\r\n    },\r\n    {\r\n      msg: 'The block header has invalid commitment.',\r\n      id: 'proto.alpha.block.invalid_commitment',\r\n    },\r\n    {\r\n      msg: 'A double-baking evidence is inconsistent (two distinct level)',\r\n      id: 'proto.alpha.block.invalid_double_baking_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-endorsement evidence is malformed',\r\n      id: 'proto.alpha.block.invalid_double_endorsement_evidence',\r\n    },\r\n    {\r\n      msg: 'A manager operation should not contain more than one revelation',\r\n      id: 'proto.alpha.block.multiple_revelation',\r\n    },\r\n    {\r\n      msg: 'A double-baking evidence is outdated.',\r\n      id: 'proto.alpha.block.outdated_double_baking_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-endorsement evidence is outdated.',\r\n      id: 'proto.alpha.block.outdated_double_endorsement_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-baking evidence is in the future',\r\n      id: 'proto.alpha.block.too_early_double_baking_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-endorsement evidence is in the future',\r\n      id: 'proto.alpha.block.too_early_double_endorsement_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-baking evidence is unrequired',\r\n      id: 'proto.alpha.block.unrequired_double_baking_evidence',\r\n    },\r\n    {\r\n      msg: 'A double-endorsement evidence is unrequired',\r\n      id: 'proto.alpha.block.unrequired_double_endorsement_evidence',\r\n    },\r\n    {\r\n      msg: 'Unexpected JSON object.',\r\n      id: 'proto.alpha.context.failed_to_decode_parameter',\r\n    },\r\n    {\r\n      msg: 'The protocol parameters are not valid JSON.',\r\n      id: 'proto.alpha.context.failed_to_parse_parameter',\r\n    },\r\n    {\r\n      msg:\r\n        'An error that should never happen unless something has been deleted or corrupted in the database.',\r\n      id: 'proto.alpha.context.storage_error',\r\n    },\r\n    {\r\n      msg: 'An operation tried to spend more tokens than the contract has',\r\n      id: 'proto.alpha.contract.balance_too_low',\r\n    },\r\n    {\r\n      msg: 'The storage fee is higher than the contract balance',\r\n      id: 'proto.alpha.contract.cannot_pay_storage_fee',\r\n    },\r\n    {\r\n      msg: 'An operation assumed a contract counter in the future',\r\n      id: 'proto.alpha.contract.counter_in_the_future',\r\n    },\r\n    {\r\n      msg: 'An operation assumed a contract counter in the past',\r\n      id: 'proto.alpha.contract.counter_in_the_past',\r\n    },\r\n    {\r\n      msg: 'Forbidden to credit 0ꜩ to a contract without code.',\r\n      id: 'proto.alpha.contract.empty_transaction',\r\n    },\r\n    {\r\n      msg: 'Unexpected contract storage error',\r\n      id: 'proto.alpha.contract.failure',\r\n    },\r\n    {\r\n      msg: 'A malformed contract notation was given to an RPC or in a script.',\r\n      id: 'proto.alpha.contract.invalid_contract_notation',\r\n    },\r\n    {\r\n      msg: 'Change is not enough to consume a roll.',\r\n      id: 'proto.alpha.contract.manager.consume_roll_change',\r\n    },\r\n    {\r\n      msg:\r\n        'A revealed manager public key is inconsistent with the announced hash',\r\n      id: 'proto.alpha.contract.manager.inconsistent_hash',\r\n    },\r\n    {\r\n      msg:\r\n        'A provided manager public key is different with the public key stored in the contract',\r\n      id: 'proto.alpha.contract.manager.inconsistent_public_key',\r\n    },\r\n    {\r\n      msg: 'Delegate has no roll.',\r\n      id: 'proto.alpha.contract.manager.no_roll_for_delegate',\r\n    },\r\n    {\r\n      msg:\r\n        'A snapshot of the rolls distribution does not exist for this cycle.',\r\n      id: 'proto.alpha.contract.manager.no_roll_snapshot_for_cycle',\r\n    },\r\n    {\r\n      msg: 'A contract cannot be delegated to an unregistered delegate',\r\n      id: 'proto.alpha.contract.manager.unregistered_delegate',\r\n    },\r\n    {\r\n      msg:\r\n        'A contract handle is not present in the context (either it never was or it has been destroyed)',\r\n      id: 'proto.alpha.contract.non_existing_contract',\r\n    },\r\n    {\r\n      msg: 'One tried to revealed twice a manager public key',\r\n      id: 'proto.alpha.contract.previously_revealed_key',\r\n    },\r\n    {\r\n      msg:\r\n        'One tried to apply a manager operation without revealing the manager public key',\r\n      id: 'proto.alpha.contract.unrevealed_key',\r\n    },\r\n    {\r\n      msg: 'An operation tried to spend tokens from an unspendable contract',\r\n      id: 'proto.alpha.contract.unspendable_contract',\r\n    },\r\n    {\r\n      msg: 'Useless delegate reactivation',\r\n      id: 'proto.alpha.delegate.already_active',\r\n    },\r\n    {\r\n      msg: 'Cannot freeze deposit when the balance is too low',\r\n      id: 'proto.alpha.delegate.balance_too_low_for_deposit',\r\n    },\r\n    {\r\n      msg: 'Cannot register a delegate when its implicit account is empty',\r\n      id: 'proto.alpha.delegate.empty_delegate_account',\r\n    },\r\n    {\r\n      msg: 'Tried to unregister a delegate',\r\n      id: 'proto.alpha.delegate.no_deletion',\r\n    },\r\n    {\r\n      msg: 'Contract already delegated to the given delegate',\r\n      id: 'proto.alpha.delegate.unchanged',\r\n    },\r\n    {\r\n      msg: 'Proposal lists cannot be empty.',\r\n      id: 'proto.alpha.empty_proposal',\r\n    },\r\n    {\r\n      msg:\r\n        'The sum of gas consumed by all the operations in the block exceeds the hard gas limit per block',\r\n      id: 'proto.alpha.gas_exhausted.block',\r\n    },\r\n    {\r\n      msg:\r\n        'Gas limit was not high enough to deserialize the transaction parameters or origination script code or initial storage, making the operation impossible to parse within the provided gas bounds.',\r\n      id: 'proto.alpha.gas_exhausted.init_deserialize',\r\n    },\r\n    {\r\n      msg:\r\n        'An operation tried to exceed the gas limit',\r\n      id: 'proto.alpha.gas_exhausted.operation',\r\n    },\r\n    {\r\n      msg: 'A transaction tried to exceed the hard limit on gas',\r\n      id: 'proto.alpha.gas_limit_too_high',\r\n    },\r\n    {\r\n      msg: 'No manager operations are allowed on an empty implicit contract.',\r\n      id: 'proto.alpha.implicit.empty_implicit_contract',\r\n    },\r\n    {\r\n      msg: 'Emptying an implicit delegated account is not allowed.',\r\n      id: 'proto.alpha.implicit.empty_implicit_delegated_contract',\r\n    },\r\n    {\r\n      msg:\r\n        'The number of endorsements must be non-negative and at most the endosers_per_block constant.',\r\n      id: 'proto.alpha.incorrect_number_of_endorsements',\r\n    },\r\n    {\r\n      msg: 'Block priority must be non-negative.',\r\n      id: 'proto.alpha.incorrect_priority',\r\n    },\r\n    {\r\n      msg: 'An internal operation was emitted twice by a script',\r\n      id: 'proto.alpha.internal_operation_replay',\r\n    },\r\n    {\r\n      msg: 'A compile-time constant was invalid for its expected form.',\r\n      id: 'proto.alpha.invalidSyntacticConstantError',\r\n    },\r\n    {\r\n      msg: 'Negative multiple of periods are not allowed.',\r\n      id: 'proto.alpha.invalid_arg',\r\n    },\r\n    {\r\n      msg:\r\n        'Could not deserialize some piece of data from its binary representation',\r\n      id: 'proto.alpha.invalid_binary_format',\r\n    },\r\n    {\r\n      msg: 'Fitness representation should be exactly 8 bytes long.',\r\n      id: 'proto.alpha.invalid_fitness',\r\n    },\r\n    {\r\n      msg: 'Ballot provided for a proposal that is not the current one.',\r\n      id: 'proto.alpha.invalid_proposal',\r\n    },\r\n    {\r\n      msg: 'Period is negative.',\r\n      id: 'proto.alpha.malformed_period',\r\n    },\r\n    {\r\n      msg:\r\n        'Either no parameter was supplied to a contract with a non-unit parameter type, a non-unit parameter was passed to an account, or a parameter was supplied of the wrong type',\r\n      id: 'proto.alpha.michelson_v1.bad_contract_parameter',\r\n    },\r\n    {\r\n      msg: 'Unexpected stack at the end of a lambda or script.',\r\n      id: 'proto.alpha.michelson_v1.bad_return',\r\n    },\r\n    {\r\n      msg: 'The stack has an unexpected length or contents.',\r\n      id: 'proto.alpha.michelson_v1.bad_stack',\r\n    },\r\n    {\r\n      msg:\r\n        'The type of a stack item is unexpected (this error is always accompanied by a more precise one).',\r\n      id: 'proto.alpha.michelson_v1.bad_stack_item',\r\n    },\r\n    {\r\n      msg: 'The error was too big to be serialized with the provided gas',\r\n      id: 'proto.alpha.michelson_v1.cannot_serialize_error',\r\n    },\r\n    {\r\n      msg:\r\n        'Argument of FAILWITH was too big to be serialized with the provided gas',\r\n      id: 'proto.alpha.michelson_v1.cannot_serialize_failure',\r\n    },\r\n    {\r\n      msg:\r\n        'Execution trace with stacks was to big to be serialized with the provided gas',\r\n      id: 'proto.alpha.michelson_v1.cannot_serialize_log',\r\n    },\r\n    {\r\n      msg:\r\n        'The returned storage was too big to be serialized with the provided gas',\r\n      id: 'proto.alpha.michelson_v1.cannot_serialize_storage',\r\n    },\r\n    {\r\n      msg:\r\n        'A non comparable type was used in a place where only comparable types are accepted.',\r\n      id: 'proto.alpha.michelson_v1.comparable_type_expected',\r\n    },\r\n    {\r\n      msg:\r\n        'A deprecated instruction usage is disallowed in newly created contracts',\r\n      id: 'proto.alpha.michelson_v1.deprecated_instruction',\r\n    },\r\n    {\r\n      msg: 'Two entrypoints have the same name.',\r\n      id: 'proto.alpha.michelson_v1.duplicate_entrypoint',\r\n    },\r\n    {\r\n      msg: 'Map literals cannot contain duplicated keys',\r\n      id: 'proto.alpha.michelson_v1.duplicate_map_keys',\r\n    },\r\n    {\r\n      msg: 'When parsing script, a field was found more than once',\r\n      id: 'proto.alpha.michelson_v1.duplicate_script_field',\r\n    },\r\n    {\r\n      msg:\r\n        'Set literals cannot contain duplicate elements, but a duplicae was found while parsing.',\r\n      id: 'proto.alpha.michelson_v1.duplicate_set_values_in_literal',\r\n    },\r\n    {\r\n      msg: 'An entrypoint name exceeds the maximum length of 31 characters.',\r\n      id: 'proto.alpha.michelson_v1.entrypoint_name_too_long',\r\n    },\r\n    {\r\n      msg: 'There is non trivial garbage code after a FAIL instruction.',\r\n      id: 'proto.alpha.michelson_v1.fail_not_in_tail_position',\r\n    },\r\n    {\r\n      msg:\r\n        'The toplevel error thrown when trying to parse a type expression (always followed by more precise errors).',\r\n      id: 'proto.alpha.michelson_v1.ill_formed_type',\r\n    },\r\n    {\r\n      msg:\r\n        'The toplevel error thrown when trying to typecheck a contract code against given input, output and storage types (always followed by more precise errors).',\r\n      id: 'proto.alpha.michelson_v1.ill_typed_contract',\r\n    },\r\n    {\r\n      msg:\r\n        'The toplevel error thrown when trying to typecheck a data expression against a given type (always followed by more precise errors).',\r\n      id: 'proto.alpha.michelson_v1.ill_typed_data',\r\n    },\r\n    {\r\n      msg: 'The annotations on two types could not be merged',\r\n      id: 'proto.alpha.michelson_v1.inconsistent_annotations',\r\n    },\r\n    {\r\n      msg:\r\n        'The specified field does not match the field annotation in the type',\r\n      id: 'proto.alpha.michelson_v1.inconsistent_field_annotations',\r\n    },\r\n    {\r\n      msg:\r\n        'A stack was of an unexpected length (this error is always in the context of a located error).',\r\n      id: 'proto.alpha.michelson_v1.inconsistent_stack_lengths',\r\n    },\r\n    {\r\n      msg: 'The two types contain annotations that do not match',\r\n      id: 'proto.alpha.michelson_v1.inconsistent_type_annotations',\r\n    },\r\n    {\r\n      msg:\r\n        'This is the basic type clash error, that appears in several places where the equality of two types have to be proven, it is always accompanied with another error that provides more context.',\r\n      id: 'proto.alpha.michelson_v1.inconsistent_types',\r\n    },\r\n    {\r\n      msg:\r\n        'In a script or data expression, a primitive was applied to an unsupported number of arguments.',\r\n      id: 'proto.alpha.michelson_v1.invalid_arity',\r\n    },\r\n    {\r\n      msg:\r\n        'A script or data expression references a big_map that does not exist or assumes a wrong type for an existing big_map.',\r\n      id: 'proto.alpha.michelson_v1.invalid_big_map',\r\n    },\r\n    {\r\n      msg: 'A data expression was invalid for its expected type.',\r\n      id: 'proto.alpha.michelson_v1.invalid_constant',\r\n    },\r\n    {\r\n      msg:\r\n        'A script or data expression references a contract that does not exist or assumes a wrong type for an existing contract.',\r\n      id: 'proto.alpha.michelson_v1.invalid_contract',\r\n    },\r\n    {\r\n      msg:\r\n        'In a script or data expression, an expression was of the wrong kind (for instance a string where only a primitive applications can appear).',\r\n      id: 'proto.alpha.michelson_v1.invalid_expression_kind',\r\n    },\r\n    {\r\n      msg:\r\n        'The body of an ITER instruction must result in the same stack type as before the ITER.',\r\n      id: 'proto.alpha.michelson_v1.invalid_iter_body',\r\n    },\r\n    {\r\n      msg:\r\n        'FAIL cannot be the only instruction in the body. The propper type of the return list cannot be inferred.',\r\n      id: 'proto.alpha.michelson_v1.invalid_map_block_fail',\r\n    },\r\n    {\r\n      msg: 'The body of a map block did not match the expected type',\r\n      id: 'proto.alpha.michelson_v1.invalid_map_body',\r\n    },\r\n    {\r\n      msg: 'In a script or data expression, a primitive was unknown.',\r\n      id: 'proto.alpha.michelson_v1.invalid_primitive',\r\n    },\r\n    {\r\n      msg:\r\n        'In a script or data expression, a primitive name is unknown or has a wrong case.',\r\n      id: 'proto.alpha.michelson_v1.invalid_primitive_name',\r\n    },\r\n    {\r\n      msg:\r\n        'In a script or data expression, a primitive name is neither uppercase, lowercase or capitalized.',\r\n      id: 'proto.alpha.michelson_v1.invalid_primitive_name_case',\r\n    },\r\n    {\r\n      msg:\r\n        'In a script or data expression, a primitive was of the wrong namespace.',\r\n      id: 'proto.alpha.michelson_v1.invalid_primitive_namespace',\r\n    },\r\n    {\r\n      msg: 'When parsing script, a field was expected, but not provided',\r\n      id: 'proto.alpha.michelson_v1.missing_script_field',\r\n    },\r\n    {\r\n      msg: 'An entrypoint was not found when calling a contract.',\r\n      id: 'proto.alpha.michelson_v1.no_such_entrypoint',\r\n    },\r\n    {\r\n      msg: 'Toplevel error for all runtime script errors',\r\n      id: 'proto.alpha.michelson_v1.runtime_error',\r\n    },\r\n    {\r\n      msg: 'A FAIL instruction was reached due to the detection of an overflow',\r\n      id: 'proto.alpha.michelson_v1.script_overflow',\r\n    },\r\n    {\r\n      msg: 'A FAILWITH instruction was reached',\r\n      id: 'proto.alpha.michelson_v1.script_rejected',\r\n    },\r\n    {\r\n      msg: 'A SELF instruction was encountered in a lambda expression.',\r\n      id: 'proto.alpha.michelson_v1.self_in_lambda',\r\n    },\r\n    {\r\n      msg: 'An instruction generated a type larger than the limit.',\r\n      id: 'proto.alpha.michelson_v1.type_too_large',\r\n    },\r\n    {\r\n      msg:\r\n        'A binary operation is called on operands of types over which it is not defined.',\r\n      id: 'proto.alpha.michelson_v1.undefined_binop',\r\n    },\r\n    {\r\n      msg:\r\n        'A unary operation is called on an operand of type over which it is not defined.',\r\n      id: 'proto.alpha.michelson_v1.undefined_unop',\r\n    },\r\n    {\r\n      msg: 'A node in the syntax tree was impropperly annotated',\r\n      id: 'proto.alpha.michelson_v1.unexpected_annotation',\r\n    },\r\n    {\r\n      msg:\r\n        'When parsing script, a big_map type was found in a position where it could end up stored inside a big_map, which is forbidden for now.',\r\n      id: 'proto.alpha.michelson_v1.unexpected_bigmap',\r\n    },\r\n    {\r\n      msg:\r\n        'When parsing script, a contract type was found in the storage or parameter field.',\r\n      id: 'proto.alpha.michelson_v1.unexpected_contract',\r\n    },\r\n    {\r\n      msg:\r\n        'When parsing script, an operation type was found in the storage or parameter field.',\r\n      id: 'proto.alpha.michelson_v1.unexpected_operation',\r\n    },\r\n    {\r\n      msg: 'Annotations of the same kind must be grouped',\r\n      id: 'proto.alpha.michelson_v1.ungrouped_annotations',\r\n    },\r\n    {\r\n      msg: 'In a script or data expression, a primitive was unknown.',\r\n      id: 'proto.alpha.michelson_v1.unknown_primitive_name',\r\n    },\r\n    {\r\n      msg:\r\n        'At the join point at the end of two code branches the stacks have inconsistent lengths or contents.',\r\n      id: 'proto.alpha.michelson_v1.unmatched_branches',\r\n    },\r\n    {\r\n      msg: 'Map keys must be in strictly increasing order',\r\n      id: 'proto.alpha.michelson_v1.unordered_map_literal',\r\n    },\r\n    {\r\n      msg: 'Set values must be in strictly increasing order',\r\n      id: 'proto.alpha.michelson_v1.unordered_set_literal',\r\n    },\r\n    {\r\n      msg: 'An entrypoint in the contract is not reachable.',\r\n      id: 'proto.alpha.michelson_v1.unreachable_entrypoint',\r\n    },\r\n    {\r\n      msg: 'Duplicated revelation for a nonce.',\r\n      id: 'proto.alpha.nonce.previously_revealed',\r\n    },\r\n    {\r\n      msg: 'Nonce revelation happens before cycle end',\r\n      id: 'proto.alpha.nonce.too_early_revelation',\r\n    },\r\n    {\r\n      msg: 'Nonce revelation happens too late',\r\n      id: 'proto.alpha.nonce.too_late_revelation',\r\n    },\r\n    {\r\n      msg: 'The provided nonce is inconsistent with the committed nonce hash.',\r\n      id: 'proto.alpha.nonce.unexpected',\r\n    },\r\n    {\r\n      msg: 'The operation is ill-formed or for another protocol version',\r\n      id: 'proto.alpha.operation.cannot_parse',\r\n    },\r\n    {\r\n      msg: 'Two endorsements received from same delegate',\r\n      id: 'proto.alpha.operation.duplicate_endorsement',\r\n    },\r\n    {\r\n      msg:\r\n        'The given key and secret do not correspond to any existing preallocated contract',\r\n      id: 'proto.alpha.operation.invalid_activation',\r\n    },\r\n    {\r\n      msg:\r\n        'The level of an endorsement is inconsistent with the provided block hash.',\r\n      id: 'proto.alpha.operation.invalid_endorsement_level',\r\n    },\r\n    {\r\n      msg:\r\n        'The operation signature is ill-formed or has been made with the wrong public key',\r\n      id: 'proto.alpha.operation.invalid_signature',\r\n    },\r\n    {\r\n      msg:\r\n        'The operation is of a kind that must be signed, but the signature is missing',\r\n      id: 'proto.alpha.operation.missing_signature',\r\n    },\r\n    {\r\n      msg:\r\n        'The block being validated does not include the required minimum number of endorsements for this priority.',\r\n      id: 'proto.alpha.operation.not_enought_endorsements_for_priority',\r\n    },\r\n    {\r\n      msg:\r\n        'Trying to include an endorsement in a block that is not the successor of the endorsed one',\r\n      id: 'proto.alpha.operation.wrong_endorsement_predecessor',\r\n    },\r\n    {\r\n      msg:\r\n        'Trying to onclude a proposal or ballot meant for another voting period',\r\n      id: 'proto.alpha.operation.wrong_voting_period',\r\n    },\r\n    {\r\n      msg: 'The requested seed is not available',\r\n      id: 'proto.alpha.seed.unknown_seed',\r\n    },\r\n    {\r\n      msg:\r\n        'A script or one of its callee wrote more bytes than the operation said it would',\r\n      id: 'proto.alpha.storage_exhausted.operation',\r\n    },\r\n    {\r\n      msg: 'A transaction tried to exceed the hard limit on storage',\r\n      id: 'proto.alpha.storage_limit_too_high',\r\n    },\r\n    {\r\n      msg: 'An addition of two tez amounts overflowed',\r\n      id: 'proto.alpha.tez.addition_overflow',\r\n    },\r\n    {\r\n      msg: 'Multiplication of a tez amount by a non positive integer',\r\n      id: 'proto.alpha.tez.invalid_divisor',\r\n    },\r\n    {\r\n      msg: 'A multiplication of a tez amount by an integer overflowed',\r\n      id: 'proto.alpha.tez.multiplication_overflow',\r\n    },\r\n    {\r\n      msg: 'Multiplication of a tez amount by a negative integer',\r\n      id: 'proto.alpha.tez.negative_multiplicator',\r\n    },\r\n    {\r\n      msg: 'An subtraction of two tez amounts underflowed',\r\n      id: 'proto.alpha.tez.subtraction_underflow',\r\n    },\r\n    {\r\n      msg: 'Overflow when adding timestamps.',\r\n      id: 'proto.alpha.timestamp_add',\r\n    },\r\n    {\r\n      msg: 'Substracting timestamps resulted in negative period.',\r\n      id: 'proto.alpha.timestamp_sub',\r\n    },\r\n    {\r\n      msg:\r\n        'A transaction exceeded the hard limit of internal operations it can emit',\r\n      id: 'proto.alpha.too_many_internal_operations',\r\n    },\r\n    {\r\n      msg: 'The delegate reached the maximum number of allowed proposals.',\r\n      id: 'proto.alpha.too_many_proposals',\r\n    },\r\n    {\r\n      msg:\r\n        'The delegate provided for the ballot is not in the voting listings.',\r\n      id: 'proto.alpha.unauthorized_ballot',\r\n    },\r\n    {\r\n      msg:\r\n        'The delegate provided for the proposal is not in the voting listings.',\r\n      id: 'proto.alpha.unauthorized_proposal',\r\n    },\r\n    {\r\n      msg:\r\n        'An origination was attemped out of the scope of a manager operation',\r\n      id: 'proto.alpha.undefined_operation_nonce',\r\n    },\r\n    {\r\n      msg: 'Ballot recorded outside of a voting period.',\r\n      id: 'proto.alpha.unexpected_ballot',\r\n    },\r\n    {\r\n      msg: 'Level must be non-negative.',\r\n      id: 'proto.alpha.unexpected_level',\r\n    },\r\n    {\r\n      msg: 'Nonce length is incorrect.',\r\n      id: 'proto.alpha.unexpected_nonce_length',\r\n    },\r\n    {\r\n      msg: 'Proposal recorded outside of a proposal period.',\r\n      id: 'proto.alpha.unexpected_proposal',\r\n    },\r\n    {\r\n      msg: 'Block locator is invalid.',\r\n      id: 'node.bootstrap_pipeline.invalid_locator',\r\n    },\r\n    {\r\n      msg: 'Block locator is too short.',\r\n      id: 'node.bootstrap_pipeline.too_short_locator',\r\n    },\r\n    {\r\n      msg: 'IO error: connection with a peer is closed.',\r\n      id: 'node.p2p_io_scheduler.connection_closed',\r\n    },\r\n    {\r\n      msg: 'Fail to connect with a peer: a connection is already established.',\r\n      id: 'node.p2p_pool.connected',\r\n    },\r\n    {\r\n      msg: 'Connection was refused.',\r\n      id: 'node.p2p_pool.connection_refused',\r\n    },\r\n    {\r\n      msg: 'The peer identity you tried to connect is banned.',\r\n      id: 'node.p2p_pool.peer_banned',\r\n    },\r\n    {\r\n      msg: 'Fail to connect with a peer: a connection is already pending.',\r\n      id: 'node.p2p_pool.pending_connection',\r\n    },\r\n    {\r\n      msg: 'The address you tried to connect is banned.',\r\n      id: 'node.p2p_pool.point_banned',\r\n    },\r\n    {\r\n      msg: 'Node is in private mode.',\r\n      id: 'node.p2p_pool.private_mode',\r\n    },\r\n    {\r\n      msg: 'Connection to peer was rejected by us.',\r\n      id: 'node.p2p_pool.rejected',\r\n    },\r\n    {\r\n      msg: 'Too many connections.',\r\n      id: 'node.p2p_pool.too_many_connections',\r\n    },\r\n    {\r\n      msg: 'An error occurred while deciphering.',\r\n      id: 'node.p2p_socket.decipher_error',\r\n    },\r\n    {\r\n      msg: 'An error occurred while decoding.',\r\n      id: 'node.p2p_socket.decoding_error',\r\n    },\r\n    {\r\n      msg: 'An error occurred while encoding.',\r\n      id: 'node.p2p_socket.encoding_error',\r\n    },\r\n    {\r\n      msg: 'Rejected peer connection: invalid authentication.',\r\n      id: 'node.p2p_socket.invalid_auth',\r\n    },\r\n    {\r\n      msg: 'Size of chunks is not valid.',\r\n      id: 'node.p2p_socket.invalid_chunks_size',\r\n    },\r\n    {\r\n      msg: 'The size of the message to be written is invalid.',\r\n      id: 'node.p2p_socket.invalid_message_size',\r\n    },\r\n    {\r\n      msg: 'Remote peer is actually yourself.',\r\n      id: 'node.p2p_socket.myself',\r\n    },\r\n    {\r\n      msg: 'Remote peer cannot be authenticated: not enough proof of work.',\r\n      id: 'node.p2p_socket.not_enough_proof_of_work',\r\n    },\r\n    {\r\n      msg:\r\n        'Rejected peer connection: The peer rejected the socket connection by Nack with a list of alternative peers.',\r\n      id: 'node.p2p_socket.rejected_by_nack',\r\n    },\r\n    {\r\n      msg:\r\n        'Rejected peer connection: rejected socket connection as we have no common network protocol with the peer.',\r\n      id: 'node.p2p_socket.rejected_no_common_protocol',\r\n    },\r\n    {\r\n      msg: 'Rejected peer connection: rejected socket connection.',\r\n      id: 'node.p2p_socket.rejected_socket_connection',\r\n    },\r\n    {\r\n      msg: 'Rejecting peer connection with motive.',\r\n      id: 'node.p2p_socket.rejecting_incoming',\r\n    },\r\n    {\r\n      msg: 'Known invalid block found in the peer\\'s chain',\r\n      id: 'node.peer_validator.known_invalid',\r\n    },\r\n    {\r\n      msg: 'Unknown ancestor block found in the peer\\'s chain',\r\n      id: 'node.peer_validator.unknown_ancestor',\r\n    },\r\n    {\r\n      msg: 'The block was annotated with a time too far in the future.',\r\n      id: 'node.prevalidation.future_block_header',\r\n    },\r\n    {\r\n      msg: 'The operation size is bigger than allowed.',\r\n      id: 'node.prevalidation.oversized_operation',\r\n    },\r\n    {\r\n      msg:\r\n        'Raised when an operation has not been parsed correctly during prevalidation.',\r\n      id: 'node.prevalidation.parse_error',\r\n    },\r\n    {\r\n      msg: 'The prevalidation context is full.',\r\n      id: 'node.prevalidation.too_many_operations',\r\n    },\r\n    {\r\n      msg: 'Invalid protocol.',\r\n      id: 'node.protocol_validator.invalid_protocol',\r\n    },\r\n    {\r\n      msg:\r\n        'The data directory could not be read. This could be because it was generated with an old version of the tezos-node program. Deleting and regenerating this directory may fix the problem.',\r\n      id: 'node.state.bad_data_dir',\r\n    },\r\n    {\r\n      msg:\r\n        'When commiting the context of a block, the announced context hash was not the one computed at commit time.',\r\n      id: 'node.state.block.inconsistent_context_hash',\r\n    },\r\n    {\r\n      msg: 'The invalid block to be unmarked was not actually invalid.',\r\n      id: 'node.state.block_not_invalid',\r\n    },\r\n    {\r\n      msg:\r\n        'The chain identifier could not be found in the chain identifiers table.',\r\n      id: 'node.state.unknown_chain',\r\n    },\r\n    {\r\n      msg:\r\n        'The block belongs to a branch that is not compatible with the current checkpoint.',\r\n      id: 'node.validator.checkpoint_error',\r\n    },\r\n    {\r\n      msg: 'Attempted validation of a block from an inactive chain.',\r\n      id: 'node.validator.inactive_chain',\r\n    },\r\n    {\r\n      msg: 'Incorrect history mode switch.',\r\n      id: 'node_config_file.incorrect_history_mode_switch',\r\n    },\r\n    {\r\n      msg: 'Missing key in store',\r\n      id: 'raw_store.unknown',\r\n    },\r\n    {\r\n      msg:\r\n        'The provided list of operations is inconsistent with the block header.',\r\n      id: 'validator.inconsistent_operations_hash',\r\n    },\r\n    {\r\n      msg: 'Invalid block.',\r\n      id: 'validator.invalid_block',\r\n    },\r\n    {\r\n      msg: 'Missing test protocol when forking the test chain',\r\n      id: 'validator.missing_test_protocol',\r\n    },\r\n    {\r\n      msg: 'The protocol required for validating a block is missing.',\r\n      id: 'validator.unavailable_protocol',\r\n    },\r\n    {\r\n      msg: 'Failed to validate block using exteranl validation process.',\r\n      id: 'validator.validation_process_failed',\r\n    },\r\n    {\r\n      msg:\r\n        'An operation on a worker could not complete before it was shut down.',\r\n      id: 'worker.closed',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an annotation exceeded the maximum length (255).',\r\n      id: 'micheline.parse_error.annotation_exceeds_max_length',\r\n    },\r\n    {\r\n      msg:\r\n        'Tried to interpret an empty piece or Micheline source as a single expression.',\r\n      id: 'micheline.parse_error.empty_expression',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an extra semi colon or parenthesis was encountered.',\r\n      id: 'micheline.parse_error.extra_token',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, a sequence of bytes that is not valid UTF-8 was encountered.',\r\n      id: 'micheline.parse_error.invalid_utf8_sequence',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an expression was not aligned with its siblings of the same mother application or sequence.',\r\n      id: 'micheline.parse_error.misaligned_node',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, a number was not visually separated from its follower token, leading to misreadability.',\r\n      id: 'micheline.parse_error.missing_break_after_number',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, the length of a byte sequence (0x...) was not a multiple of two, leaving a trailing half byte.',\r\n      id: 'micheline.parse_error.odd_lengthed_bytes',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, a parenthesis or a brace was unclosed.',\r\n      id: 'micheline.parse_error.unclosed_token',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an unexpected escape sequence was encountered in a string.',\r\n      id: 'micheline.parse_error.undefined_escape_sequence',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an unexpected character was encountered.',\r\n      id: 'micheline.parse_error.unexpected_character',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an unexpected token was encountered.',\r\n      id: 'micheline.parse_error.unexpected_token',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, a commentX was not terminated.',\r\n      id: 'micheline.parse_error.unterminated_comment',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, an integer was not terminated.',\r\n      id: 'micheline.parse_error.unterminated_integer',\r\n    },\r\n    {\r\n      msg:\r\n        'While parsing a piece of Micheline source, a string was not terminated.',\r\n      id: 'micheline.parse_error.unterminated_string',\r\n    },\r\n    {\r\n      msg: 'Wrong hash given',\r\n      id: 'Bad_hash',\r\n    },\r\n    {\r\n      msg: 'The context checkout failed using a given hash',\r\n      id: 'Block_validator_process.failed_to_checkout_context',\r\n    },\r\n    {\r\n      msg: 'Cannot reconstruct',\r\n      id: 'CannotReconstruct',\r\n    },\r\n    {\r\n      msg: 'Cannot find context corresponding to hash',\r\n      id: 'Context_not_found',\r\n    },\r\n    {\r\n      msg: 'The imported block is not the expected one.',\r\n      id: 'InconsistentImportedBlock',\r\n    },\r\n    {\r\n      msg: 'The operations given do not match their hashes.',\r\n      id: 'InconsistentOperationHashes',\r\n    },\r\n    {\r\n      msg: 'The data provided by the snapshot is inconsistent',\r\n      id: 'Inconsistent_snapshot_data',\r\n    },\r\n    {\r\n      msg: 'Error while opening snapshot file',\r\n      id: 'Inconsistent_snapshot_file',\r\n    },\r\n    {\r\n      msg: 'Invalid specification of block to import',\r\n      id: 'InvalidBlockSpecification',\r\n    },\r\n    {\r\n      msg: 'The version of the snapshot to import is not valid',\r\n      id: 'Invalid_snapshot_version',\r\n    },\r\n    {\r\n      msg: 'Mandatory data missing while reaching end of snapshot file.',\r\n      id: 'Missing_snapshot_data',\r\n    },\r\n    {\r\n      msg:\r\n        'RPC lookup failed. Block has been pruned and requested data deleted.',\r\n      id: 'RPC_context.Gone',\r\n    },\r\n    {\r\n      msg:\r\n        'RPC lookup failed. No RPC exists at the URL or the RPC tried to access non-existent data.',\r\n      id: 'RPC_context.Not_found',\r\n    },\r\n    {\r\n      msg: 'Internal error while restoring the context',\r\n      id: 'Restore_context_failure',\r\n    },\r\n    {\r\n      msg: 'The imported snapshot is malformed.',\r\n      id: 'SnapshotImportFailure',\r\n    },\r\n    {\r\n      msg: 'Failed to read file',\r\n      id: 'System_read_error',\r\n    },\r\n    {\r\n      msg: 'The validator failed because of a system error',\r\n      id: 'Validator_process.system_error_while_validating',\r\n    },\r\n    {\r\n      msg: 'Cannot write in file for context dump',\r\n      id: 'Writing_error',\r\n    },\r\n    {\r\n      msg: 'The block to export in the snapshot is not valid.',\r\n      id: 'WrongBlockExport',\r\n    },\r\n    {\r\n      msg: 'Wrong protocol hash',\r\n      id: 'WrongProtocolHash',\r\n    },\r\n    {\r\n      msg: 'Snapshot exports is not compatible with the current configuration.',\r\n      id: 'WrongSnapshotExport',\r\n    },\r\n    {\r\n      msg: 'A fatal assertion failed',\r\n      id: 'assertion',\r\n    },\r\n    {\r\n      msg: 'A promise was unexpectedly canceled',\r\n      id: 'canceled',\r\n    },\r\n    {\r\n      msg: 'A key has been provided with an invalid uri.',\r\n      id: 'cli.key.invalid_uri',\r\n    },\r\n    {\r\n      msg: 'The signer produced an invalid signature',\r\n      id: 'cli.signature_mismatch',\r\n    },\r\n    {\r\n      msg:\r\n        'A key has been provided with an unregistered scheme (no corresponding plugin)',\r\n      id: 'cli.unregistered_key_scheme',\r\n    },\r\n    {\r\n      msg:\r\n        'The byte sequence references a multisig counter that does not match the one currently stored in the given multisig contract',\r\n      id: 'client.alpha.Bad deserialized counter',\r\n    },\r\n    {\r\n      msg:\r\n        'When trying to deserialise an action from a sequence of bytes, we got an expression that does not correspond to a known multisig action',\r\n      id: 'client.alpha.actionDeserialisation',\r\n    },\r\n    {\r\n      msg:\r\n        'When trying to deserialise an action from a sequence of bytes, we got an action for another multisig contract',\r\n      id: 'client.alpha.badDeserializedContract',\r\n    },\r\n    {\r\n      msg: 'invalid duration in -endorsement-delay',\r\n      id: 'client.alpha.badEndorsementDelayArg',\r\n    },\r\n    {\r\n      msg: 'invalid priority in -max-priority',\r\n      id: 'client.alpha.badMaxPriorityArg',\r\n    },\r\n    {\r\n      msg: 'invalid duration in -max-waiting-time',\r\n      id: 'client.alpha.badMaxWaitingTimeArg',\r\n    },\r\n    {\r\n      msg: 'invalid fee threshold in -fee-threshold',\r\n      id: 'client.alpha.badMinimalFeesArg',\r\n    },\r\n    {\r\n      msg: 'invalid number of levels in -preserved-levels',\r\n      id: 'client.alpha.badPreservedLevelsArg',\r\n    },\r\n    {\r\n      msg: 'Invalid ꜩ notation in parameter.',\r\n      id: 'client.alpha.badTezArg',\r\n    },\r\n    {\r\n      msg:\r\n        'When trying to deserialise an action from a sequence of bytes, we got an error',\r\n      id: 'client.alpha.bytesDeserialisation',\r\n    },\r\n    {\r\n      msg:\r\n        'A multisig command has referenced a scriptless smart contract instead of a multisig smart contract.',\r\n      id: 'client.alpha.contractHasNoScript',\r\n    },\r\n    {\r\n      msg:\r\n        'A multisig command has referenced a smart contract without storage instead of a multisig smart contract.',\r\n      id: 'client.alpha.contractHasNoStorage',\r\n    },\r\n    {\r\n      msg:\r\n        'A multisig command has referenced a smart contract whose storage is of a different shape than the expected one.',\r\n      id: 'client.alpha.contractHasUnexpectedStorage',\r\n    },\r\n    {\r\n      msg:\r\n        'Attempt to get the code of a contract failed because it has nocode. No scriptless contract should remain.',\r\n      id: 'client.alpha.contractWithoutCode',\r\n    },\r\n    {\r\n      msg:\r\n        'A signature was given for a multisig contract that matched none of the public keys of the contract signers',\r\n      id: 'client.alpha.invalidSignature',\r\n    },\r\n    {\r\n      msg: 'A wrong number of arguments was provided to a macro',\r\n      id: 'client.alpha.michelson.macros.bas_arity',\r\n    },\r\n    {\r\n      msg: 'An macro expects a sequence, but a sequence was not provided',\r\n      id: 'client.alpha.michelson.macros.sequence_expected',\r\n    },\r\n    {\r\n      msg:\r\n        'A macro had an annotation, but no annotation was permitted on this macro.',\r\n      id: 'client.alpha.michelson.macros.unexpected_annotation',\r\n    },\r\n    {\r\n      msg: 'A multisig threshold should be a positive number',\r\n      id: 'client.alpha.nonPositiveThreshold',\r\n    },\r\n    {\r\n      msg:\r\n        'A multisig command has referenced a smart contract whose script is not one of the known multisig contract scripts.',\r\n      id: 'client.alpha.notASupportedMultisigContract',\r\n    },\r\n    {\r\n      msg:\r\n        'To run an action on a multisig contract, you should provide at least as many signatures as indicated by the threshold stored in the multisig contract.',\r\n      id: 'client.alpha.notEnoughSignatures',\r\n    },\r\n    {\r\n      msg:\r\n        'The given threshold is higher than the number of keys, this would lead to a frozen multisig contract',\r\n      id: 'client.alpha.thresholdTooHigh',\r\n    },\r\n    {\r\n      msg: 'Cannot recover from a corrupted context.',\r\n      id: 'context.non_recoverable_context',\r\n    },\r\n    {\r\n      msg: '<gf>context_dump.read.cannot_open',\r\n    },\r\n    {\r\n      msg: '<gf>context_dump.read.suspicious',\r\n    },\r\n    {\r\n      msg: '<gf>context_dump.write.cannot_open',\r\n    },\r\n    {\r\n      msg: 'Exception safely wrapped in an error',\r\n      id: 'failure',\r\n    },\r\n    {\r\n      msg: 'Activation of an Internal Event SINK with an URI failed',\r\n      id: 'internal-event-activation-error',\r\n    },\r\n    {\r\n      msg: 'The raw context extraction depth argument must be positive.',\r\n      id: 'raw_context.invalid_depth',\r\n    },\r\n    {\r\n      msg: 'No protocol was registered with the requested hash.',\r\n      id: 'registered_protocol.unregistered_protocol',\r\n    },\r\n    {\r\n      msg: 'The fetch of a Operation_hash has been canceled',\r\n      id: 'requester.Operation_hash.fetch_canceled',\r\n    },\r\n    {\r\n      msg: 'The fetch of a Operation_hash has timed out',\r\n      id: 'requester.Operation_hash.fetch_timeout',\r\n    },\r\n    {\r\n      msg: 'Some Operation_hash is missing from the requester',\r\n      id: 'requester.Operation_hash.missing',\r\n    },\r\n    {\r\n      msg: 'The fetch of a Protocol_hash has been canceled',\r\n      id: 'requester.Protocol_hash.fetch_canceled',\r\n    },\r\n    {\r\n      msg: 'The fetch of a Protocol_hash has timed out',\r\n      id: 'requester.Protocol_hash.fetch_timeout',\r\n    },\r\n    {\r\n      msg: 'Some Protocol_hash is missing from the requester',\r\n      id: 'requester.Protocol_hash.missing',\r\n    },\r\n    {\r\n      msg: 'The fetch of a block_hash has been canceled',\r\n      id: 'requester.block_hash.fetch_canceled',\r\n    },\r\n    {\r\n      msg: 'The fetch of a block_hash has timed out',\r\n      id: 'requester.block_hash.fetch_timeout',\r\n    },\r\n    {\r\n      msg: 'Some block_hash is missing from the requester',\r\n      id: 'requester.block_hash.missing',\r\n    },\r\n    {\r\n      msg: 'The fetch of a operation_hashes has been canceled',\r\n      id: 'requester.operation_hashes.fetch_canceled',\r\n    },\r\n    {\r\n      msg: 'The fetch of a operation_hashes has timed out',\r\n      id: 'requester.operation_hashes.fetch_timeout',\r\n    },\r\n    {\r\n      msg: 'Some operation_hashes is missing from the requester',\r\n      id: 'requester.operation_hashes.missing',\r\n    },\r\n    {\r\n      msg: 'The fetch of a operations has been canceled',\r\n      id: 'requester.operations.fetch_canceled',\r\n    },\r\n    {\r\n      msg: 'The fetch of a operations has timed out',\r\n      id: 'requester.operations.fetch_timeout',\r\n    },\r\n    {\r\n      msg: 'Some operations is missing from the requester',\r\n      id: 'requester.operations.missing',\r\n    },\r\n    {\r\n      msg: 'Error while decoding a remote signer message',\r\n      id: 'signer.decoding_error',\r\n    },\r\n    {\r\n      msg: 'Error while encoding a remote signer message',\r\n      id: 'signer.encoding_error',\r\n    },\r\n    {\r\n      msg: 'Block not found',\r\n      id: 'state.block.contents_not_found',\r\n    },\r\n    {\r\n      msg: 'Block not found',\r\n      id: 'state.block.not_found',\r\n    },\r\n    {\r\n      msg: 'Unix System_info failure',\r\n      id: 'unix.system_info',\r\n    },\r\n    {\r\n      msg: 'An unhandled unix exception',\r\n      id: 'unix_error',\r\n    },\r\n    {\r\n      msg: 'Canceled',\r\n      id: 'utils.Canceled',\r\n    },\r\n    {\r\n      msg: 'Timeout',\r\n      id: 'utils.Timeout',\r\n    },\r\n    {\r\n      msg: 'Fee exceeded hard cap!',\r\n      id: 'TooHighFee'\r\n    },\r\n    {\r\n      msg: 'Node error: Timeout has occurred! Please try again later.',\r\n      id: 'Timeout has occurred'\r\n    }\r\n  ];\r\n  transform(errorId: string, withObj?: any): any {\r\n    const protocol = errorId.match(/[0-9]{3}-P\\w{7}/g);\r\n    if (protocol && protocol[0]) {\r\n      errorId = errorId.replace(protocol[0], 'alpha');\r\n    }\r\n    let errorMessage = '';\r\n    const index = this.ERROR_LIST.findIndex((s) => s.id === errorId);\r\n    console.log('errorId', errorId);\r\n    if (errorId === 'proto.alpha.michelson_v1.script_rejected' && withObj && (withObj.string !== undefined || withObj.args)) {\r\n      if (withObj.string) {\r\n        errorMessage = this.ERROR_LIST[index].msg + ' > ' + withObj.string;\r\n      } else {\r\n        errorMessage = this.ERROR_LIST[index].msg + ' ' + JSON.stringify(withObj);\r\n      }\r\n      console.log(withObj);\r\n    } else if (index !== -1) {\r\n      errorMessage = this.ERROR_LIST[index].msg;\r\n    } else {\r\n      if (\r\n        errorId.indexOf('branch refused (Error:') !== -1 &&\r\n        errorId.indexOf('already used for contract') !== -1\r\n      ) {\r\n        errorMessage =\r\n          'Counter error: Another operation in mempool is blocking your operation. Wait for it to be included in a block or pruned from mempool (up to 60 minutes).';\r\n      } else {\r\n        errorMessage = 'Unrecognized error: ' + errorId;\r\n      }\r\n    }\r\n    return errorMessage;\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  templateUrl: '404.component.html',\r\n  styleUrls: ['./error.scss']\r\n})\r\nexport class P404Component {\r\n\r\n  constructor() { }\r\n\r\n}\r\n","<div id=\"error\" class=\"app flex-row align-items-center\">\r\n  <div class=\"container\">\r\n    <div class=\"row justify-content-center\">\r\n      <div class=\"col-md-6\">\r\n        <div class=\"logo-container\">\r\n          <a class=\"logo\" routerLink=\"/\">\r\n            <img src=\"../../../assets/img/kukai-logo.svg\">\r\n          </a>\r\n        </div>\r\n        <div class=\"clearfix mt-5\">\r\n          <h1 class=\"float-left display-3 mr-4\">404</h1>\r\n          <h4 class=\"pt-3\">Oops! You're lost.</h4>\r\n          <p>The page you are looking for was not found.</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","<div>\r\n  <div class=\"top\">\r\n    <a routerLink=\"/\" class=\"logo\"><img id=\"logo\" src=\"../../../assets/img/kukai-logo.svg\"></a>\r\n  </div>\r\n  <div class=\"main\">\r\n    <div class=\"main-top\">\r\n      <h1>DirectAuth</h1>\r\n      <p>Your Tezos wallet in one-click. <a class=\"learn-more\" target=\"_blank\" href=\"https://docs.kukai.app/learn-kukai/direct-auth\">Learn more</a></p>\r\n    </div>\r\n    <div class=\"main-mid\">\r\n      <p class=\"signup\">Sign up / in with</p>\r\n      <div class=\"login-options\">\r\n        <div *ngFor=\"let key of torusService.verifierMapKeys\" (click)=\"torusLogin(key)\" class=\"login-option\" (mouseover)=\"activeLogin = key\">\r\n          <ng-container *ngIf=\"key === activeLogin || mobile(); then color else grey\"></ng-container>\r\n          <ng-template #color><img class=\"login-logo color\" src=\"../../../assets/img/torus-login/{{ key }}-color.svg\"></ng-template>\r\n          <ng-template #grey><img class=\"login-logo grey\" src=\"../../../assets/img/torus-login/{{ key }}-grey.svg\"></ng-template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"main-bottom\">\r\n      <p>The following sign-ins involve a third party authenticator: Twitter</p>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\"torus-bg\"><img src=\"../../../assets/img/torus-bg.svg\"></div>","import { Component, OnInit } from '@angular/core';\r\n\r\nimport { TorusService } from '../../services/torus/torus.service';\r\nimport { ImportService } from '../../services/import/import.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { Router } from '@angular/router';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\n\r\n@Component({\r\n  selector: 'app-torus',\r\n  templateUrl: './torus.component.html',\r\n  styleUrls: ['./torus.component.scss']\r\n})\r\nexport class TorusComponent implements OnInit {\r\n  activeLogin = 'google';\r\n  constructor(\r\n    private walletService: WalletService,\r\n    public torusService: TorusService,\r\n    private importService: ImportService,\r\n    private messageService: MessageService,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    if (this.walletService.wallet) {\r\n      this.router.navigate(['/accounts']);\r\n    } else {\r\n    this.torusService.initTorus();\r\n    }\r\n  }\r\n  async torusLogin(verifier: string) {\r\n    await this.messageService.startSpinner('Loading wallet...');\r\n    const { keyPair, userInfo } = await this.torusService.loginTorus(verifier).catch(async (e) =>\r\n      await this.messageService.stopSpinner()\r\n    );\r\n    console.log('login done');\r\n    if (keyPair) {\r\n      await this.importService\r\n        .importWalletFromPk(keyPair.pk, '', { verifier: userInfo.typeOfLogin, id: userInfo.verifierId, name: userInfo.name })\r\n        .then((success: boolean) => {\r\n          if (success) {\r\n            console.log('success');\r\n            if (this.walletService.wallet.implicitAccounts.length === 1 && this.walletService.wallet.implicitAccounts[0].originatedAccounts.length === 0) {\r\n              console.log('single address');\r\n              this.router.navigate([`/account/${this.walletService.wallet.implicitAccounts[0].address}`]);\r\n            } else {\r\n              this.router.navigate(['/accounts']);\r\n            }\r\n            this.messageService.stopSpinner();\r\n          } else {\r\n            this.messageService.addError('Torus import failed');\r\n            this.messageService.stopSpinner();\r\n          }\r\n        });\r\n    } else {\r\n      await this.messageService.stopSpinner();\r\n    }\r\n  }\r\n  mobile(): boolean {\r\n    return (window.innerWidth < 480);\r\n  }\r\n}\r\n","/* (ignored) */","<div class=\"kukai-card\">\r\n    <H1>Connect with your Ledger Nano S</H1>\r\n    <div class=\"grey-card\">\r\n      <p class=\"description bold\">Keep the private keys safely on your Ledger device and use Kukai to access the Tezos\r\n          blockchain.</p>\r\n      <p class=\"description\">You need to open the Tezos Wallet app on your Ledger device and set the derivation path.</p>\r\n      <input type=\"text\" class=\"text\" [disabled]=\"!isHDDerivationPathCustom\" [(ngModel)]=\"path\"\r\n          value=\"'44\\'/1729\\'/0\\'/0\\''\">\r\n      <small>Use custom HD derivation path</small>\r\n      <div class=\"switch-container\">\r\n          <label class=\"switch\">\r\n              <input type=\"checkbox\" [(ngModel)]=\"isHDDerivationPathCustom\" (click)=\"setDefaultPath()\">\r\n              <span class=\"slider round\"></span>\r\n          </label><span class=\"switch-desc\">\r\n              <ng-container *ngIf=\"!isHDDerivationPathCustom\">Off</ng-container>\r\n              <ng-container *ngIf=\"isHDDerivationPathCustom\">On</ng-container>\r\n          </span>\r\n      </div>\r\n      <div class=\"buttons\">\r\n          <a routerLink=\"/\"><button class=\"button back\">Back</button></a>\r\n          <button class=\"button next\" (click)=\"getPk()\">Connect</button>\r\n      </div>\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { LedgerService } from '../../services/ledger/ledger.service';\r\nimport { ImportService } from '../../services/import/import.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { utils } from '@tezos-core-tools/crypto-utils';\r\n\r\n@Component({\r\n  selector: 'app-connect-ledger',\r\n  templateUrl: './connect-ledger.component.html',\r\n  styleUrls: ['./connect-ledger.component.scss']\r\n})\r\nexport class ConnectLedgerComponent implements OnInit {\r\n  activePanel = 0;\r\n  defaultPath = '44\\'/1729\\'/0\\'/0\\'';\r\n  defaultText = 'Default derivation path';\r\n  path: string;\r\n  pendingLedgerConfirmation = false;\r\n  isHDDerivationPathCustom = false;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private ledgerService: LedgerService,\r\n    private importService: ImportService,\r\n    private messageService: MessageService,\r\n    private inputValidationService: InputValidationService,\r\n    private walletService: WalletService\r\n    ) { }\r\n\r\n  ngOnInit() {\r\n    this.path = this.defaultText;\r\n  }\r\n  async getPk() {\r\n    const path: string = this.path.replace(this.defaultText, this.defaultPath);\r\n    if (this.inputValidationService.derivationPath(path)) {\r\n      this.pendingLedgerConfirmation = true;\r\n      try {\r\n        this.messageService.startSpinner('Waiting for Ledger confirmation...');\r\n        const pk = await this.ledgerService.getPublicAddress(path);\r\n        console.log('getPK => ' + pk);\r\n        await this.importFromPk(pk, path);\r\n      } catch (e) {\r\n        throw(e);\r\n      } finally {\r\n        this.pendingLedgerConfirmation = false;\r\n        this.messageService.stopSpinner();\r\n      }\r\n    } else {\r\n      this.messageService.addWarning('Invalid derivation path');\r\n    }\r\n  }\r\n  async importFromPk(pk: string, path: string) {\r\n    if (utils.validPublicKey(pk)) {\r\n      if (await this.importService.importWalletFromPk(pk, path)) {\r\n        if (this.walletService.wallet.implicitAccounts.length === 1 && this.walletService.wallet.implicitAccounts[0].originatedAccounts.length === 0) {\r\n          this.router.navigate([`/account/${this.walletService.wallet.implicitAccounts[0].address}`]);\r\n        } else {\r\n          this.router.navigate(['/accounts']);\r\n        }\r\n      } else {\r\n        this.messageService.addError('Failed to import Ledger wallet');\r\n      }\r\n    } else {\r\n      this.messageService.addError('Not a valid public key');\r\n    }\r\n  }\r\n  setDefaultPath() {\r\n    if (this.isHDDerivationPathCustom) {\r\n      this.path = this.defaultText;\r\n    } else {\r\n      this.path = this.defaultPath;\r\n    }\r\n  }\r\n}\r\n","// The file contents for the current environment will overwrite these during build.\r\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\r\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\r\n// The list of which env maps to which file can be found in `.angular-cli.json`.\r\nimport { Constants } from './../app/interfaces';\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\nexport const CONSTANTS: Constants = {\r\n  NAME: 'Testnet / Delphinet',\r\n  NETWORK: 'delphinet',\r\n  MAINNET: false,\r\n  NODE_URL: 'https://delphinet-tezos.giganode.io',\r\n  BLOCK_EXPLORER_URL: 'https://delphinet.tzkt.io',\r\n  ASSETS: {\r\n    'KT1REPEBMQS3Be8ZybkQQfSwAv3g4pHJViuK': {\r\n      kind: 'FA1.2',\r\n      category: 'finance',\r\n      tokens: {\r\n        0: {\r\n          name: 'USD Tez',\r\n          symbol: 'USDtz',\r\n          decimals: 6,\r\n          description: 'USDtz is a Tezos on-chain stablecoin pegged to the value of the United States Dollar.',\r\n          displayUrl: '../../../assets/img/tokens/usdtz.png',\r\n          thumbnailUrl: '../../../assets/img/tokens/usdtz.png',\r\n          symbolPreference: true\r\n        }\r\n      }\r\n    },\r\n    'KT1MGe5wY9FugXvsjin4SnQFEU7yM1FFBF9U': {\r\n      kind: 'FA2',\r\n      category: 'finance',\r\n      tokens: {\r\n        0: {\r\n          name: 'Tezos Israel Workshop Certificate',\r\n          symbol: 'MFIL',\r\n          decimals: 0,\r\n          description: 'This certificate verifies that the holder of its private key attended, contributed and completed the Tezos Israel and Madfish Solution Workshop on December 7th to the 9th, 2020. The certificate holder utilized skills in smart contract development and tokenization to build, test and deploy a token on the Tezos blockchain.',\r\n          displayUrl: '../../../assets/img/tokens/mfil.jfif',\r\n          thumbnailUrl: '../../../assets/img/tokens/mfil.jfif',\r\n          nonTransferable: true,\r\n          booleanAmount: true\r\n        }\r\n      }\r\n    },\r\n    'KT1RXpLtz22YgX24QQhxKVyKvtKZFaAVtTB9': {\r\n      kind: 'FA1.2',\r\n      category: 'finance',\r\n      tokens: {\r\n        0: {\r\n          name: 'Kolibri USD',\r\n          symbol: 'kUSD',\r\n          decimals: 18,\r\n          description: 'Kolibri is a Tezos based stablecoin built on Collateralized Debt Positions (CDPs) known as Ovens.',\r\n          displayUrl: '../../../assets/img/tokens/kusd.png',\r\n          thumbnailUrl: '../../../assets/img/tokens/kusd.png',\r\n          symbolPreference: true\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\nexport const TRUSTED_TOKEN_CONTRACTS = [\r\n  'KT1LyJV9JdcDCp5zDfw6MxpoShXYrBMG3dfK',\r\n  'KT1RfMoskMhR1hDFJTVN6gGMwQLDSTmLeDsc',\r\n  'KT1Szwqme712TkQ7LdP1hBqKjdUUBjxoB8bR',\r\n  'KT1PS2jZVzNMW54UsnqBqwwkArXnAZ29jiTF'\r\n];\r\n","import { Activity } from './services/wallet/wallet';\r\nimport { ContractType } from './services/token/token.service';\r\n\r\nexport { Activity };\r\n\r\nexport interface KeyPair {\r\n    sk: string|null;\r\n    pk: string|null;\r\n    pkh: string;\r\n}\r\nexport interface Wallet {\r\n  seed: null|string;\r\n  salt: null|string;\r\n  pk?: string;\r\n  encryptionVersion: number|null;\r\n  type: WalletType;\r\n  balance: Balance;\r\n  XTZrate: number | null;\r\n  accounts: Account[];\r\n  derivationPath?: string;\r\n}\r\nexport interface Account {\r\n  pkh: string|null;\r\n  delegate: string;\r\n  balance: Balance;\r\n  numberOfActivites: number;\r\n  activities: Activity[];\r\n}\r\nexport interface Balance {\r\n  balanceXTZ: number | null;\r\n  pendingXTZ: number | null;\r\n  balanceFiat: number | null;\r\n  pendingFiat: number | null;\r\n}\r\nexport enum WalletType {\r\n  FullWallet,\r\n  ViewOnlyWallet,\r\n  ObserverWallet,\r\n  LedgerWallet,\r\n  HdWallet\r\n}\r\nexport interface Baker {\r\n  baker_name: string;\r\n  image: string;\r\n  rolls: number;\r\n  identity: string;\r\n  vote: string;\r\n  vote2: string;\r\n  // vote: []\r\n}\r\nexport interface Vote {\r\n  voting_period: string;\r\n  period_kind: PeriodKind;\r\n  proposal_hash: string[];\r\n  proposal_alias: string[];\r\n  votes: number[];\r\n  operation: string[];\r\n}\r\nexport interface Period {\r\n  amendment: string;\r\n  period: number;\r\n  period_kind: string;\r\n  proposal_hash: string[];\r\n  proposal_alias: string[];\r\n  start_level: number;\r\n  end_level: number;\r\n  level: number;\r\n  progress: number;\r\n  remaining: number;\r\n}\r\nexport interface ParticipationPerPeriod {\r\n  proposal?: [{\r\n    hash: string;\r\n    alias: string;\r\n    count: number;\r\n    votes: number;\r\n  }];\r\n  unused_count: number;\r\n  total_count: number;\r\n  unused_votes: number;\r\n  total_votes: number;\r\n}\r\nexport interface Ballot {\r\n  proposal: string;\r\n  nb_yay: number;\r\n  nb_nay: number;\r\n  nb_pass: number;\r\n  vote_yay: number;\r\n  vote_nay: number;\r\n  vote_pass: number;\r\n}\r\nexport enum PeriodKind {\r\n  Proposal,\r\n  Exploration,\r\n  Testing,\r\n  Promotion\r\n}\r\nexport interface DefaultTransactionParams {\r\n  gas: number;\r\n  storage: number;\r\n  fee: number;\r\n  burn: number;\r\n  reveal?: boolean;\r\n  customLimits?: {\r\n    gasLimit: number;\r\n    storageLimit: number;\r\n  }[];\r\n}\r\nexport interface Constants {\r\n  NAME: string;\r\n  NETWORK: string;\r\n  MAINNET: boolean;\r\n  NODE_URL: string;\r\n  BLOCK_EXPLORER_URL: string;\r\n  CSI?: {\r\n    url: string;\r\n    apiKey: string;\r\n  };\r\n  ASSETS: Record<string, ContractType>;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { CONSTANTS, TRUSTED_TOKEN_CONTRACTS } from '../../../environments/environment';\r\nimport { IndexerService } from '../indexer/indexer.service';\r\nimport Big from 'big.js';\r\n\r\nexport interface TokenResponseType {\r\n  contractAddress: string;\r\n  id: number;\r\n  decimals: number;\r\n  displayUrl: string;\r\n  thumbnailUrl: string;\r\n  name: string;\r\n  symbol: string;\r\n  description: string;\r\n  category: string;\r\n  kind: string;\r\n  nonTransferable?: boolean;\r\n  booleanAmount?: boolean;\r\n  symbolPreference?: boolean;\r\n}\r\nexport type ContractsType = Record<string, ContractType>;\r\nexport type ContractType = FA12 | FA2;\r\nexport interface TokensInterface {\r\n  category: string;\r\n}\r\nexport interface TokenData {\r\n  name: string;\r\n  symbol: string;\r\n  decimals: number;\r\n  description: string;\r\n  displayUrl: string;\r\n  thumbnailUrl: string;\r\n  nonTransferable?: boolean;\r\n  booleanAmount?: boolean;\r\n  symbolPreference?: boolean;\r\n}\r\nexport interface FA12 extends TokensInterface {\r\n  kind: 'FA1.2';\r\n  tokens: {\r\n    0: TokenData\r\n  };\r\n}\r\nexport interface FA2 extends TokensInterface {\r\n  kind: 'FA2';\r\n  tokens: Record<number, TokenData>;\r\n}\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\nexport class TokenService {\r\n  readonly AUTO_DISCOVER: boolean = true;\r\n  readonly version: string = '1.0.1';\r\n  private contracts: ContractsType = {};\r\n  private exploredIds: Record<string, { firstCheck: number, lastCheck: number }> = {};\r\n  readonly storeKey = 'tokenMetadata';\r\n  constructor(\r\n    public indexerService: IndexerService\r\n  ) {\r\n    this.contracts = CONSTANTS.ASSETS;\r\n    this.loadMetadata();\r\n  }\r\n  getAsset(tokenId: string): TokenResponseType {\r\n    if (!tokenId || !tokenId.includes(':')) {\r\n      console.warn(`Invalid tokenId`, tokenId);\r\n      return null;\r\n    }\r\n    const tokenIdArray = tokenId.split(':');\r\n    const contractAddress: string = tokenIdArray[0];\r\n    const id: number = tokenIdArray[1] ? Number(tokenIdArray[1]) : -1;\r\n    const contract: ContractType = this.contracts[contractAddress];\r\n    if (id > -1) {\r\n      if (contract) {\r\n        const token = contract.tokens[id];\r\n        if (token) {\r\n          return {\r\n            kind: contract.kind,\r\n            category: contract.category,\r\n            id,\r\n            contractAddress,\r\n            ...token\r\n          };\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  isKnownTokenId(tokenId: string): boolean {\r\n    return (this.getAsset(tokenId) !== null);\r\n  }\r\n  knownTokenIds(): string[] {\r\n    const tokenIds: string[] = [];\r\n    const contractKeys = Object.keys(this.contracts);\r\n    if (contractKeys) {\r\n      for (const contractKey of contractKeys) {\r\n        const tokenKeys = Object.keys(this.contracts[contractKey].tokens);\r\n        if (tokenKeys) {\r\n          for (const tokenKey of tokenKeys) {\r\n            tokenIds.push(`${contractKey}:${tokenKey}`);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return tokenIds;\r\n  }\r\n  isKnownTokenContract(address: string): boolean {\r\n    return (this.contracts[address] !== undefined);\r\n  }\r\n  addAsset(contractAddress: string, contract: ContractType) {\r\n    if (!this.contracts[contractAddress]) {\r\n      this.contracts[contractAddress] = contract;\r\n    } else {\r\n      const currentKeys = Object.keys(this.contracts[contractAddress].tokens);\r\n      const newKeys = Object.keys(contract.tokens);\r\n      for (const key of newKeys) {\r\n        if (!currentKeys.includes(key)) {\r\n          this.contracts[contractAddress].tokens[key] = contract.tokens[key];\r\n        }\r\n      }\r\n    }\r\n  }\r\n  async searchMetadata(contractAddress: string, id: number) {\r\n    const tokenId = `${contractAddress}:${id}`;\r\n    if (this.explore(tokenId)) {\r\n      console.log(`Searching for tokenId: ${tokenId}`);\r\n      const metadata = await this.indexerService.getTokenMetadata(contractAddress, id);\r\n      if (metadata &&\r\n        (metadata.name || metadata.symbol) &&\r\n        (!isNaN(metadata.decimals) && metadata.decimals >= 0)\r\n      ) {\r\n        const contract: ContractType = {\r\n          kind: metadata.tokenType ? metadata.tokenType : 'FA2',\r\n          category: metadata.tokenCategory ? metadata.tokenCategory : '',\r\n          tokens: {}\r\n        };\r\n        const defaultImg = '../../../assets/img/tokens/unknown-token.png';\r\n        let displayUrl = (metadata.displayUri && TRUSTED_TOKEN_CONTRACTS.includes(contractAddress)) ? metadata.displayUri : defaultImg;\r\n        let thumbnailUrl = (metadata.thumbnailUri && TRUSTED_TOKEN_CONTRACTS.includes(contractAddress)) ? metadata.thumbnailUri : defaultImg;\r\n        if (displayUrl === defaultImg && thumbnailUrl !== defaultImg) {\r\n          displayUrl = thumbnailUrl;\r\n        }\r\n        if (displayUrl !== defaultImg && thumbnailUrl === defaultImg) {\r\n          thumbnailUrl = displayUrl;\r\n        }\r\n        const token: TokenData = {\r\n          name: metadata.name ? metadata.name : '',\r\n          symbol: metadata.symbol ? metadata.symbol : '',\r\n          decimals: Number(metadata.decimals),\r\n          description: metadata.description ? metadata.description : '',\r\n          displayUrl,\r\n          thumbnailUrl,\r\n          nonTransferable: metadata?.nonTransferable ? metadata.nonTransferable : false,\r\n          booleanAmount: metadata?.booleanAmount ? metadata.booleanAmount : false\r\n        };\r\n        contract.tokens[id] = token;\r\n        this.addAsset(contractAddress, contract);\r\n        this.saveMetadata();\r\n      }\r\n    }\r\n  }\r\n  explore(tokenId: string): boolean {\r\n    const now = new Date().getTime();\r\n    if (!this.exploredIds[tokenId]) {\r\n      this.exploredIds[tokenId] = { firstCheck: now, lastCheck: now };\r\n      this.saveMetadata();\r\n      return true;\r\n    } else {\r\n      const token = this.exploredIds[tokenId];\r\n      const timeout = (token.lastCheck - token.firstCheck) > 600000;\r\n      const reCheck = (now - token.lastCheck) > 2000;\r\n      if (timeout || !reCheck) {\r\n        return false;\r\n      }\r\n      this.exploredIds[tokenId].lastCheck = now;\r\n      this.saveMetadata();\r\n      return true;\r\n    }\r\n  }\r\n  searchTimeMs(tokenId: string) {\r\n    if (this.exploredIds[tokenId]) {\r\n      const token = this.exploredIds[tokenId];\r\n      return (token.lastCheck - token.firstCheck);\r\n    }\r\n    return 0;\r\n  }\r\n  getPlaceholderToken(tokenId: string): TokenResponseType {\r\n    const tokenIdArray = tokenId.split(':');\r\n    const contractAddress: string = tokenIdArray[0];\r\n    const id: number = tokenIdArray[1] ? Number(tokenIdArray[1]) : -1;\r\n    return {\r\n      contractAddress,\r\n      id,\r\n      decimals: 0,\r\n      displayUrl: '../../../assets/img/tokens/unknown-token.png',\r\n      thumbnailUrl: '../../../assets/img/tokens/unknown-token.png',\r\n      name: '[Unknown token]',\r\n      symbol: '',\r\n      description: '',\r\n      category: '',\r\n      kind: 'FA2',\r\n    };\r\n  }\r\n  saveMetadata() {\r\n    localStorage.setItem(\r\n      this.storeKey,\r\n      JSON.stringify({ contracts: this.contracts, exploredIds: this.exploredIds, version: this.version })\r\n    );\r\n  }\r\n  loadMetadata(): any {\r\n    const metadataJson = localStorage.getItem(this.storeKey);\r\n    if (metadataJson) {\r\n      const metadata = JSON.parse(metadataJson);\r\n      if (metadata?.version === this.version) {\r\n        if (metadata?.contracts) {\r\n          const contractAddresses = Object.keys(metadata.contracts);\r\n          for (const address of contractAddresses) {\r\n            this.addAsset(address, metadata.contracts[address]);\r\n          }\r\n        }\r\n        if (metadata?.exploredIds) {\r\n          this.exploredIds = metadata.exploredIds;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  formatAmount(tokenKey: string, amount: string, baseUnit = true): string {\r\n    if (!tokenKey) {\r\n      return `${Big(amount).div(10 ** (baseUnit ? 6 : 0)).toFixed()} tez`;\r\n    } else {\r\n      const token = this.getAsset(tokenKey);\r\n      if (token) {\r\n        if ((!token.symbolPreference && token.name) || !token.symbol) {\r\n          if (token.booleanAmount) {\r\n            return `${token.name}`;\r\n          } else {\r\n            return `${Big(amount).div(10 ** (baseUnit ? token.decimals : 0)).toFixed()} ${token.name}`;\r\n          }\r\n        } else {\r\n          return `${Big(amount).div(10 ** (baseUnit ? token.decimals : 0)).toFixed()} ${token.symbol}`;\r\n        }\r\n      } else {\r\n        return '[Unknown token]';\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport DirectWebSdk from '@toruslabs/torus-direct-web-sdk';\r\nimport FetchNodeDetails from '@toruslabs/fetch-node-details';\r\nimport TorusUtils from '@toruslabs/torus.js';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\n\r\nconst GOOGLE = 'google';\r\nconst REDDIT = 'reddit';\r\nconst TWITTER = 'twitter';\r\nconst AUTH_DOMAIN = 'https://dev-0li4gssz.eu.auth0.com';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TorusService {\r\n  torus: any = null;\r\n  nodeDetails: { torusNodeEndpoints: String[], torusNodePub: any[] } = null;\r\n  public readonly verifierMap: any;\r\n  private readonly proxy: any;\r\n  verifierMaps = {\r\n    testnet: {\r\n      [GOOGLE]: {\r\n        name: 'Google',\r\n        typeOfLogin: 'google',\r\n        clientId: '952872982551-od475jfe3ach7dghacin634rbkcqhpll.apps.googleusercontent.com',\r\n        verifier: 'kukai-google',\r\n        caseSensitiveVerifierID: false\r\n      },\r\n      [REDDIT]: {\r\n        name: 'Reddit',\r\n        typeOfLogin: 'reddit',\r\n        clientId: 'H0nhRv1leU9pGQ',\r\n        verifier: 'tezos-reddit-testnet',\r\n        caseSensitiveVerifierID: false\r\n      },\r\n      [TWITTER]: {\r\n        name: 'Twitter',\r\n        typeOfLogin: 'twitter',\r\n        clientId: 'vKFgnaYZzKLUnhxnX5xqTqeMcumdVTz1',\r\n        verifier: 'tezos-twitter-test',\r\n        caseSensitiveVerifierID: false\r\n      }\r\n    },\r\n    mainnet: {\r\n      [GOOGLE]: {\r\n        name: 'Google',\r\n        typeOfLogin: 'google',\r\n        clientId: '952872982551-49mfvktoios59oj2kmiknlltfq9pvi6c.apps.googleusercontent.com',\r\n        verifier: 'tezos-google',\r\n        caseSensitiveVerifierID: false\r\n      },\r\n      [REDDIT]: {\r\n        name: 'Reddit',\r\n        typeOfLogin: 'reddit',\r\n        clientId: 'YivAW_t3iCp9QA',\r\n        verifier: 'tezos-reddit',\r\n        caseSensitiveVerifierID: false\r\n      },\r\n      [TWITTER]: {\r\n        name: 'Twitter',\r\n        typeOfLogin: 'twitter',\r\n        clientId: 'UJl5d4iHVgbrAaSlucXNf2F2uKlC0m25',\r\n        verifier: 'tezos-twitter',\r\n        caseSensitiveVerifierID: false\r\n      }\r\n    }\r\n  };\r\n  verifierMapKeys: any;\r\n  constructor(\r\n    private operationService: OperationService,\r\n    private inputValidationService: InputValidationService\r\n  ) {\r\n    if (CONSTANTS.MAINNET) {\r\n      this.verifierMap = this.verifierMaps.mainnet;\r\n      this.proxy = { address: '0x638646503746d5456209e33a2ff5e3226d698bea', network: 'mainnet' };\r\n    } else {\r\n      this.verifierMap = this.verifierMaps.testnet;\r\n      this.proxy = { address: '0x4023d2a0D330bF11426B12C6144Cfb96B7fa6183', network: 'ropsten' };\r\n    }\r\n    this.verifierMapKeys = Object.keys(this.verifierMap);\r\n  }\r\n  async initTorus() {\r\n    if (!this.torus) {\r\n      try {\r\n        const torusdirectsdk = new DirectWebSdk({\r\n          baseUrl: `${location.origin}/serviceworker`,\r\n          enableLogging: !(this.proxy.network === 'mainnet'),\r\n          proxyContractAddress: this.proxy.address,\r\n          network: (this.proxy.network === 'mainnet') ? this.proxy.network : 'testnet',\r\n        });\r\n        await torusdirectsdk.init({ skipSw: false });\r\n        this.torus = torusdirectsdk;\r\n      } catch (error) {\r\n        console.error(error, 'oninit caught');\r\n      }\r\n    }\r\n  }\r\n  async lookupPkh(selectedVerifier: string, verifierId: string): Promise<any> {\r\n    const fetchNodeDetails = new FetchNodeDetails({ network: this.proxy.network, proxyAddress: this.proxy.address });\r\n    const torus = new TorusUtils();\r\n    const verifier = this.verifierMap[selectedVerifier].verifier;\r\n    if (!this.nodeDetails) {\r\n      const { torusNodeEndpoints, torusNodePub, torusIndexes } = await fetchNodeDetails.getNodeDetails();\r\n      this.nodeDetails = { torusNodeEndpoints, torusNodePub }; // Cache node details\r\n    }\r\n    let sanitizedVerifierId = verifierId;\r\n    if (!this.verifierMap[selectedVerifier].caseSensitiveVerifierID) {\r\n      sanitizedVerifierId = sanitizedVerifierId.toLocaleLowerCase();\r\n    }\r\n    let twitterId = '';\r\n    if (selectedVerifier === 'twitter') {\r\n      const username = sanitizedVerifierId.replace('@', '');\r\n      const { id } = await this.twitterLookup(username);\r\n      if (this.inputValidationService.twitterId(id)) {\r\n        sanitizedVerifierId = `twitter|${id}`;\r\n        twitterId = id;\r\n      } else {\r\n        throw new Error('Twitter handle not found');\r\n      }\r\n    }\r\n    const pk: any = await torus.getPublicAddress(this.nodeDetails.torusNodeEndpoints, this.nodeDetails.torusNodePub, { verifier, verifierId: sanitizedVerifierId }, true);\r\n    const pkh = this.operationService.spPointsToPkh(pk.X, pk.Y);\r\n    return { pkh, twitterId };\r\n  }\r\n  async twitterLookup(username?: string, id?: string) {\r\n    let req = {};\r\n    if ((id && username) || (!id && !username)) {\r\n      console.log({ username, id });\r\n      throw new Error('Invalid input');\r\n    } else if (id) {\r\n      req = { id };\r\n    } else {\r\n      req = { username: username.replace('@', '') };\r\n    }\r\n    return await fetch(`https://api.tezos.help/twitter-lookup/`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      referrerPolicy: 'no-referrer',\r\n      body: JSON.stringify(req)\r\n    }).then(\r\n      (ans) => {\r\n        return ans.json();\r\n      }\r\n    );\r\n  }\r\n  async loginTorus(selectedVerifier: string, verifierId = ''): Promise<any> {\r\n    try {\r\n      const jwtParams: any = this._loginToConnectionMap()[selectedVerifier] || {};\r\n      if (verifierId && selectedVerifier === GOOGLE) {\r\n        jwtParams.login_hint = verifierId;\r\n        console.log('login_hint: ' + verifierId);\r\n      }\r\n      const { typeOfLogin, clientId, verifier } = this.verifierMap[selectedVerifier];\r\n      const loginDetails = await this.torus.triggerLogin({\r\n        verifier,\r\n        typeOfLogin,\r\n        clientId,\r\n        jwtParams\r\n      });\r\n      const keyPair = this.operationService.spPrivKeyToKeyPair(loginDetails.privateKey);\r\n      console.log('DirectAuth KeyPair', keyPair);\r\n      return { keyPair, userInfo: loginDetails.userInfo };\r\n    } catch (e) {\r\n      console.error(e, 'login caught');\r\n      return { keyPair: null, userInfo: null };\r\n    }\r\n  }\r\n  async getTorusKeyPair(selectedVerifier: string, verifierId: string): Promise<any> {\r\n    const { keyPair } = await this.loginTorus(selectedVerifier, verifierId);\r\n    return keyPair;\r\n  }\r\n  _loginToConnectionMap = () => {\r\n    return {\r\n      [TWITTER]: {\r\n        domain: AUTH_DOMAIN,\r\n      }\r\n    };\r\n  }\r\n}\r\n","<div class=\"spinIn\">\r\n  <h2>Icabod Login</h2>\r\n  <div class=\"buttons\" *ngIf=\"torusService && torusService.verifierMapKeys\">\r\n    <ng-container *ngFor=\"let key of torusService.verifierMapKeys\">\r\n      <img src=\"../../../../assets/img/torus-login/{{ key }}-color.svg\" width=\"24\" (click)=\"login(key)\">\r\n    </ng-container>\r\n    <img src=\"../../../../assets/img/x.svg\" (click)=\"abort()\">\r\n  </div>\r\n</div>","import { EventEmitter, Output } from '@angular/core';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { MessageService } from '../../../services/message/message.service';\r\nimport { TorusService } from '../../../services/torus/torus.service';\r\n\r\n@Component({\r\n  selector: 'app-signin',\r\n  templateUrl: './signin.component.html',\r\n  styleUrls: ['./signin.component.scss']\r\n})\r\nexport class SigninComponent implements OnInit {\r\n  loading = false;\r\n  @Output() loginResponse = new EventEmitter();\r\n  constructor(\r\n    private messageService: MessageService,\r\n    public torusService: TorusService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n  abort() {\r\n    this.loginResponse.emit(null);\r\n  }\r\n  async login(typeOfLogin: string) {\r\n    try {\r\n      this.messageService.startSpinner('Loading wallet...');\r\n      //const loginData = await this.mockLogin(); // Mock locally\r\n      const loginData = await this.torusService.loginTorus(typeOfLogin);\r\n      await this.messageService.stopSpinner();\r\n      this.loginResponse.emit(loginData);\r\n    } catch {\r\n      await this.messageService.stopSpinner();\r\n    }\r\n  }\r\n  private async mockLogin(): Promise<any> {\r\n    const keyPair = {\r\n      sk: 'spsk1VfCfhixtzGvUSKDre6jwyGbXFm6aoeLGnxeVLCouueZmkgtJF',\r\n      pk: 'sppk7cZsZeBApsFgYEdWuSwj92YCWkJxMmBfkN3FeKRmEB7Lk5pmDrT',\r\n      pkh: 'tz2WKg52VqnYXH52TZbSVjT4hcc8YGVKi7Pd'\r\n    };\r\n    const userInfo = {\r\n      typeOfLogin: 'google',\r\n      verifierId: 'mock.user@gmail.com',\r\n      name: 'Mock User'\r\n    };\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve({ keyPair, userInfo });\r\n      }, 2000);\r\n    });\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Location } from '@angular/common';\r\nimport { Router, Event, NavigationEnd } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-footer',\r\n  templateUrl: './footer.component.html',\r\n  styleUrls: ['./footer.component.scss']\r\n})\r\nexport class FooterComponent implements OnInit {\r\n  darkText = false;\r\n  path = '';\r\n  constructor(\r\n    private location: Location,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.path = this.location.path();\r\n    this.setFooter();\r\n    this.router.events.subscribe((event: Event) => {\r\n      if (event instanceof NavigationEnd) {\r\n        this.setFooter();\r\n      }\r\n    });\r\n  }\r\n  setFooter() {\r\n    const altFooter = ['/terms-of-use', '/privacy-policy', '/settings'];\r\n    this.path = this.location.path();\r\n    if (altFooter.includes(this.path)) {\r\n      this.darkText = true;\r\n    } else {\r\n      this.darkText = false;\r\n    }\r\n  }\r\n}\r\n","<div *ngIf=\"this.path !== '/embedded'\" class=\"foot-container\" [class.dark]=\"darkText\">\r\n  <div id=\"follow\">\r\n    <span>follow kukai on</span>\r\n    <a href=\"https://github.com/kukai-wallet/kukai\" target=\"_blank\"><img src=\"../../../assets/img/logo-github.svg\"></a>\r\n    <a id=\"tg\" href=\"https://t.me/KukaiWallet\" target=\"_blank\"><img src=\"../../../assets/img/logo-telegram.svg\"></a>\r\n    <a href=\"https://twitter.com/KukaiWallet/\" target=\"_blank\"><img src=\"../../../assets/img/logo-twitter.svg\"></a>\r\n  </div>\r\n  <div class=\"links\">\r\n    <div class=\"left low\">\r\n      <a href=\"./terms-of-use\" target=\"_blank\">Terms of Use</a>\r\n      <a href=\"./privacy-policy\" target=\"_blank\">Privacy Policy</a>\r\n      <a target=\"_blank\" href=\"mailto:contact@kukai.app\">Contact</a>\r\n    </div>\r\n    <div class=\"since low\">\r\n      <a>Since 2018 &trade;</a>\r\n    </div>\r\n    <div class=\"low\">\r\n        <a class=\"docs\" href=\"https://docs.kukai.app\" target=\"_blank\">\r\n          Help</a>\r\n    </div>\r\n  </div>\r\n</div>","<ng-container *ngIf=\"!beaconMode\">\r\n  <button *ngIf=\"!tokenTransfer\" class=\"purple open\" (click)=\"openModal()\">Send</button>\r\n  <span class=\"token-send\" *ngIf=\"tokenTransfer && !tokenService.getAsset(tokenTransfer).nonTransferable\" (click)=\"openModal()\">Send</span>\r\n</ng-container>\r\n\r\n<!-- The Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\" [class.top]=\"beaconMode\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModalAction()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1 *ngIf=\"activeView === 0\">{{ getTitle() }}</H1>\r\n      <H1 *ngIf=\"activeView === 1\">Confirmation</H1>\r\n      <!--<span class=\"close\" (click)=\"modalOpen = false\" class=\"close\">&times;</span>-->\r\n      <button *ngIf=\"activeView === 0 && !(tokenTransfer || beaconMode)\" class=\"small multiple-destinations\" (click)=\"toggleDestination()\">\r\n        <ng-container *ngIf=\"!this.isMultipleDestinations\">Multiple transactions</ng-container>\r\n        <ng-container *ngIf=\"this.isMultipleDestinations\">Single transaction</ng-container>\r\n      </button>\r\n    </div>\r\n    <!-- Prepare transaction -->\r\n    <div class=\"km-body\" *ngIf=\"activeView === 0\">\r\n      <div class=\"amount\">\r\n        <ng-container *ngIf=\"!hideAmount\">\r\n          <input #amountInput class=\"input\" class=\"custom-large\" placeholder=\"0.00\" [(ngModel)]=\"amount\"\r\n            (mousedown)=\"sendMax = false; default\" [style.font-size.rem]=\"dynSize()\" (input)=\"amountChange()\"\r\n            (keypress)=\"keyPressNumbersDecimal($event, 'amount')\" (change)=\"amountChange()\"\r\n            [style.width.ch]=\"amount ? amount.length + 1 : 3.6\" [disabled]=\"isMultipleDestinations || (beaconMode && operationRequest.operationDetails[0].amount)\">\r\n          <span class=\"tez\">{{ getAssetName() }}</span>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"hideAmount\">\r\n          <img style=\"height: 100%; width: auto;\" src=\"{{ tokenService.getAsset(tokenTransfer).thumbnailUrl }}\">\r\n        </ng-container>\r\n      </div>\r\n      <div class=\"row-group\">\r\n        <span *ngIf=\"hideAmount\"></span>\r\n        <button *ngIf=\"!(this.isMultipleDestinations || hideAmount || beaconMode)\" tabindex=-1 class=\"small\" [class.max]=\"sendMax\"\r\n          (click)=\"sendEntireBalance($event)\">Send Max</button>\r\n        <p *ngIf=\"this.isMultipleDestinations || beaconMode\"></p>\r\n        <p class=\"fee\">\r\n          <ng-container *ngIf=\"simSemaphore\"><img src=\"../../../assets/img/feeLoader.gif\">&nbsp;</ng-container>\r\n          <ng-container *ngIf=\"!getTotalBurn() ; else burn\">Fee: </ng-container>\r\n          <ng-template #burn>Fee & storage cost: </ng-template>\r\n          {{ getTotalCost(true) }}\r\n        </p>\r\n      </div>\r\n      <div class=\"group\">\r\n        <label>From address</label>\r\n        <p>{{ activeAccount.address }}</p>\r\n      </div>\r\n      <div *ngIf=\"!this.isMultipleDestinations\" class=\"group\">\r\n        <label style=\"justify-content: space-between; opacity: 1; color: rgba(44, 50, 58, 0.4)\"><span>Send to</span>\r\n          <select class=\"select-css\" [(ngModel)]=\"torusVerifier\" (ngModelChange)=\"verifierChange()\" [disabled]=\"beaconMode\">\r\n            <option value=\"\" selected>Tezos Address</option>\r\n            <option *ngFor=\"let key of torusService.verifierMapKeys\" value=\"{{key}}\">\r\n              {{ torusService.verifierMap[key].name }} Account</option>\r\n          </select></label>\r\n        <input type=\"text\" class=\"text\" (input)=\"updateDefaultValues()\" (change)=\"validateReceiverAddress()\" [disabled]=\"beaconMode\"\r\n          [(ngModel)]=\"toPkh\">\r\n      </div>\r\n      <div *ngIf=\"beaconMode && parameters\">\r\n        <label style=\"color: #C83532; margin-top: 1rem\">\r\n        <ng-container *ngIf=\"!batchParameters.length\">\r\n          This transaction will invoke a contract\r\n        </ng-container>\r\n        <ng-container *ngIf=\"batchParameters.length\">\r\n          These transactions will invoke <ng-container *ngIf=\"batchParameters.length === 1\">a contract</ng-container>\r\n          <ng-container *ngIf=\"batchParameters.length > 1\">contracts</ng-container>\r\n        </ng-container>\r\n      </label>\r\n      </div>\r\n      <ng-container *ngIf=\"torusVerifier\">\r\n        <p class=\"torus-details\" *ngIf=\"torusPendingLookup\">Loading address...</p>\r\n        <p class=\"torus-details\" *ngIf=\"!torusPendingLookup && torusLookupAddress\">{{ torusLookupAddress }}</p>\r\n      </ng-container>\r\n      <div *ngIf=\"this.isMultipleDestinations\" class=\"group\">\r\n        <label>Addresses and amounts <span class=\"batchInfo\">{{ batchSpace() }}</span></label>\r\n        <textarea type=\"text\" class=\"text\" (input)=\"updateDefaultValues()\" (change)=\"validateBatch()\" rows=\"3\"\r\n          [(ngModel)]=\"toMultipleDestinationsString\" [disabled]=\"beaconMode\"\r\n          placeholder=\"address1 amount1 ; &#10;address2 amount2 ; &#10;address3 ...\"></textarea>\r\n      </div>\r\n      <div class=\"advanced\">\r\n        <small>Advanced</small>\r\n        <div class=\"switch-container\">\r\n          <label class=\"switch\">\r\n            <input type=\"checkbox\" [(ngModel)]=\"advancedForm\" tabindex=-1>\r\n            <span class=\"slider round\"></span>\r\n          </label><span class=\"switch-desc\">\r\n            <ng-container *ngIf=\"!advancedForm\">Off</ng-container>\r\n            <ng-container *ngIf=\"advancedForm\">On</ng-container>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <div *ngIf=\"advancedForm\" class=\"advanced-form\">\r\n        <div class=\"row-group\">\r\n          <div class=\"group\">\r\n            <label>Gas limit</label>\r\n            <input type=\"text\" class=\"text\" placeholder={{this.defaultTransactionParams.gas.toString()}}\r\n            [class.read-only]=\"beaconMode && isMultipleDestinations\" [readonly]=\"beaconMode && isMultipleDestinations\"\r\n              [(ngModel)]=\"gas\">\r\n          </div>\r\n          <div class=\"group\">\r\n            <label>Fee</label>\r\n            <input type=\"text\" (input)=\"updateMaxAmount()\" (paste)=\"updateMaxAmount()\" class=\"text\"\r\n              (keypress)=\"keyPressNumbersDecimal($event, 'fee')\"\r\n              placeholder={{this.defaultTransactionParams.fee.toString()}} [(ngModel)]=\"fee\">\r\n          </div>\r\n        </div>\r\n        <div class=\"row-group\">\r\n          <div class=\"group\">\r\n            <label>Storage limit</label>\r\n            <input type=\"text\" [class.read-only]=\"beaconMode && isMultipleDestinations\" [readonly]=\"beaconMode && isMultipleDestinations\" (input)=\"updateMaxAmount()\" (paste)=\"updateMaxAmount()\" class=\"text\"\r\n              placeholder={{this.defaultTransactionParams.storage.toString()}} [(ngModel)]=\"storage\">\r\n          </div>\r\n          <div class=\"group\">\r\n            <label>Max storage cost</label>\r\n            <input type=\"text\" class=\"text read-only\" [value]=\"burnAmount() ? burnAmount() : '0 tez'\" tabindex=-1\r\n              readonly>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <span *ngIf=\"formInvalid\" class=\"danger no-margin\">\r\n        {{ formInvalid }}\r\n      </span>\r\n      <button style=\"margin: 2.5rem 0 1.5rem;\" class=\"purple\" (click)=\"openModal2()\">Preview</button>\r\n    </div>\r\n    <!-- Confirm transaction -->\r\n    <div class=\"km-body\" *ngIf=\"activeView === 1\">\r\n      <!-- Single transaction -->\r\n      <div class=\"preview-top\">\r\n        <div class=\"preview-amount\">\r\n          <span class=\"section\">Send</span>\r\n          <span class=\"amount-tez\">{{ tokenService.formatAmount(tokenTransfer, totalAmount(), false) }}</span>\r\n          <span class=\"amount-usd\">\r\n            <ng-container *ngIf=\"!tokenTransfer\">{{ totalAmount() * walletService.wallet.XTZrate | number:'1.0-2' }} USD\r\n            </ng-container>\r\n          </span>\r\n          <span *ngIf=\"!isMultipleDestinations\" class=\"section\">To</span>\r\n        </div>\r\n        <img *ngIf=\"!tokenTransfer; else imgElseBlock\" src=\"../../../assets/img/tezos-xtz-logo.svg\"\r\n          style=\"height: 4.5rem; margin-right: 1rem\">\r\n        <ng-template #imgElseBlock>\r\n          <img src=\"{{ tokenService.getAsset(tokenTransfer).thumbnailUrl }}\" style=\"height: 4.5rem; margin-right: 1rem\">\r\n        </ng-template>\r\n      </div>\r\n      <ng-container *ngIf=\"!isMultipleDestinations\">\r\n        <span *ngIf=\"torusLookupId\" class=\"torus-to\"><img src=\"../../../assets/img/{{ torusVerifier }}-logo.svg\">\r\n          {{ torusLookupId }}</span>\r\n        <span class=\"single-to\">{{ transactions[0].to }}</span>\r\n        <p class=\"previewAttention\" *ngIf=\"torusLookupId\">{{ previewAttention() }}</p>\r\n        <p class=\"previewAttention\" *ngIf=\"tokenTransfer && transactions[0].to.slice(0, 3) === 'KT1'\">Warning: Verify the contract can manage tokens</p>\r\n        <div class=\"seperator\"></div>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"isMultipleDestinations\">\r\n        <!-- Multiple transactions -->\r\n        <div class=\"seperator\"></div>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">{{ 'SENDCOMPONENT.TO' | translate }}</th>\r\n              <th scope=\"col\">{{ 'SENDCOMPONENT.AMOUNT' | translate }}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr *ngFor=\"let transaction of showTransactions\">\r\n              <td><span *ngIf=\"transaction.storageLimit\">*</span>{{ transaction.to }}</td>\r\n              <td class=\"txAmount\">{{ transaction.amount | number:'1.0-6' }}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <button style=\"margin-left: auto; margin: 0.5rem 0 1rem; height: 1.5rem;\" *ngIf='transactions.length > 2'\r\n          type=\"button\" class=\"small\" aria-label=\"More\" (click)=\"toggleTransactions()\">\r\n          <span aria-hidden=\"true\"> {{ showBtn }} </span>\r\n        </button>\r\n        <div class=\"seperator\"></div>\r\n      </ng-container>\r\n      <!-- Sender -->\r\n      <ng-container *ngIf=\"this.walletService.wallet.verifier\">\r\n        <!-- Torus -->\r\n        <div class=\"preview-row\">\r\n          <span>From</span><span><img src=\"../../../assets/img/{{ this.walletService.wallet.verifier }}-logo.svg\">\r\n            {{ this.walletService.wallet.displayName() }}\r\n          </span>\r\n        </div>\r\n        <div class=\"preview-row\">\r\n          <span>Address</span><span>{{ activeAccount.address }}</span>\r\n        </div>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"!this.walletService.wallet.name\">\r\n        <!-- Other -->\r\n        <div class=\"preview-row\">\r\n          <span>From</span><span>{{ activeAccount.address }}</span>\r\n        </div>\r\n      </ng-container>\r\n      <div class=\"seperator\"></div>\r\n      <div class=\"preview-row\">\r\n        <span>Fee</span><span>{{ getTotalFee() | number:'1.0-6' }} tez</span>\r\n      </div>\r\n      <div *ngIf=\"getTotalBurn()\" class=\"preview-row\">\r\n        <span>Max storage cost</span><span>{{ getTotalBurn() | number:'1.0-6' }} tez</span>\r\n      </div>\r\n      <div class=\"seperator\"></div>\r\n      <ng-container *ngIf=\"batchParameters.length > 1\">\r\n        <H6 style=\"color: #A8A8A8\">Contract Invokations</H6>\r\n        <div class=\"simple-tabs\" *ngIf=\"batchParameters.length <= 5\">\r\n          <ul class=\"tabs\">\r\n            <ng-container *ngFor=\"let params of batchParameters; let i = index\">\r\n              <li class=\"tab\" [class.active]=\"batchParamIndex === i\" (click)=\"updateParameters(i, params.parameters)\">\r\n                <ng-container *ngIf=\"batchParameters.length <= 3\">Operation</ng-container><ng-container *ngIf=\"batchParameters.length > 3\">Tx</ng-container>&nbsp;{{ params.num }}</li>\r\n            </ng-container>\r\n            <li class=\"tab rest\"></li>\r\n          </ul>\r\n        </div>\r\n        <select *ngIf=\"batchParameters.length > 5\" class=\"select-css parameters\" [(ngModel)]=\"batchParamIndex\"\r\n          (ngModelChange)=\"updateParameters(batchParamIndex, batchParameters[batchParamIndex].parameters)\">\r\n          <option *ngFor=\"let params of batchParameters; let i = index\" value=\"{{i}}\">\r\n            Operation {{params.num}}</option>\r\n        </select>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"parameters\">\r\n        <div class=\"preview-row\">\r\n          <span *ngIf=\"parameters?.entrypoint\" class=\"preview\">\r\n            Entrypoint\r\n          </span>\r\n          <span>{{ parameters.entrypoint }}</span>\r\n        </div>\r\n        <div class=\"tabs-container\">\r\n          <ul class=\"tabs\">\r\n            <li class=\"tab\" [class.active]=\"parametersFormat === 0\" (click)=\"setParametersFormat(0)\">Micheline</li>\r\n            <li class=\"tab\" [class.active]=\"parametersFormat === 1\" (click)=\"setParametersFormat(1)\">JSON</li>\r\n          </ul>\r\n        </div>\r\n        <textarea *ngIf=\"parameters\" style=\"width: 100%; font-size: 0.875rem\" rows=\"10\" readonly>{{ parametersTextboxDisplay() }}</textarea>\r\n      </ng-container>\r\n      <div class=\"row-group\" style=\"margin: 1.25rem 0 1.5rem;\">\r\n        <input *ngIf=\"!walletService.isLedgerWallet() && !walletService.isTorusWallet()\" [(ngModel)]=\"password\"\r\n          autocomplete=\"current-password\" placeholder=\"Password\" class=\"text password\" type=\"password\"\r\n          (input)=\"this.pwdValid = ''\" (change)=\"this.pwdValid = ''\" (keydown.enter)='inject()'>\r\n        <button class=\"purple confirm\" *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\"\r\n          (click)=\"ledgerRetry()\">Sign with Ledger</button>\r\n        <ng-template #elseBlock>\r\n          <button class=\"purple confirm\" (click)=\"inject()\"\r\n            [disabled]=\"walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)\">\r\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : 'Confirm'}}</button>\r\n        </ng-template>\r\n      </div>\r\n      <span *ngIf=\"this.pwdValid\" class=\"danger margin\">{{ this.pwdValid }}</span>\r\n    </div>\r\n  </div>\r\n</div>","import { Component, OnInit, ViewEncapsulation, Input, ViewChild, ElementRef, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { BsModalService } from 'ngx-bootstrap/modal';\r\nimport { KeyPair, DefaultTransactionParams } from '../../interfaces';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { LedgerService } from '../../services/ledger/ledger.service';\r\nimport { EstimateService } from '../../services/estimate/estimate.service';\r\nimport Big from 'big.js';\r\nimport { LedgerWallet, TorusWallet } from '../../services/wallet/wallet';\r\nimport { Account, ImplicitAccount, OriginatedAccount } from '../../services/wallet/wallet';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { TorusService } from '../../services/torus/torus.service';\r\nimport { LookupService } from '../../services/lookup/lookup.service';\r\nimport { TokenService } from '../../services/token/token.service';\r\nimport { emitMicheline, assertMichelsonData } from '@taquito/michel-codec';\r\n\r\ninterface SendData {\r\n  to: string;\r\n  amount: number;\r\n  gasLimit: number;\r\n  storageLimit: number;\r\n  parameters?: any;\r\n  meta?: {\r\n    alias: string;\r\n    verifier: string;\r\n    twitterId?: string;\r\n  };\r\n}\r\nconst zeroTxParams: DefaultTransactionParams = {\r\n  gas: 0,\r\n  storage: 0,\r\n  fee: 0,\r\n  burn: 0\r\n};\r\n@Component({\r\n  selector: 'app-send',\r\n  templateUrl: './send.component.html',\r\n  styleUrls: ['./send.component.scss']\r\n})\r\n\r\nexport class SendComponent implements OnInit, OnChanges {\r\n  @Input() activeAccount: Account;\r\n  @Input() tokenTransfer: string;\r\n  @Input() beaconMode = false;\r\n  @Input() operationRequest: any;\r\n  @Output() operationResponse = new EventEmitter();\r\n  @ViewChild('amountInput') amountInputView: ElementRef;\r\n  defaultTransactionParams: DefaultTransactionParams = zeroTxParams;\r\n  costPerByte: string = this.estimateService.costPerByte;\r\n  // torus\r\n  torusVerifier = '';\r\n  torusPendingLookup = false;\r\n  torusLookupAddress = '';\r\n  torusLookupId = '';\r\n  torusTwitterId = '';\r\n\r\n  modalOpen = false;\r\n  advancedForm = false;\r\n  sendMax = false;\r\n  hideAmount = false;\r\n\r\n  // Transaction variables\r\n  toPkh: string;\r\n  amount = '';\r\n  fee: string;\r\n  batchParameters: { num: number, parameters: any }[] = [];\r\n  batchParamIndex = 0;\r\n  parameters: any;\r\n  micheline: { entrypoint: string, value: string };\r\n  parametersFormat = 0;\r\n  sendFee: string;\r\n  burnFee = 0;\r\n  gas = '';\r\n  storage = '';\r\n  isMultipleDestinations = false;\r\n  toMultipleDestinationsString = '';\r\n  toMultipleDestinations: SendData[] = [];\r\n  activeView = 0;\r\n  showTransactions: SendData[] = [];\r\n  simSemaphore = 0;\r\n  dom: Document;\r\n  implicitAccounts = null;\r\n  password: string;\r\n  pwdValid: string;\r\n  formInvalid = '';\r\n  sendResponse: any;\r\n  errorMessage = '';\r\n  latestSimError = '';\r\n  transactions: SendData[] = [];\r\n  prevEquiClass = '';\r\n  XTZrate = 0;\r\n  ledgerError = '';\r\n  showBtn = 'Show More';\r\n\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private walletService: WalletService,\r\n    private operationService: OperationService,\r\n    private coordinatorService: CoordinatorService,\r\n    private inputValidationService: InputValidationService,\r\n    private ledgerService: LedgerService,\r\n    private estimateService: EstimateService,\r\n    private messageService: MessageService,\r\n    public torusService: TorusService,\r\n    private lookupService: LookupService,\r\n    public tokenService: TokenService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (this.walletService.wallet) {\r\n      console.log('init send');\r\n      this.init();\r\n    }\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (this.beaconMode) {\r\n      if (this.operationRequest &&\r\n        this.operationRequest.operationDetails[0].kind === 'transaction') {\r\n        console.log('Beacon payload to send', this.operationRequest);\r\n        this.loadBeaconPayload();\r\n      } else if (this.operationRequest) {\r\n        this.operationResponse.emit(null);\r\n      }\r\n    }\r\n  }\r\n  async loadBeaconPayload() {\r\n    await this.openModal();\r\n    if (this.operationRequest.operationDetails.length > 1) {\r\n      this.isMultipleDestinations = true;\r\n      for (const [i, op] of this.operationRequest.operationDetails.entries()) {\r\n        this.toMultipleDestinationsString = this.toMultipleDestinationsString + `${op.destination} ${Big(op.amount).div(10 ** 6).toFixed()}; `;\r\n        if (op.parameters) {\r\n          this.batchParameters.push({ num: i + 1, parameters: op.parameters });\r\n          if (!this.parameters) {\r\n            this.updateParameters(0, op.parameters);\r\n          }\r\n        }\r\n      }\r\n      this.updateDefaultValues();\r\n      this.validateBatch();\r\n    } else {\r\n      const tokenTransfer = this.beaconTokenTransfer(this.operationRequest.operationDetails[0]);\r\n      if (tokenTransfer) {\r\n        const asset = this.tokenService.getAsset(tokenTransfer.tokenId);\r\n        this.amount = Big(tokenTransfer.amount).div(10 ** asset.decimals).toFixed();\r\n        this.toPkh = tokenTransfer.to;\r\n        this.tokenTransfer = tokenTransfer.tokenId;\r\n        if (asset.booleanAmount) {\r\n          this.hideAmount = true;\r\n        }\r\n      } else {\r\n        if (this.operationRequest.operationDetails[0].destination) {\r\n          this.toPkh = this.operationRequest.operationDetails[0].destination;\r\n        } else {\r\n          console.warn('No destination');\r\n        }\r\n        if (this.operationRequest.operationDetails[0].amount) {\r\n          this.amount = Big(this.operationRequest.operationDetails[0].amount).div(1000000).toString();\r\n        }\r\n        if (this.operationRequest.operationDetails[0].parameters) {\r\n          this.parameters = this.operationRequest.operationDetails[0].parameters;\r\n        }\r\n      }\r\n      this.activeAccountChange();\r\n    }\r\n  }\r\n  updateParameters(index: number, parameters: any) {\r\n    console.log(index, parameters);\r\n    this.batchParamIndex = index;\r\n    this.parameters = parameters;\r\n    this.parametersToMicheline();\r\n  }\r\n  beaconTokenTransfer(op: any) {\r\n    if (op.parameters && this.tokenService.isKnownTokenContract(op.destination)) {\r\n      return this.operationService.parseTokenTransfer(op);\r\n    }\r\n    return null;\r\n  }\r\n  init() {\r\n    if (!this.activeAccount) {\r\n      this.activeAccount = this.walletService.wallet.implicitAccounts[0];\r\n    }\r\n    this.implicitAccounts = this.walletService.wallet.implicitAccounts;\r\n  }\r\n  /* Modal 2 */\r\n  async openModal() {\r\n    // hide body scrollbar\r\n    const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n    document.body.style.marginRight = scrollBarWidth.toString();\r\n    document.body.style.overflow = 'hidden';\r\n    console.log('open modal');\r\n    this.modalOpen = true;\r\n    if (this.walletService.wallet) {\r\n      if (!this.activeAccount) {\r\n        this.activeAccount = this.implicitAccounts[0];\r\n      }\r\n      this.clearForm();\r\n      if (this.tokenTransfer) {\r\n        const asset = this.tokenService.getAsset(this.tokenTransfer);\r\n        if (asset.booleanAmount) {\r\n          this.hideAmount = true;\r\n          this.amount = '1';\r\n          this.amountChange();\r\n        }\r\n      }\r\n      if (window.innerWidth > 1300) {\r\n        setTimeout(() => {\r\n          if (this.amountInputView) {\r\n            const inputElem = <HTMLInputElement>this.amountInputView.nativeElement;\r\n            inputElem.focus();\r\n          }\r\n        }, 100);\r\n      }\r\n      await this.estimateService.preLoadData(this.activeAccount.pkh, this.activeAccount.pk);\r\n    }\r\n  }\r\n  async openModal2() {\r\n    if (!this.simSemaphore && !this.torusPendingLookup) {\r\n      this.formInvalid = this.checkInput(true);\r\n      if (!this.formInvalid) {\r\n        if (!this.amount) { this.amount = '0'; }\r\n        let clearFee = false;\r\n        if (!this.fee) {\r\n          this.fee = this.defaultTransactionParams.fee.toString();\r\n          clearFee = true;\r\n        }\r\n        this.prepTransactions();\r\n        this.formInvalid = this.checkBalance();\r\n        if (!this.formInvalid) {\r\n          this.activeView++;\r\n          if (this.walletService.isLedgerWallet()) {\r\n            this.ledgerError = '?';\r\n          }\r\n        } else if (clearFee) {\r\n          this.fee = '';\r\n        }\r\n      }\r\n    }\r\n  }\r\n  async ledgerRetry() {\r\n    this.messageService.startSpinner('Preparing transaction...');\r\n    const keys = await this.walletService.getKeys('');\r\n    if (keys) {\r\n      await this.sendTransaction(keys);\r\n    } else {\r\n      this.messageService.stopSpinner();\r\n    }\r\n  }\r\n  async inject() {\r\n    if (this.walletService.isLedgerWallet()) {\r\n      this.broadCastLedgerTransaction();\r\n      this.sendResponse = null;\r\n      this.closeModal();\r\n    } else {\r\n      const pwd = this.password;\r\n      this.password = '';\r\n      this.messageService.startSpinner('Signing transaction...');\r\n      let keys;\r\n      try {\r\n        keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\r\n      } catch {\r\n        this.messageService.stopSpinner();\r\n      }\r\n      if (keys) {\r\n        this.pwdValid = '';\r\n        this.messageService.startSpinner('Sending transaction...');\r\n        this.sendTransaction(keys);\r\n        this.closeModal();\r\n      } else {\r\n        this.messageService.stopSpinner();\r\n        if (this.walletService.wallet instanceof TorusWallet) {\r\n          this.pwdValid = `Authorization failed`;\r\n        } else {\r\n          this.pwdValid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD');  // 'Wrong password!';\r\n        }\r\n      }\r\n    }\r\n  }\r\n  closeModalAction() {\r\n    this.closeModal();\r\n    this.operationResponse.emit(null);\r\n  }\r\n  closeModal() {\r\n    // restore body scrollbar\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.activeView = 0;\r\n    this.modalOpen = false;\r\n    this.clearForm();\r\n  }\r\n  showAccountBalance() {\r\n    const accountBalance = Big(this.activeAccount.balanceXTZ).div(1000000).toString();\r\n    return this.numberWithCommas(accountBalance) + ' XTZ';\r\n  }\r\n  numberWithCommas(x: string) {\r\n    const parts: Array<string> = x.split('.');\r\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n    return parts.join('.');\r\n  }\r\n  sendEntireBalance(event: Event) {\r\n    event.stopPropagation();\r\n    this.sendMax = true;\r\n    this.checkMaxAmount();\r\n    this.amountChange();\r\n  }\r\n  checkMaxAmount() {\r\n    if (this.sendMax) {\r\n      const max = this.maxToSend(this.activeAccount);\r\n      if (max.length && max.slice(0, 1) !== '-') {\r\n        this.amount = max;\r\n      } else {\r\n        this.amount = '0';\r\n      }\r\n    }\r\n  }\r\n  updateMaxAmount() {\r\n    if (this.sendMax) {\r\n      const max = this.maxToSend(this.activeAccount);\r\n      let maxAmount = '0';\r\n      if (max.length && max.slice(0, 1) !== '-') {\r\n        maxAmount = max;\r\n      }\r\n      if (this.amount !== maxAmount) {\r\n        this.amount = maxAmount;\r\n      }\r\n    }\r\n  }\r\n  maxToSend(account: Account): string {\r\n    if (account && (account instanceof ImplicitAccount) && !this.tokenTransfer) {\r\n      let accountBalance = Big(account.balanceXTZ).div(1000000);\r\n      accountBalance = accountBalance.minus(this.fee && Number(this.fee) ? Number(this.fee) : this.defaultTransactionParams.fee);\r\n      if (!this.isMultipleDestinations) {\r\n        accountBalance = accountBalance.minus(this.storage && Number(this.storage) ? Number(Big(this.storage).times(this.costPerByte).div('1000000')) : this.defaultTransactionParams.burn);\r\n      } else {\r\n        accountBalance = accountBalance.minus(this.defaultTransactionParams.burn);\r\n      }\r\n      accountBalance = accountBalance.minus(0.000001); // dust\r\n      return accountBalance.toString();\r\n    } else {\r\n      if (this.tokenTransfer) {\r\n        if (account instanceof ImplicitAccount) {\r\n          return Big(account.getTokenBalance(this.tokenTransfer)).div(10 ** this.tokenService.getAsset(this.tokenTransfer).decimals).toFixed();\r\n        }\r\n      } else {\r\n        return Big(account.balanceXTZ).div(1000000).toString();\r\n      }\r\n    }\r\n  }\r\n  prepTransactions(finalCheck = false): boolean {\r\n    if (!this.checkInput(finalCheck)) {\r\n      if (!this.toMultipleDestinationsString) { this.toMultipleDestinationsString = ''; }\r\n      if (this.isMultipleDestinations) {\r\n        this.transactions = this.toMultipleDestinations;\r\n        this.showTransactions = [];\r\n        if (this.transactions.length > 1) {\r\n          this.showTransactions.push(this.transactions[0], this.transactions[1]);\r\n        } else {\r\n          this.showTransactions.push(this.transactions[0]);\r\n        }\r\n      } else {\r\n        const gasLimit: number = this.gas ? Number(this.gas) : this.defaultTransactionParams.gas;\r\n        const storageLimit: number = this.storage ? Number(this.storage) : this.defaultTransactionParams.storage;\r\n        const toAddress = !this.torusVerifier ? this.toPkh : this.torusLookupAddress;\r\n        const parameters = this.parameters ? this.parameters : undefined;\r\n        this.transactions = [{ to: toAddress, amount: Number(this.amount), gasLimit, storageLimit, parameters }];\r\n        if (this.torusLookupId) {\r\n          this.transactions[0].meta = { alias: this.torusLookupId, verifier: this.torusVerifier, twitterId: (this.torusVerifier === 'twitter') ? this.torusTwitterId : undefined };\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  async sendTransaction(keys: KeyPair) {\r\n    let amount = this.amount;\r\n    let fee = this.fee;\r\n    if (!this.walletService.isLedgerWallet()) {\r\n      this.toPkh = '';\r\n      this.amount = '';\r\n      this.fee = '';\r\n      this.gas = '';\r\n      this.storage = '';\r\n      this.toMultipleDestinationsString = '';\r\n      this.toMultipleDestinations = [];\r\n      this.showTransactions = [];\r\n    }\r\n    if (!amount) { amount = '0'; }\r\n    if (!fee) { fee = '0'; }\r\n    this.operationService.transfer(this.activeAccount.address, this.transactions, Number(fee), keys, this.tokenTransfer).subscribe(\r\n      async (ans: any) => {\r\n        this.sendResponse = ans;\r\n        if (ans.success === true) {\r\n          console.log('Transaction successful ', ans);\r\n          if (ans.payload.opHash) {\r\n            this.operationResponse.emit(ans.payload.opHash);\r\n            this.messageService.stopSpinner();\r\n            const metadata = { transactions: this.transactions, opHash: ans.payload.opHash, tokenTransfer: this.tokenTransfer };\r\n            this.coordinatorService.boost(this.activeAccount.address, metadata);\r\n            if (this.transactions[0].meta) {\r\n              this.torusNotification(this.transactions[0]);\r\n            }\r\n            for (const transaction of this.transactions) {\r\n              if (this.walletService.addressExists(transaction.to)) {\r\n                this.coordinatorService.boost(transaction.to);\r\n              }\r\n            }\r\n          } else if (this.walletService.wallet instanceof LedgerWallet) {\r\n            await this.requestLedgerSignature();\r\n          }\r\n        } else {\r\n          this.messageService.stopSpinner();\r\n          console.log('Transaction error id ', ans.payload.msg);\r\n          this.messageService.addError(ans.payload.msg, 0);\r\n          this.operationResponse.emit('broadcast_error');\r\n        }\r\n      },\r\n      err => {\r\n        this.messageService.stopSpinner();\r\n        console.log('Error Message ', JSON.stringify(err));\r\n        if (this.walletService.isLedgerWallet()) {\r\n          this.messageService.addError('Failed to create transaction', 0);\r\n          this.operationResponse.emit('broadcast_error');\r\n        }\r\n      },\r\n    );\r\n  }\r\n  async requestLedgerSignature() {\r\n    if (this.walletService.wallet instanceof LedgerWallet) {\r\n      await this.messageService.startSpinner('Waiting for Ledger signature...');\r\n      try {\r\n        const op = this.sendResponse.payload.unsignedOperation;\r\n        let signature = '';\r\n        if (op.length <= 2290) {\r\n          signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\r\n        } else {\r\n          signature = await this.ledgerService.signHash(this.operationService.ledgerPreHash('03' + op), this.walletService.wallet.implicitAccounts[0].derivationPath);\r\n        }\r\n        if (signature) {\r\n          const signedOp = op + signature;\r\n          this.sendResponse.payload.signedOperation = signedOp;\r\n          this.ledgerError = '';\r\n        } else {\r\n          this.ledgerError = 'Failed to sign transaction';\r\n        }\r\n      } finally {\r\n        this.messageService.stopSpinner();\r\n      }\r\n    }\r\n  }\r\n\r\n  async broadCastLedgerTransaction() {\r\n    this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(\r\n      ((ans: any) => {\r\n        this.sendResponse = ans;\r\n        if (ans.success && this.activeAccount) {\r\n          const metadata = { transactions: this.transactions, opHash: ans.payload.opHash, tokenTransfer: this.tokenTransfer };\r\n          if (this.transactions[0].meta) {\r\n            this.torusNotification(this.transactions[0]);\r\n          }\r\n          this.coordinatorService.boost(this.activeAccount.address, metadata);\r\n          if (this.walletService.addressExists(this.transactions[0].to)) {\r\n            this.coordinatorService.boost(this.transactions[0].to);\r\n          }\r\n        } else {\r\n          this.messageService.addError(this.sendResponse.payload.msg, 0);\r\n          this.operationResponse.emit('broadcast_error');\r\n        }\r\n        console.log('ans: ' + JSON.stringify(ans));\r\n      })\r\n    );\r\n  }\r\n  toggleDestination() {\r\n    this.defaultTransactionParams = zeroTxParams;\r\n    this.sendMax = false;\r\n    this.prevEquiClass = '';\r\n    this.isMultipleDestinations = !this.isMultipleDestinations;\r\n    this.transactions = [];\r\n    this.toMultipleDestinationsString = '';\r\n    this.formInvalid = '';\r\n    this.toPkh = '';\r\n    this.amount = '';\r\n    this.fee = '';\r\n    this.gas = '';\r\n    this.storage = '';\r\n    this.clearTorus();\r\n    this.updateDefaultValues();\r\n  }\r\n  burnAmount(): string {\r\n    const burn = this.storage ? Number(Big(this.storage).times(this.costPerByte).div(1000000)) : this.defaultTransactionParams.burn;\r\n    if (burn) {\r\n      return burn + ' tez';\r\n    }\r\n    return '';\r\n  }\r\n  clearForm() {\r\n    this.toPkh = '';\r\n    this.amount = '';\r\n    this.fee = '';\r\n    this.gas = '';\r\n    this.storage = '';\r\n    this.advancedForm = false;\r\n    this.sendMax = false;\r\n    this.toMultipleDestinationsString = '';\r\n    this.toMultipleDestinations = [];\r\n    this.isMultipleDestinations = false;\r\n    this.showTransactions = [];\r\n    this.password = '';\r\n    this.pwdValid = '';\r\n    this.formInvalid = '';\r\n    this.sendResponse = null;\r\n    this.ledgerError = '';\r\n    this.showBtn = 'Show More';\r\n    this.defaultTransactionParams = zeroTxParams;\r\n    this.prevEquiClass = '';\r\n    this.latestSimError = '';\r\n    this.hideAmount = false;\r\n    this.clearTorus();\r\n    this.parameters = null;\r\n    this.micheline = null;\r\n    this.parametersFormat = 0;\r\n    this.batchParameters = [];\r\n    this.batchParamIndex = 0;\r\n    if (this.beaconMode) {\r\n      this.tokenTransfer = '';\r\n    }\r\n  }\r\n\r\n  checkInput(finalCheck = false): string {\r\n    let result: any;\r\n    if (this.isMultipleDestinations) {\r\n      result = this.invalidInputMultiple(finalCheck);\r\n    } else {\r\n      result = this.invalidInputSingle(finalCheck);\r\n    }\r\n    if (!result && this.latestSimError) {\r\n      result = this.latestSimError;\r\n    }\r\n    return result;\r\n  }\r\n  checkBalance(): string {\r\n    if (this.transactions.length > 0) {\r\n      if (this.activeAccount && (this.activeAccount instanceof ImplicitAccount)) {\r\n        const max = Big(this.maxToSend(this.activeAccount)).plus(this.tokenTransfer ? 0 : 0.000001);\r\n        let amount = Big(0);\r\n        for (const tx of this.transactions) {\r\n          amount = amount.plus(Big(tx.amount));\r\n        }\r\n        if (amount.gt(max)) {\r\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHFEEORAMOUNT');\r\n        }\r\n      } else if (this.activeAccount && (this.activeAccount instanceof OriginatedAccount)) {\r\n        const maxKt = Big(this.maxToSend(this.activeAccount));\r\n        const maxTz = Big(this.maxToSend(this.walletService.wallet.getImplicitAccount(this.activeAccount.pkh))).plus(0.000001);\r\n        let amount = Big(0);\r\n        for (const tx of this.transactions) {\r\n          amount = amount.plus(Big(tx.amount));\r\n        }\r\n        if (amount.gt(maxKt)) {\r\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHAMOUNT');\r\n        } else if ((new Big('0')).gt(maxTz)) {\r\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHFEE');\r\n        }\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  async activeAccountChange() {\r\n    await this.estimateService.preLoadData(this.activeAccount.pkh, this.activeAccount.pk);\r\n    this.updateDefaultValues();\r\n  }\r\n  updateDefaultValues() {\r\n    if (!this.torusVerifier) {\r\n      this.estimateFees();\r\n      if (this.isMultipleDestinations) {\r\n        this.amount = this.totalAmount();\r\n      }\r\n    }\r\n  }\r\n  amountChange() {\r\n    if (this.beaconMode || this.tokenTransfer) {\r\n      this.estimateFees();\r\n    }\r\n  }\r\n  async estimateFees() {\r\n    console.log('estimate..');\r\n    const prevSimError = this.latestSimError;\r\n    this.latestSimError = '';\r\n    if (this.prepTransactions()) {\r\n      const equiClass = this.equiClass(this.activeAccount.address, this.transactions);\r\n      if (this.prevEquiClass !== equiClass || this.parameters || this.beaconMode || (this.tokenTransfer && this.checkBalance())) {\r\n        this.latestSimError = '';\r\n        this.prevEquiClass = equiClass;\r\n        this.simSemaphore++; // Put lock on 'Preview and 'Send max'\r\n        const callback = (res) => {\r\n          if (res) {\r\n            if (res.error) {\r\n              this.formInvalid = res.error;\r\n              this.latestSimError = res.error;\r\n            } else {\r\n              this.defaultTransactionParams = res;\r\n              this.formInvalid = '';\r\n              this.latestSimError = '';\r\n              this.updateMaxAmount();\r\n            }\r\n          }\r\n          this.simSemaphore--;\r\n        };\r\n        console.log('simulate...');\r\n        this.estimateService.estimate(JSON.parse(JSON.stringify(this.transactions)), this.activeAccount.address, this.tokenTransfer, callback);\r\n      } else {\r\n        this.latestSimError = prevSimError;\r\n        this.formInvalid = this.latestSimError;\r\n      }\r\n    } else {\r\n      this.latestSimError = prevSimError;\r\n      if (this.isMultipleDestinations ? !this.toMultipleDestinationsString : !this.toPkh) {\r\n        this.defaultTransactionParams = zeroTxParams;\r\n        this.updateMaxAmount();\r\n        this.prevEquiClass = '';\r\n      }\r\n    }\r\n  }\r\n  // prevent redundant estimations\r\n  equiClass(sender: string, transactions: SendData[]): string {\r\n    let data = sender;\r\n    if (this.tokenTransfer) {\r\n      data += transactions[0].to + transactions[0].amount.toString();\r\n    } else {\r\n      for (const tx of transactions) {\r\n        data += tx.to;\r\n      }\r\n    }\r\n    return data;\r\n  }\r\n  batchSpace(txs = 0) {\r\n    if (this.isMultipleDestinations && this.defaultTransactionParams.customLimits && this.defaultTransactionParams.customLimits.length) {\r\n      const numberOfTxs = txs ? txs : this.defaultTransactionParams.customLimits.length;\r\n      const txsLimit = 294 + (this.defaultTransactionParams.reveal ? 0 : 2); // Max transactions in a batch is 296 (294 with a reveal)\r\n      return !txs ? this.numberWithCommas(numberOfTxs + ' / ' + txsLimit) : numberOfTxs <= txsLimit;\r\n\r\n    }\r\n    return !txs ? '' : true;\r\n  }\r\n  recieverIsKT() {\r\n    return (this.inputValidationService.address(this.toPkh) && this.toPkh.slice(0, 2) === 'KT');\r\n  }\r\n  senderIsKT() {\r\n    return (this.activeAccount && (this.activeAccount instanceof OriginatedAccount));\r\n  }\r\n  validateReceiverAddress() {\r\n    if (!this.torusVerifier) {\r\n      if (!this.inputValidationService.address(this.toPkh) && this.toPkh !== '') {\r\n        this.formInvalid = this.translate.instant('SENDCOMPONENT.INVALIDRECEIVERADDRESS');\r\n      } else if (!this.latestSimError) {\r\n        this.formInvalid = ''; // clear error\r\n      }\r\n    } else { // Torus\r\n      this.torusLookupAddress = '';\r\n      if (this.torusService.verifierMapKeys.includes(this.torusVerifier)) {\r\n        if (!this.inputValidationService.torusAccount(this.toPkh, this.torusVerifier) && this.toPkh !== '') {\r\n          switch (this.torusVerifier) {\r\n            case 'google':\r\n              this.formInvalid = 'Invalid Google email address';\r\n              break;\r\n            case 'reddit':\r\n              this.formInvalid = 'Invalid Reddit username';\r\n              break;\r\n            case 'twitter':\r\n              this.formInvalid = 'Twitter username begins with \"@\"';\r\n              break;\r\n            default:\r\n              this.formInvalid = 'Unhandled verifier';\r\n          }\r\n        } else {\r\n          if (!this.latestSimError) {\r\n            this.formInvalid = ''; // clear error\r\n          }\r\n          this.torusLookup();\r\n        }\r\n      } else {\r\n        this.formInvalid = 'Unrecognized verifier';\r\n      }\r\n    }\r\n  }\r\n  validateBatch() {\r\n    this.formInvalid = this.checkInput();\r\n  }\r\n  invalidInputSingle(finalCheck: boolean): string {\r\n    if (!this.inputValidationService.address(this.activeAccount.address)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDSENDERADDRESS');\r\n    } else if (!this.inputValidationService.fee(this.fee)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDFEE');\r\n    } else if (this.parameters) {\r\n      console.log('parameters', this.parameters);\r\n      try {\r\n        if (!this.parameters.value ||\r\n          !this.parameters.entrypoint) {\r\n          throw new Error('entrypoint and value expected');\r\n        }\r\n        assertMichelsonData(this.parameters.value);\r\n        const res = emitMicheline(this.parameters.value, { indent: '  ', newline: '\\n' });\r\n        this.micheline = { entrypoint: this.parameters.entrypoint, value: res };\r\n      } catch (e) {\r\n        console.log(e);\r\n        if (this.beaconMode) {\r\n          this.formInvalid = e;\r\n        }\r\n        return e;\r\n      }\r\n    }\r\n    return this.checkReceiverAndAmount(this.toPkh, this.amount, finalCheck);\r\n  }\r\n  parametersToMicheline() {\r\n    if (this.parameters) {\r\n      try {\r\n        if (!this.parameters.value ||\r\n          !this.parameters.entrypoint) {\r\n          throw new Error('entrypoint and value expected');\r\n        }\r\n        assertMichelsonData(this.parameters.value);\r\n        const res = emitMicheline(this.parameters.value, { indent: '  ', newline: '\\n' });\r\n        this.micheline = { entrypoint: this.parameters.entrypoint, value: res };\r\n      } catch (e) {\r\n        console.log(e);\r\n        if (this.beaconMode) {\r\n          this.formInvalid = e;\r\n        }\r\n        this.micheline = null;\r\n      }\r\n    }\r\n  }\r\n  checkReceiverAndAmount(toPkh: string, amount: string, finalCheck: boolean): string {\r\n    if (!this.torusVerifier && (\r\n      !this.inputValidationService.address(toPkh) ||\r\n      toPkh === this.activeAccount.address\r\n    )) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDRECEIVERADDRESS');\r\n    } else if (this.torusVerifier\r\n      && (!this.inputValidationService.torusAccount(this.toPkh, this.torusVerifier) || this.torusLookupAddress === this.activeAccount.address)) {\r\n      return 'Invalid recipient';\r\n    } else if (!this.inputValidationService.amount(amount, this.tokenTransfer ? this.tokenService.getAsset(this.tokenTransfer).decimals : undefined) ||\r\n      (finalCheck && ((amount === '0') || amount === '') && (toPkh.slice(0, 3) !== 'KT1'))) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDAMOUNT');\r\n    } else if (!this.inputValidationService.gas(this.gas)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDGASLIMIT');\r\n    } else if (!this.inputValidationService.storage(this.storage)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDSTORAGELIMIT');\r\n    }\r\n    return '';\r\n  }\r\n\r\n  // Checking toMultipleDestinationsString and building up toMultipleDestinations[to: string, amount: number]\r\n  invalidInputMultiple(finalCheck = false): string {\r\n    if (!this.inputValidationService.address(this.activeAccount.address)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDSENDERADDRESS');\r\n    } else if (!this.inputValidationService.fee(this.fee)) {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDFEE');\r\n    }\r\n    this.toMultipleDestinations = [];\r\n    const toMultipleDestinationsArray = this.toMultipleDestinationsString.split(';');\r\n    if (toMultipleDestinationsArray.length === 1 && toMultipleDestinationsArray[0].trim() === '') {\r\n      return this.translate.instant('SENDCOMPONENT.INVALIDRECEIVERADDRESS');\r\n    }\r\n    let validationError = '';\r\n    toMultipleDestinationsArray.forEach((item, index) => {\r\n      toMultipleDestinationsArray[index] = item.trim();\r\n      if (toMultipleDestinationsArray[index] !== '') {\r\n        const singleSendDataArray = toMultipleDestinationsArray[index].split(' ');\r\n        if (singleSendDataArray.length === 2) {\r\n          const singleSendDataCheckresult = this.checkReceiverAndAmount(singleSendDataArray[0], singleSendDataArray[1], finalCheck);\r\n          if (singleSendDataCheckresult === '') {\r\n            const gasLimit = this.gas ? Number(this.gas) : this.defaultTransactionParams.customLimits &&\r\n              this.defaultTransactionParams.customLimits.length > index ?\r\n              this.defaultTransactionParams.customLimits[index].gasLimit : this.defaultTransactionParams.gas;\r\n            const storageLimit = this.storage ? Number(this.storage) : this.defaultTransactionParams.customLimits &&\r\n              this.defaultTransactionParams.customLimits.length > index ?\r\n              this.defaultTransactionParams.customLimits[index].storageLimit : this.defaultTransactionParams.storage;\r\n            if (this.beaconMode && this.operationRequest.operationDetails[index].parameters) {\r\n              console.log('Beacon param', this.operationRequest.operationDetails[index].parameters);\r\n              this.toMultipleDestinations.push({ to: singleSendDataArray[0], amount: Number(singleSendDataArray[1]), gasLimit, storageLimit, parameters: this.operationRequest.operationDetails[index].parameters });\r\n            } else {\r\n              this.toMultipleDestinations.push({ to: singleSendDataArray[0], amount: Number(singleSendDataArray[1]), gasLimit, storageLimit });\r\n            }\r\n          } else {\r\n            this.toMultipleDestinations = [];\r\n            validationError = singleSendDataCheckresult + '. Transaction ' + (index + 1);\r\n          }\r\n        } else if (singleSendDataArray.length === 1) {\r\n          validationError = this.translate.instant('SENDCOMPONENT.NOADDRESSORAMOUNT') + ' Transaction ' + (index + 1);\r\n        } else {\r\n          validationError = 'Expected semicolon after transaction ' + (index + 1);\r\n        }\r\n      }\r\n    });\r\n    if (!validationError && finalCheck && !this.batchSpace(this.toMultipleDestinations.length)) {\r\n      validationError = this.translate.instant('SENDCOMPONENT.TRANSACTIONSOVERFLOW');\r\n    }\r\n    return validationError;\r\n  }\r\n\r\n  totalAmount(): string {\r\n    let totalSent = Big(0);\r\n    for (const tx of this.transactions) {\r\n      totalSent = totalSent.add(tx.amount);\r\n    }\r\n    return totalSent.toFixed();\r\n  }\r\n  getTotalCost(display: boolean = false): string {\r\n    const totalFee = Big(this.getTotalFee()).plus(Big(this.getTotalBurn())).toString();\r\n    if (display && totalFee === '0') {\r\n      return '-';\r\n    }\r\n    return totalFee;\r\n  }\r\n  getTotalFee(): number {\r\n    if (this.fee !== '' && Number(this.fee)) {\r\n      return Number(this.fee);\r\n    }\r\n    return Number(this.defaultTransactionParams.fee);\r\n  }\r\n  getTotalBurn(): number {\r\n    if (this.storage !== '' && Number(this.storage)) {\r\n      return Number(Big(this.storage).mul(this.transactions.length).times(this.costPerByte).div(1000000).toString());\r\n    }\r\n    return this.defaultTransactionParams.burn;\r\n  }\r\n  toggleTransactions() {\r\n    if (this.showTransactions.length === 2) {\r\n      this.showTransactions = this.transactions;\r\n      this.showBtn = 'Show Less';\r\n    } else {\r\n      this.showTransactions = [];\r\n      this.showTransactions.push(this.transactions[0], this.transactions[1]);\r\n      this.showBtn = 'Show More';\r\n    }\r\n  }\r\n  dynSize(): string {\r\n    const size = this.amount ? this.amount.length : 0;\r\n    if (size < 7) {\r\n      return '5';\r\n    } else if (size < 9) {\r\n      return '4';\r\n    } else if (size < 12) {\r\n      return '3';\r\n    } else if (size < 17) {\r\n      return '2';\r\n    }\r\n    return '1.5';\r\n  }\r\n  async verifierChange() {\r\n    this.torusLookupAddress = '';\r\n    console.log('Verifier: ' + this.torusVerifier);\r\n    this.validateReceiverAddress();\r\n    // resimulate?\r\n  }\r\n  async torusLookup() {\r\n    if (!this.torusService.verifierMapKeys.includes(this.torusVerifier)) {\r\n      this.formInvalid = 'Invalid verifier';\r\n      console.log(this.torusService.verifierMapKeys);\r\n      console.log(this.torusVerifier);\r\n    } else if (this.toPkh) {\r\n      this.torusPendingLookup = true;\r\n      this.torusLookupId = this.toPkh;\r\n      const { pkh, twitterId } = await this.torusService.lookupPkh(this.torusVerifier, this.toPkh).catch(e => {\r\n        console.error(e);\r\n        this.formInvalid = e;\r\n        return '';\r\n      });\r\n      this.torusPendingLookup = false;\r\n      if (pkh) {\r\n        this.torusLookupAddress = pkh;\r\n        this.torusTwitterId = twitterId ? twitterId : '';\r\n        this.estimateFees();\r\n        console.log('Torus address', pkh);\r\n      } else {\r\n        this.torusLookupAddress = '';\r\n      }\r\n    }\r\n  }\r\n  torusReady(): boolean {\r\n    return (!this.torusPendingLookup && this.torusLookupAddress !== '');\r\n  }\r\n  clearTorus() {\r\n    this.torusVerifier = '';\r\n    this.torusPendingLookup = false;\r\n    this.torusLookupAddress = '';\r\n    this.torusLookupId = '';\r\n    this.torusTwitterId = '';\r\n  }\r\n  async torusNotification(transaction: SendData) {\r\n    if (transaction.meta) {\r\n      const amount = this.tokenService.formatAmount(this.tokenTransfer, transaction.amount.toString(), false);\r\n      if (transaction.meta.verifier === 'google') {\r\n        this.messageService.emailNotify(transaction.meta.alias, amount);\r\n        this.lookupService.add(transaction.to, transaction.meta.alias, 2);\r\n      } else if (transaction.meta.verifier === 'reddit') {\r\n        this.messageService.redditNotify(transaction.meta.alias, amount);\r\n        this.lookupService.add(transaction.to, transaction.meta.alias, 3);\r\n      } else if (transaction.meta.verifier === 'twitter') {\r\n        this.messageService.twitterNotify(transaction.meta.twitterId, transaction.meta.alias, amount);\r\n        this.lookupService.add(transaction.to, transaction.meta.alias, 4);\r\n      }\r\n    }\r\n  }\r\n  previewAttention(): string {\r\n    if (this.torusLookupId) {\r\n      if (!this.tokenTransfer && new Big(this.totalAmount()).gt('50')) {\r\n        let recipientKind = '';\r\n        switch (this.torusVerifier) {\r\n          case 'google':\r\n            recipientKind = 'Google account email address';\r\n            break;\r\n          case 'reddit':\r\n            recipientKind = 'Reddit username';\r\n            break;\r\n          case 'twitter':\r\n            recipientKind = 'Twitter handle';\r\n            break;\r\n          default:\r\n            recipientKind = 'information';\r\n        }\r\n        return `Carefully review the recipient's ${recipientKind}! Spelling mistakes can lead to permanent loss of the transferred funds.`;\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  getAssetName(short = true): string {\r\n    if (this.tokenTransfer) {\r\n      const token = this.tokenService.getAsset(this.tokenTransfer);\r\n      return short ? token.symbol : token.name;\r\n    } else {\r\n      return 'tez';\r\n    }\r\n  }\r\n  // Only Numbers with Decimals\r\n  keyPressNumbersDecimal(event, input) {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode !== 46 && charCode > 31\r\n      && (charCode < 48 || charCode > 57)) {\r\n      event.preventDefault();\r\n      return false;\r\n    } else if (charCode === 46) {\r\n      const meta = this.tokenTransfer ? this.tokenService.getAsset(this.tokenTransfer) : null;\r\n      if (this[input].includes('.') ||\r\n        (input === 'amount' && meta?.decimals === 0)) {\r\n        event.preventDefault();\r\n        return false;\r\n      } else if (this[input].length === 0) {\r\n        this[input] = '0' + this[input];\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n  parametersTextboxDisplay(): string {\r\n    return !this.parametersFormat ? this.micheline.value : JSON.stringify(this.parameters.value, null, 2);\r\n  }\r\n  setParametersFormat(id: number) {\r\n    this.parametersFormat = id;\r\n  }\r\n  getTitle() {\r\n    if (this.beaconMode && this.parameters?.entrypoint === 'mint') {\r\n      return 'Mint token';\r\n    }\r\n    return `Send ${this.getAssetName(false)}`;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { TorusService } from '../../services/torus/torus.service';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\n\r\nenum LookupType { // ordered in priority\r\n  AddressBook,\r\n  TezosDomains,\r\n  Google,\r\n  Reddit,\r\n  Twitter,\r\n  Alias\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class LookupService {\r\n  public records: { address: string, data: { name: string, lookupType: LookupType }[]}[] = [];\r\n  private pendingLookups: Record<string, boolean> = {};\r\n  constructor(\r\n    private operationService: OperationService,\r\n    private torusService: TorusService,\r\n    private walletService: WalletService,\r\n    private inputValidationService: InputValidationService\r\n  ) {\r\n    this.initCheck();\r\n  }\r\n  initCheck() {\r\n    if (!this.records.length &&\r\n      this.walletService.wallet &&\r\n      this.walletService.wallet.lookups.length) {\r\n        console.log('### Loading lookups from memory');\r\n        this.records = this.walletService.wallet.lookups;\r\n      }\r\n  }\r\n  add(address: string, name: string, lookupType: LookupType) {\r\n    console.log('#name', name);\r\n    const { x, y } = this.index(address, lookupType);\r\n    if (x !== -1) {\r\n      if (y === -1) {\r\n        this.records[x].data.push({ name, lookupType });\r\n      }\r\n    } else {\r\n      this.records.push({ address, data: [{ name, lookupType }]});\r\n    }\r\n    this.walletService.wallet.lookups = this.records;\r\n    this.walletService.storeWallet();\r\n  }\r\n  clear() {\r\n    this.records = [];\r\n    this.pendingLookups = {};\r\n  }\r\n  mark(address: string) {\r\n    const { x, y } = this.indexTop(address);\r\n    if (x === -1) {\r\n      this.records.push({ address, data: []});\r\n    }\r\n    this.walletService.storeWallet();\r\n  }\r\n  async check(address: string) {\r\n    this.initCheck();\r\n    if (address && address.slice(0, 3) === 'tz2') {\r\n      const { x } = this.index(address, 0);\r\n      if (!this.pendingLookups[address] && x === -1) {\r\n        this.pendingLookups[address] = true;\r\n        this.operationService.torusKeyLookup(address).subscribe(async (ans: any) => {\r\n          if (ans) {\r\n          if (\r\n            ans.result &&\r\n            ans.result.Verifiers\r\n          ) {\r\n            const keys = Object.keys(ans.result.Verifiers);\r\n            const verifierMap = this.torusService.verifierMap;\r\n            for (const key of keys) {\r\n              if (key === verifierMap['google'].verifier) {\r\n                this.add(address, ans.result.Verifiers[verifierMap['google'].verifier][0], LookupType.Google);\r\n              } else if (key === verifierMap['reddit'].verifier) {\r\n                this.add(address, ans.result.Verifiers[verifierMap['reddit'].verifier][0], LookupType.Reddit);\r\n              } else if (key === verifierMap['twitter'].verifier) {\r\n                const verifierId = ans.result.Verifiers[verifierMap['twitter'].verifier][0];\r\n                const verifierArray = verifierId.split('|');\r\n                if (verifierArray[0] === 'twitter' && this.inputValidationService.twitterId(verifierArray[1])) {\r\n                  const twitterId = verifierArray[1];\r\n                  const { username } = await this.torusService.twitterLookup(undefined, twitterId);\r\n                  if (username) {\r\n                    this.add(address, '@' + username, LookupType.Twitter);\r\n                  }\r\n                }\r\n              } else {\r\n                console.log('Unhandled verifier result', ans);\r\n              }\r\n            }\r\n            this.pendingLookups[address] = false;\r\n          } else if (!ans.noReveal) {\r\n            this.mark(address);\r\n          }\r\n          // Do nothing if tz2 haven't revealed pk\r\n        }\r\n        });\r\n      }\r\n    }\r\n  }\r\n  torusEntryExist(address: string): boolean {\r\n    const record = this.records[address];\r\n    if (record) {\r\n      for (const entry of record) {\r\n        if (entry.lookupType > 1) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  index(address: string, lookupType: LookupType) {\r\n    let [x, y] = Array(2).fill(-1);\r\n    for (let i = 0; i < this.records.length; i++) {\r\n      if (this.records[i].address === address) {\r\n        x = i;\r\n        for (let j = 0; j < this.records[i].data.length; j++) {\r\n          if (this.records[i].data[j].lookupType === lookupType) {\r\n            y = j;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { x, y };\r\n  }\r\n  indexTop(address: string) {\r\n    let [x, y] = Array(2).fill(-1);\r\n    for (let i = 0; i < this.records.length; i++) {\r\n      if (this.records[i].address === address) {\r\n        x = i;\r\n        for (let j = 0; j < this.records[i].data.length; j++) {\r\n          if (this.records[i].data[j].lookupType < y || y === -1) {\r\n            y = j;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { x, y };\r\n  }\r\n  resolve(party: any): any {\r\n    this.initCheck();\r\n    const { x, y } = this.indexTop(party.address);\r\n    if (x !== -1 && y !== -1) {\r\n      return { name: this.records[x].data[y].name, lookupType: this.records[x].data[y].lookupType, address: party.address };\r\n    } else if (party.alias) {\r\n      return { name: party.alias, lookupType: LookupType.Alias, address: party.address };\r\n    }\r\n    return { address: party.address };\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';  // Multiple instances created ?\r\nimport * as timediff from 'timediff';\r\n\r\n@Pipe({\r\n  name: 'timeAgo',\r\n  pure: true  // if false pipe will be called at each changes - necessary for translation - is there a better way?\r\n})\r\nexport class TimeAgoPipe implements PipeTransform {\r\n  constructor(\r\n    private translate: TranslateService\r\n  ) { }\r\n  transform(timestamp: number): string {\r\n\r\n    const now = this.translate.instant('TIMEAGOPIPE.JUSTNOW');\r\n    const sec = this.translate.instant('TIMEAGOPIPE.SEC');\r\n    const secs = sec;\r\n    const mn = this.translate.instant('TIMEAGOPIPE.MINUTE');\r\n    const mns = mn;\r\n    const hr = this.translate.instant('TIMEAGOPIPE.HOUR');\r\n    const hrs = this.translate.instant('TIMEAGOPIPE.HOURS');\r\n    const day = this.translate.instant('TIMEAGOPIPE.DAY');\r\n    const days = this.translate.instant('TIMEAGOPIPE.DAYS');\r\n    const month = this.translate.instant('TIMEAGOPIPE.MONTH');\r\n    const months = this.translate.instant('TIMEAGOPIPE.MONTHS');\r\n    const year = this.translate.instant('TIMEAGOPIPE.YEAR');\r\n    const years = this.translate.instant('TIMEAGOPIPE.YEARS');\r\n\r\n    const timeNow = new Date().getTime();\r\n    const diff = timediff(timestamp, timeNow, 'YMDHmS');\r\n\r\n    const keys = Object.keys(diff);\r\n    let count = 0;\r\n    let output = '';\r\n\r\n    for (const key of keys) {\r\n      if (diff[key] || count) {\r\n        if (count) {\r\n          output = output + ' ';\r\n        }\r\n        switch (key) {\r\n          case 'years':\r\n            output = `${diff[key]} ${diff[key] === 1 ? year : years}`;\r\n            break;\r\n          case 'months':\r\n            output = output + `${diff[key]} ${diff[key] === 1 ? month : months}`;\r\n            break;\r\n          case 'days':\r\n            output = output + `${diff[key]} ${diff[key] === 1 ? day : days}`;\r\n            break;\r\n          case 'hours':\r\n            output = output + `${diff[key]} ${diff[key] === 1 ? hr : hrs}`;\r\n            break;\r\n          case 'minutes':\r\n            output = output + `${diff[key]} ${diff[key] === 1 ? mn : mns}`;\r\n            break;\r\n          case 'seconds':\r\n            if (!diff.minutes && diff.seconds < 30) {\r\n              output = now;\r\n            } else if (diff.minutes < 2) {\r\n              output = output + `${diff[key]} ${diff[key] === 1 ? sec : secs}`;\r\n            }\r\n            break;\r\n        }\r\n        if (count++) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return output;\r\n  }\r\n}\r\n\r\n","var map = {\n\t\"./af\": \"K/tc\",\n\t\"./af.js\": \"K/tc\",\n\t\"./ar\": \"jnO4\",\n\t\"./ar-dz\": \"o1bE\",\n\t\"./ar-dz.js\": \"o1bE\",\n\t\"./ar-kw\": \"Qj4J\",\n\t\"./ar-kw.js\": \"Qj4J\",\n\t\"./ar-ly\": \"HP3h\",\n\t\"./ar-ly.js\": \"HP3h\",\n\t\"./ar-ma\": \"CoRJ\",\n\t\"./ar-ma.js\": \"CoRJ\",\n\t\"./ar-sa\": \"gjCT\",\n\t\"./ar-sa.js\": \"gjCT\",\n\t\"./ar-tn\": \"bYM6\",\n\t\"./ar-tn.js\": \"bYM6\",\n\t\"./ar.js\": \"jnO4\",\n\t\"./az\": \"SFxW\",\n\t\"./az.js\": \"SFxW\",\n\t\"./be\": \"H8ED\",\n\t\"./be.js\": \"H8ED\",\n\t\"./bg\": \"hKrs\",\n\t\"./bg.js\": \"hKrs\",\n\t\"./bm\": \"p/rL\",\n\t\"./bm.js\": \"p/rL\",\n\t\"./bn\": \"kEOa\",\n\t\"./bn.js\": \"kEOa\",\n\t\"./bo\": \"0mo+\",\n\t\"./bo.js\": \"0mo+\",\n\t\"./br\": \"aIdf\",\n\t\"./br.js\": \"aIdf\",\n\t\"./bs\": \"JVSJ\",\n\t\"./bs.js\": \"JVSJ\",\n\t\"./ca\": \"1xZ4\",\n\t\"./ca.js\": \"1xZ4\",\n\t\"./cs\": \"PA2r\",\n\t\"./cs.js\": \"PA2r\",\n\t\"./cv\": \"A+xa\",\n\t\"./cv.js\": \"A+xa\",\n\t\"./cy\": \"l5ep\",\n\t\"./cy.js\": \"l5ep\",\n\t\"./da\": \"DxQv\",\n\t\"./da.js\": \"DxQv\",\n\t\"./de\": \"tGlX\",\n\t\"./de-at\": \"s+uk\",\n\t\"./de-at.js\": \"s+uk\",\n\t\"./de-ch\": \"u3GI\",\n\t\"./de-ch.js\": \"u3GI\",\n\t\"./de.js\": \"tGlX\",\n\t\"./dv\": \"WYrj\",\n\t\"./dv.js\": \"WYrj\",\n\t\"./el\": \"jUeY\",\n\t\"./el.js\": \"jUeY\",\n\t\"./en-SG\": \"zavE\",\n\t\"./en-SG.js\": \"zavE\",\n\t\"./en-au\": \"Dmvi\",\n\t\"./en-au.js\": \"Dmvi\",\n\t\"./en-ca\": \"OIYi\",\n\t\"./en-ca.js\": \"OIYi\",\n\t\"./en-gb\": \"Oaa7\",\n\t\"./en-gb.js\": \"Oaa7\",\n\t\"./en-ie\": \"4dOw\",\n\t\"./en-ie.js\": \"4dOw\",\n\t\"./en-il\": \"czMo\",\n\t\"./en-il.js\": \"czMo\",\n\t\"./en-nz\": \"b1Dy\",\n\t\"./en-nz.js\": \"b1Dy\",\n\t\"./eo\": \"Zduo\",\n\t\"./eo.js\": \"Zduo\",\n\t\"./es\": \"iYuL\",\n\t\"./es-do\": \"CjzT\",\n\t\"./es-do.js\": \"CjzT\",\n\t\"./es-us\": \"Vclq\",\n\t\"./es-us.js\": \"Vclq\",\n\t\"./es.js\": \"iYuL\",\n\t\"./et\": \"7BjC\",\n\t\"./et.js\": \"7BjC\",\n\t\"./eu\": \"D/JM\",\n\t\"./eu.js\": \"D/JM\",\n\t\"./fa\": \"jfSC\",\n\t\"./fa.js\": \"jfSC\",\n\t\"./fi\": \"gekB\",\n\t\"./fi.js\": \"gekB\",\n\t\"./fo\": \"ByF4\",\n\t\"./fo.js\": \"ByF4\",\n\t\"./fr\": \"nyYc\",\n\t\"./fr-ca\": \"2fjn\",\n\t\"./fr-ca.js\": \"2fjn\",\n\t\"./fr-ch\": \"Dkky\",\n\t\"./fr-ch.js\": \"Dkky\",\n\t\"./fr.js\": \"nyYc\",\n\t\"./fy\": \"cRix\",\n\t\"./fy.js\": \"cRix\",\n\t\"./ga\": \"USCx\",\n\t\"./ga.js\": \"USCx\",\n\t\"./gd\": \"9rRi\",\n\t\"./gd.js\": \"9rRi\",\n\t\"./gl\": \"iEDd\",\n\t\"./gl.js\": \"iEDd\",\n\t\"./gom-latn\": \"DKr+\",\n\t\"./gom-latn.js\": \"DKr+\",\n\t\"./gu\": \"4MV3\",\n\t\"./gu.js\": \"4MV3\",\n\t\"./he\": \"x6pH\",\n\t\"./he.js\": \"x6pH\",\n\t\"./hi\": \"3E1r\",\n\t\"./hi.js\": \"3E1r\",\n\t\"./hr\": \"S6ln\",\n\t\"./hr.js\": \"S6ln\",\n\t\"./hu\": \"WxRl\",\n\t\"./hu.js\": \"WxRl\",\n\t\"./hy-am\": \"1rYy\",\n\t\"./hy-am.js\": \"1rYy\",\n\t\"./id\": \"UDhR\",\n\t\"./id.js\": \"UDhR\",\n\t\"./is\": \"BVg3\",\n\t\"./is.js\": \"BVg3\",\n\t\"./it\": \"bpih\",\n\t\"./it-ch\": \"bxKX\",\n\t\"./it-ch.js\": \"bxKX\",\n\t\"./it.js\": \"bpih\",\n\t\"./ja\": \"B55N\",\n\t\"./ja.js\": \"B55N\",\n\t\"./jv\": \"tUCv\",\n\t\"./jv.js\": \"tUCv\",\n\t\"./ka\": \"IBtZ\",\n\t\"./ka.js\": \"IBtZ\",\n\t\"./kk\": \"bXm7\",\n\t\"./kk.js\": \"bXm7\",\n\t\"./km\": \"6B0Y\",\n\t\"./km.js\": \"6B0Y\",\n\t\"./kn\": \"PpIw\",\n\t\"./kn.js\": \"PpIw\",\n\t\"./ko\": \"Ivi+\",\n\t\"./ko.js\": \"Ivi+\",\n\t\"./ku\": \"JCF/\",\n\t\"./ku.js\": \"JCF/\",\n\t\"./ky\": \"lgnt\",\n\t\"./ky.js\": \"lgnt\",\n\t\"./lb\": \"RAwQ\",\n\t\"./lb.js\": \"RAwQ\",\n\t\"./lo\": \"sp3z\",\n\t\"./lo.js\": \"sp3z\",\n\t\"./lt\": \"JvlW\",\n\t\"./lt.js\": \"JvlW\",\n\t\"./lv\": \"uXwI\",\n\t\"./lv.js\": \"uXwI\",\n\t\"./me\": \"KTz0\",\n\t\"./me.js\": \"KTz0\",\n\t\"./mi\": \"aIsn\",\n\t\"./mi.js\": \"aIsn\",\n\t\"./mk\": \"aQkU\",\n\t\"./mk.js\": \"aQkU\",\n\t\"./ml\": \"AvvY\",\n\t\"./ml.js\": \"AvvY\",\n\t\"./mn\": \"lYtQ\",\n\t\"./mn.js\": \"lYtQ\",\n\t\"./mr\": \"Ob0Z\",\n\t\"./mr.js\": \"Ob0Z\",\n\t\"./ms\": \"6+QB\",\n\t\"./ms-my\": \"ZAMP\",\n\t\"./ms-my.js\": \"ZAMP\",\n\t\"./ms.js\": \"6+QB\",\n\t\"./mt\": \"G0Uy\",\n\t\"./mt.js\": \"G0Uy\",\n\t\"./my\": \"honF\",\n\t\"./my.js\": \"honF\",\n\t\"./nb\": \"bOMt\",\n\t\"./nb.js\": \"bOMt\",\n\t\"./ne\": \"OjkT\",\n\t\"./ne.js\": \"OjkT\",\n\t\"./nl\": \"+s0g\",\n\t\"./nl-be\": \"2ykv\",\n\t\"./nl-be.js\": \"2ykv\",\n\t\"./nl.js\": \"+s0g\",\n\t\"./nn\": \"uEye\",\n\t\"./nn.js\": \"uEye\",\n\t\"./pa-in\": \"8/+R\",\n\t\"./pa-in.js\": \"8/+R\",\n\t\"./pl\": \"jVdC\",\n\t\"./pl.js\": \"jVdC\",\n\t\"./pt\": \"8mBD\",\n\t\"./pt-br\": \"0tRk\",\n\t\"./pt-br.js\": \"0tRk\",\n\t\"./pt.js\": \"8mBD\",\n\t\"./ro\": \"lyxo\",\n\t\"./ro.js\": \"lyxo\",\n\t\"./ru\": \"lXzo\",\n\t\"./ru.js\": \"lXzo\",\n\t\"./sd\": \"Z4QM\",\n\t\"./sd.js\": \"Z4QM\",\n\t\"./se\": \"//9w\",\n\t\"./se.js\": \"//9w\",\n\t\"./si\": \"7aV9\",\n\t\"./si.js\": \"7aV9\",\n\t\"./sk\": \"e+ae\",\n\t\"./sk.js\": \"e+ae\",\n\t\"./sl\": \"gVVK\",\n\t\"./sl.js\": \"gVVK\",\n\t\"./sq\": \"yPMs\",\n\t\"./sq.js\": \"yPMs\",\n\t\"./sr\": \"zx6S\",\n\t\"./sr-cyrl\": \"E+lV\",\n\t\"./sr-cyrl.js\": \"E+lV\",\n\t\"./sr.js\": \"zx6S\",\n\t\"./ss\": \"Ur1D\",\n\t\"./ss.js\": \"Ur1D\",\n\t\"./sv\": \"X709\",\n\t\"./sv.js\": \"X709\",\n\t\"./sw\": \"dNwA\",\n\t\"./sw.js\": \"dNwA\",\n\t\"./ta\": \"PeUW\",\n\t\"./ta.js\": \"PeUW\",\n\t\"./te\": \"XLvN\",\n\t\"./te.js\": \"XLvN\",\n\t\"./tet\": \"V2x9\",\n\t\"./tet.js\": \"V2x9\",\n\t\"./tg\": \"Oxv6\",\n\t\"./tg.js\": \"Oxv6\",\n\t\"./th\": \"EOgW\",\n\t\"./th.js\": \"EOgW\",\n\t\"./tl-ph\": \"Dzi0\",\n\t\"./tl-ph.js\": \"Dzi0\",\n\t\"./tlh\": \"z3Vd\",\n\t\"./tlh.js\": \"z3Vd\",\n\t\"./tr\": \"DoHr\",\n\t\"./tr.js\": \"DoHr\",\n\t\"./tzl\": \"z1FC\",\n\t\"./tzl.js\": \"z1FC\",\n\t\"./tzm\": \"wQk9\",\n\t\"./tzm-latn\": \"tT3J\",\n\t\"./tzm-latn.js\": \"tT3J\",\n\t\"./tzm.js\": \"wQk9\",\n\t\"./ug-cn\": \"YRex\",\n\t\"./ug-cn.js\": \"YRex\",\n\t\"./uk\": \"raLr\",\n\t\"./uk.js\": \"raLr\",\n\t\"./ur\": \"UpQW\",\n\t\"./ur.js\": \"UpQW\",\n\t\"./uz\": \"Loxo\",\n\t\"./uz-latn\": \"AQ68\",\n\t\"./uz-latn.js\": \"AQ68\",\n\t\"./uz.js\": \"Loxo\",\n\t\"./vi\": \"KSF8\",\n\t\"./vi.js\": \"KSF8\",\n\t\"./x-pseudo\": \"/X5v\",\n\t\"./x-pseudo.js\": \"/X5v\",\n\t\"./yo\": \"fzPg\",\n\t\"./yo.js\": \"fzPg\",\n\t\"./zh-cn\": \"XDpg\",\n\t\"./zh-cn.js\": \"XDpg\",\n\t\"./zh-hk\": \"SatO\",\n\t\"./zh-hk.js\": \"SatO\",\n\t\"./zh-tw\": \"kOpN\",\n\t\"./zh-tw.js\": \"kOpN\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"RnhZ\";","import { Component, OnInit, HostListener, ViewChild } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport * as copy from 'copy-to-clipboard';\r\nimport { TranslateService } from '@ngx-translate/core'; // Multiple instances created ?\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport {\r\n  ImplicitAccount,\r\n  OriginatedAccount,\r\n  Account,\r\n  HdWallet,\r\n} from '../../services/wallet/wallet';\r\n\r\n@Component({\r\n  selector: 'app-accounts',\r\n  templateUrl: './accounts.component.html',\r\n  styleUrls: ['./accounts.component.scss']\r\n})\r\nexport class AccountsComponent implements OnInit {\r\n  wideAccounts = false;\r\n  implicitAccounts: ImplicitAccount[];\r\n  constructor(\r\n    public walletService: WalletService,\r\n    private router: Router,\r\n    private translate: TranslateService,\r\n    private messageService: MessageService,\r\n    private coordinatorService: CoordinatorService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    if (!this.walletService.wallet) {\r\n      this.router.navigate(['']);\r\n    } else {\r\n      this.onResize();\r\n      this.coordinatorService.startAll();\r\n      this.implicitAccounts = this.walletService.wallet.implicitAccounts;\r\n    }\r\n  }\r\n  copy(account: Account) {\r\n    copy(account.address);\r\n    const copyToClipboard = this.translate.instant(\r\n      'OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD'\r\n    );\r\n    this.messageService.add(account.address + ' ' + copyToClipboard, 5);\r\n  }\r\n  select(account: Account) {\r\n    this.router.navigate(['account', account.address]);\r\n  }\r\n  @HostListener('window:resize')\r\n  onResize() {\r\n    this.wideAccounts = (window.innerWidth > 640);\r\n  }\r\n  formatAddress(account: Account) {\r\n    if (this.wideAccounts) {\r\n      return account.address;\r\n    } else {\r\n      return account.shortAddress();\r\n    }\r\n  }\r\n}\r\n","<app-header></app-header>\r\n<div id=\"wrapper\" *ngIf=\"walletService.wallet\">\r\n    <div class=\"main-container\">\r\n        <div id=\"top-container\">\r\n            <span id=\"title\">Accounts</span>\r\n            <app-new-implicit></app-new-implicit>\r\n        </div>\r\n        <div id=\"accounts-container\">\r\n            <ng-container *ngFor=\"let impAcc of implicitAccounts\">\r\n                <div class=\"account-container account-row\" (click)=\"select(impAcc)\">\r\n                    <div>\r\n                        <img class=\"account-icon\" src=\"../../../assets/img/account-icon.svg\">\r\n                        <span class=\"account-address\">{{ formatAddress(impAcc) }}</span>\r\n                        <img class=\"copy-icon\" src=\"../../../assets/img/copy-icon.svg\" (click)=\"$event.stopPropagation() ; copy(impAcc)\">\r\n                    </div>\r\n                    <div class=\"value-container\">\r\n                        <div class=\"values\">\r\n                            <span class=\"account-xtz\">{{ impAcc.balanceXTZ / 1000000 | number: \"1.0-6\"}} tez</span>\r\n                            <span *ngIf=\"impAcc.balanceXTZ\" class=\"account-usd\">{{ impAcc.balanceUSD | number: \"1.0-0\" }} USD</span>\r\n                        </div>\r\n                        <div>\r\n                        <!-- Todo: Add menu\r\n                            <img class=\"menu-icon\" src=\"../../../assets/img/menu-icon.svg\" (click)=\"$event.stopPropagation()\">\r\n                        -->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"seperator\"></div>\r\n                <ng-container *ngFor=\"let origAcc of impAcc.originatedAccounts\">\r\n                    <div class=\"account-container account-row\" (click)=\"select(origAcc)\">\r\n                        <div>\r\n                            <img class=\"account-icon\" src=\"../../../assets/img/account-icon.svg\">\r\n                            <span class=\"account-address\">{{ formatAddress(origAcc) }}</span>\r\n                            <img class=\"copy-icon\" src=\"../../../assets/img/copy-icon.svg\" (click)=\"$event.stopPropagation() ; copy(origAcc)\">\r\n                        </div>\r\n                        <div class=\"value-container\">\r\n                            <div class=\"values\">\r\n                                <span class=\"account-xtz\">{{ origAcc.balanceXTZ / 1000000 | number: \"1.0-6\"}} tez</span>\r\n                                <span *ngIf=\"origAcc.balanceXTZ\" class=\"account-usd\">{{ origAcc.balanceUSD | number: \"1.0-0\" }} USD</span>\r\n                            </div>\r\n                            <div>\r\n                            <!--\r\n                                <img class=\"menu-icon\" src=\"../../../assets/img/menu-icon.svg\" (click)=\"$event.stopPropagation()\">  \r\n                            -->\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"seperator\"></div>\r\n                </ng-container>\r\n            </ng-container>\r\n            <div class=\"account-container value-total\">\r\n                <div class=\"value-container\">\r\n                    <div class=\"values\">\r\n                        <span class=\"account-xtz\">{{ walletService.wallet.totalBalanceXTZ / 1000000 | number: \"1.0-6\"}} tez</span>\r\n                        <span class=\"account-usd\">{{ walletService.wallet.totalBalanceUSD | number: \"1.0-0\" }} USD</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div *ngIf=\"!walletService.wallet\">Need to be logged in to view this page</div>","import { Component, OnInit, Input, EventEmitter, Output, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n@Component({\r\n  selector: 'app-permission-request',\r\n  templateUrl: './permission-request.component.html',\r\n  styleUrls: ['./permission-request.component.scss']\r\n})\r\nexport class PermissionRequestComponent implements OnInit, OnChanges {\r\n  @Input() permissionRequest: any;\r\n  @Output() permissionResponse = new EventEmitter();\r\n  selectedAccount: string;\r\n  constructor(\r\n    public walletService: WalletService,\r\n    private messageService: MessageService\r\n  ) { }\r\n  ngOnInit(): void {\r\n    if (this.walletService.wallet) {\r\n      this.selectedAccount = this.walletService.wallet.implicitAccounts[0].address;\r\n    }\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    console.log(changes);\r\n    if (this.permissionRequest) {\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflow = 'hidden';\r\n      this.messageService.removeBeaconMsg(true);\r\n    }\r\n  }\r\n  rejectPermissions() {\r\n    this.permissionResponse.emit(null);\r\n    this.reset();\r\n  }\r\n  grantPermissions() {\r\n    console.log(this.selectedAccount);\r\n    const pk = this.walletService.wallet.getImplicitAccount(this.selectedAccount).pk;\r\n    this.permissionResponse.emit(pk);\r\n    this.reset();\r\n  }\r\n  reset() {\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.permissionRequest = null;\r\n  }\r\n  scopeToText(scope: string) {\r\n    if (scope === 'sign') {\r\n      return 'Request other signing';\r\n    } else if (scope === 'operation_request') {\r\n      return 'Request operation signing';\r\n    }\r\n    return scope;\r\n  }\r\n}\r\n","<div *ngIf=\"permissionRequest\" id=\"myModal\" class=\"kukai-modal top\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"rejectPermissions()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1>Permission Request</H1>\r\n    </div>\r\n    <!-- Request -->\r\n    <div class=\"km-body\">\r\n      <p>{{ permissionRequest.appMetadata.name }} wants the following permissions:</p>\r\n      <ul>\r\n        <li *ngFor=\"let scope of permissionRequest.scopes\">{{ scopeToText(scope) }}</li>\r\n      </ul>\r\n      <p>Select an account the permissions should be applied to:</p>\r\n      <select class=\"select-css\" [(ngModel)]=\"selectedAccount\">\r\n        <ng-container *ngFor=\"let acc of walletService.wallet.implicitAccounts\">\r\n          <option value=\"{{ acc.address }}\">{{ acc.pkh }}</option>\r\n        </ng-container>\r\n      </select>\r\n      <div class=\"row-group\" style=\"margin: 1.25rem 0 1.5rem;\">\r\n        <button  class=\"blue confirm\" (click)=\"grantPermissions()\">Approve</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","<router-outlet></router-outlet>\r\n<app-messages></app-messages>\r\n<app-spinner></app-spinner>\r\n<app-agreement *ngIf=\"!embedded\"></app-agreement>\r\n<app-footer *ngIf=\"!embedded\"></app-footer>","import { Component, OnInit } from '@angular/core';\r\nimport { Router, Event, NavigationEnd } from '@angular/router';\r\nimport { WalletService } from './services/wallet/wallet.service';\r\nimport { CoordinatorService } from './services/coordinator/coordinator.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Location } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss'],\r\n  // // tslint:disable-next-line\r\n  // selector: 'body',\r\n  // template: '<router-outlet></router-outlet>'\r\n})\r\nexport class AppComponent implements OnInit {\r\n  embedded = false;\r\n  constructor(\r\n    private walletService: WalletService,\r\n    private coordinatorService: CoordinatorService,\r\n    private router: Router,\r\n    public translate: TranslateService,\r\n    private location: Location\r\n\r\n  ) {\r\n\r\n    // this language will be used as a fallback when a translation isn't found in the current language\r\n    translate.setDefaultLang('en');\r\n\r\n      // the lang to use, if the lang isn't available, it will use the current loader to get them\r\n      const languagePreference = window.localStorage.getItem('languagePreference');\r\n      const browserLang = translate.getBrowserLang();\r\n      translate.use('en');\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.checkEmbedded();\r\n    if (!this.embedded) {\r\n      this.walletService.loadStoredWallet();\r\n      if (this.walletService.wallet) {\r\n        this.coordinatorService.startAll();\r\n      }\r\n    }\r\n    this.router.events.subscribe((event: Event) => {\r\n      if (event instanceof NavigationEnd) {\r\n        this.checkEmbedded();\r\n        window.scrollTo(0, 0);\r\n      }\r\n    });\r\n    window.addEventListener('storage', (e) => { this.handleStorageEvent(e); });\r\n  }\r\n  private handleStorageEvent(e: StorageEvent) {\r\n    if (e.key === 'kukai-wallet') {\r\n      if (e.oldValue && !e.newValue) {\r\n        window.location.reload();\r\n      } else if (!e.oldValue && e.newValue) {\r\n        setTimeout(async () => {\r\n          await this.router.navigate(['']);\r\n          window.location.reload();\r\n        }, 10000);\r\n      }\r\n    }\r\n  }\r\n  returnLanguage(lang: string) {\r\n\r\n    // this.translate.use(lang);\r\n    // console.log('lang ', lang);\r\n\r\n    const map: Map<string, string> = new Map([\r\n      ['en', 'English'],\r\n      ['cn', '中国'],\r\n      ['es', 'Español'],\r\n      ['fr', 'Français'],\r\n      ['ru', 'Pусский'],\r\n      ['jp', '日本語'],\r\n      ['kor', '한국어'],\r\n      ['por', 'Português'],\r\n      ['swe', 'Svenska']\r\n    ]);\r\n\r\n    const language = map.get(lang);\r\n\r\n    return language;\r\n  }\r\n  checkEmbedded() {\r\n    const path = this.location.path();\r\n    this.embedded = path.startsWith('/embedded');\r\n  }\r\n  setLanguage(lang) {\r\n    window.localStorage.setItem('languagePreference', lang);\r\n    this.translate.use(lang);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport * as pbkdf2 from 'pbkdf2';\r\nimport * as AES from 'aes-js';\r\nimport * as scrypt from 'scryptsy';\r\nimport * as cryptob from 'crypto-browserify';\r\nimport * as forge from 'node-forge';\r\nimport { rejects } from 'assert';\r\ndeclare const Buffer;\r\n@Injectable()\r\nexport class EncryptionService {\r\n  constructor() { }\r\n  async encrypt(plaintext: any, password: string, version: number, salt: string = null): Promise<any> {\r\n    if (version === 1) {\r\n      throw new Error('Encryption version no longer supported');\r\n    } else if (version === 2) {\r\n      return this.encrypt_v2(plaintext, password);\r\n    } else if (version === 3) {\r\n      return this.encrypt_v2(plaintext, password, salt);\r\n    } else {\r\n      throw new Error('Unrecognized encryption format');\r\n    }\r\n  }\r\n  async decrypt(chiphertext: string, password: string, salt: string, version: number): Promise<any> {\r\n    if (version === 1) {\r\n      return this.decrypt_v1(chiphertext, password, salt);\r\n    } else if (version === 2 || version === 3) {\r\n      return this.decrypt_v2(chiphertext, password, salt);\r\n    } else {\r\n      throw new Error('Unrecognized encryption format');\r\n    }\r\n  }\r\n  // Version 1\r\n  async encrypt_v1(plaintext: any, password: string, salt: string): Promise<string> {\r\n    return new Promise(resolve => {\r\n      try {\r\n        if (!password || !salt) {\r\n          throw new Error('Missing password or salt');\r\n        }\r\n        pbkdf2.pbkdf2(password, salt, 10000, 32, 'sha512', (err, key) => {\r\n          if (err) {\r\n            throw (err);\r\n          }\r\n          const aesCtr = new AES.ModeOfOperation.ctr(key);\r\n          let chiphertext = aesCtr.encrypt(plaintext);\r\n          chiphertext = AES.utils.hex.fromBytes(chiphertext);\r\n          resolve(chiphertext);\r\n        });\r\n      } catch (e) {\r\n        console.warn(e);\r\n        resolve('');\r\n      }\r\n    });\r\n  }\r\n  async decrypt_v1(chiphertext: string, password: string, salt: string): Promise<any> {\r\n    return new Promise(resolve => {\r\n      try {\r\n        if (!password || !salt) {\r\n          throw new Error('Missing password or salt');\r\n        }\r\n        pbkdf2.pbkdf2(password, salt, 10000, 32, 'sha512', (err, key) => {\r\n          if (err) {\r\n            throw (err);\r\n          }\r\n          chiphertext = AES.utils.hex.toBytes(chiphertext);\r\n          const aesCtr = new AES.ModeOfOperation.ctr(key);\r\n          const plaintext = aesCtr.decrypt(chiphertext);\r\n          resolve(plaintext);\r\n        });\r\n      } catch (e) {\r\n        resolve('');\r\n      }\r\n    });\r\n  }\r\n  // Version 2\r\n  async encrypt_v2(plaintext: any, password: string, salt?: string): Promise<any> {\r\n    if (!password) {\r\n      throw new Error('Missing password');\r\n    }\r\n    let salty;\r\n    if (salt) {\r\n      salty = new Buffer(salt, 'hex');\r\n    } else {\r\n      salty = cryptob.randomBytes(16);\r\n    }\r\n    const key = await scrypt.async(password, salty, 65536, 8, 1, 32);\r\n    const cipher: any = forge.cipher.createCipher('AES-GCM', key.toString('binary'));\r\n    cipher.start({\r\n      iv: salty,\r\n    });\r\n    const byteStringBuffer = forge.util.createBuffer(plaintext.toString('binary'), 'utf-8');\r\n    cipher.update(byteStringBuffer);\r\n    cipher.finish();\r\n    const chiphertext = cipher.output.toHex() + '==' + cipher.mode.tag.toHex();\r\n    return { chiphertext: chiphertext, iv: salty.toString('hex') };\r\n  }\r\n  async decrypt_v2(chipher: string, password: string, salt: string): Promise<string> {\r\n    try {\r\n      if (!password || !salt) {\r\n        throw new Error('Missing password or salt');\r\n      }\r\n      const parts = chipher.split('==');\r\n      const chiphertext = parts[0];\r\n      const tag = parts[1];\r\n      const key = await scrypt.async(password, new Buffer(salt, 'hex'), 65536, 8, 1, 32);\r\n      const decipher: any = forge.cipher.createDecipher('AES-GCM', key.toString('binary'));\r\n      decipher.start({\r\n        iv: new Buffer(salt, 'hex'),\r\n        tag: forge.util.createBuffer((new Buffer(tag, 'hex')).toString('binary'), 'utf-8'), // authentication tag from encryption\r\n      });\r\n      decipher.update(forge.util.createBuffer((new Buffer(chiphertext, 'hex')).toString('binary'), 'utf-8'));\r\n      const pass = decipher.finish();\r\n      if (pass) {\r\n        return new Buffer(decipher.output.toHex(), 'hex');\r\n      } else {\r\n        return null;\r\n      }\r\n    } catch (err) {\r\n      return null;\r\n    }\r\n  }\r\n  bumpIV(salt: string, bumps: number) {\r\n    if (bumps > 255) {\r\n      throw new Error('Invalid incremention');\r\n    }\r\n    const buf = new Buffer(salt, 'hex');\r\n    buf[13] = (buf[13] + 1) % 256;\r\n    return buf.toString('hex');\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { utils, hd } from '@tezos-core-tools/crypto-utils';\r\nimport * as zxcvbn from 'zxcvbn';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { TorusWallet } from '../wallet/wallet';\r\n\r\n@Injectable()\r\nexport class InputValidationService {\r\n\r\n  constructor(\r\n    private operationService: OperationService,\r\n    private translate: TranslateService\r\n  ) { }\r\n  /*\r\n    Input validations\r\n  */\r\n  mnemonics(mnemonics: string): boolean {\r\n    return this.operationService.validMnemonic(mnemonics);\r\n  }\r\n  password(password: string): boolean {\r\n    return (zxcvbn(password).score === 4);\r\n  }\r\n  passwordStrengthDisplay(password: string): string {\r\n    if (!password) {\r\n      return '';\r\n    }\r\n    switch (zxcvbn(password).score) {\r\n      case 0: {\r\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.CATASTROPHIC');  // 'Catastrophic!'\r\n      } case 1: {\r\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.VERYWEAK');  // 'Very weak!'\r\n      } case 2: {\r\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.WEAK');  // 'Weak!'\r\n      } case 3: {\r\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.WEAK');  // 'Weak!'\r\n      } case 4: {\r\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.STRONG');  // 'Strong!'\r\n      } default: {\r\n        return '';\r\n      }\r\n    }\r\n  }\r\n  address(address: string): Boolean {\r\n    return this.operationService.validAddress(address);\r\n  }\r\n  torusAccount(verifierId: string, loginType: string): Boolean {\r\n    switch (loginType) {\r\n      case 'google':\r\n        return this.email(verifierId);\r\n      case 'reddit':\r\n        return this.redditAccount(verifierId);\r\n      case 'twitter':\r\n        return this.twitterAccount(verifierId);\r\n      default:\r\n        return false;\r\n    }\r\n\r\n  }\r\n  redditAccount(username: string) {\r\n    // Letters, numbers, dashes, and underscores only\r\n    // Username must be between 3 and 20 characters\r\n    const re = /^[0-9a-zA-Z\\-\\_]{3,20}$/;\r\n    return re.test(username);\r\n  }\r\n  email(email: string): Boolean {\r\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    return re.test(email);\r\n  }\r\n  twitterAccount(username: string) {\r\n    // The only characters you can use are uppercase and lowercase letters, numbers, and the underscore character ( _ ).\r\n    const re = /^\\@{1}[0-9a-zA-Z\\_]{1,15}$/;\r\n    return re.test(username);\r\n  }\r\n  twitterId(id: string) {\r\n    const re = /^[0-9]+$/;\r\n    return re.test(id);\r\n  }\r\n  passphrase(passphrase: string): Boolean {\r\n    return true;\r\n  }\r\n  amount(amount: string, decimals: number = 6): Boolean {\r\n    const decimalsPart = decimals ? `(\\.[0-9]{1,${decimals}}){0,1}` : '';\r\n    const expr = new RegExp(`^(0|[1-9][0-9]{0,8})${decimalsPart}$`, 'g');\r\n    if (amount === '' || amount === '0') { // default value / zero\r\n      return true;\r\n    } else if (Number(amount) && amount.match(expr)) { // Positive number\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  fee(fee: string): Boolean {\r\n    return this.amount(fee); // same as amount\r\n  }\r\n  gas(amount: string): Boolean {\r\n    if (amount === '' || amount === '0') { // default value / zero\r\n      return true;\r\n    } else if (Number(amount) && 0 < Number(amount) && Number(amount) % 1 === 0) { // Positive integer\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  storage(amount: string) {\r\n    return this.gas(amount);\r\n  }\r\n  code(code: string): Boolean {\r\n    if (code && code.length === 40 && code.match(/^[0-9a-f]*$/g)) { // 40 hex chars\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  derivationPath(path: string): Boolean {\r\n    const m = path.match(/^44\\'\\/1729(\\'\\/[0-9]+)+\\'$/g);\r\n    if (m || path === '44\\'/1729\\'') {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n  hexString(hex: string): Boolean {\r\n    if (hex && hex.match(/^[a-f0-9]*$/)) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  isMessageSigning(payload: string): boolean {\r\n    if (payload.match(/^0501[a-f0-9]{8}54657a6f73205369676e6564204d6573736167653a20[a-f0-9]*$/)) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-terms-of-use',\r\n  templateUrl: './terms-of-use.component.html',\r\n  styleUrls: ['./terms-of-use.component.scss']\r\n})\r\nexport class TermsOfUseComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"legal\">\r\n  <H1>TERMS OF USE</H1>\r\n  <p><i>Last Updated: June 30, 2020</i></p>\r\n  <p>IMPORTANT NOTICE: THIS AGREEMENT IS SUBJECT TO BINDING ARBITRATION AND A WAIVER OF CLASS ACTION RIGHTS AS DETAILED\r\n    IN SECTION 13. PLEASE READ THE AGREEMENT CAREFULLY.</p>\r\n\r\n  <H4>1. Acceptance of terms</H4>\r\n  <p>Kukai Wallet (hereinafter “Kukai,” “we,” “us,” or “our”) provides a platform for managing Tezos accounts, and\r\n    allowing ordinary websites and applications to interact with the blockchain network, while keeping the user in\r\n    control over what transactions they approve, through our website located at https://kukai.app/ (the “Site”), which\r\n    includes text, images, audio, code and other materials (collectively, the “Content”) and all of the features, and\r\n    services provided. The Site and any other features, tools, materials, or other services offered from time to time by\r\n    Kukai Wallet are referred to here as the “Services.” Please read these Terms of Use (the “Terms”) carefully before\r\n    using the Services. By using or otherwise accessing the Services, or clicking to accept or agree to these Terms\r\n    where that option is made available, you (1) accept and agree to these Terms, (2) consent to the collection, use,\r\n    disclosure and other handling of information as described in our Privacy Policy and (3) agree to any additional\r\n    terms, rules and conditions of participation issued by Kukai Wallet from time to time. If you do not agree to any of\r\n    the Terms, then you may not access or use the Content or Services.</p>\r\n\r\n  <H4>2. Modification of Terms of Use</H4>\r\n  <p>Except for Section 13, providing for arbitration and waiver of class action rights, Kukai Wallet reserves the\r\n    right, at its sole discretion, to modify or replace the Terms at any time without notice. We will always try to\r\n    provide advance notice, however, we reserve the right to modify or replace the Terms at our discretion. The most\r\n    current version of these Terms will be posted on our Site. You shall be responsible for reviewing and becoming\r\n    familiar with any such modifications. Use of the Services by you after any modification to the Terms constitutes\r\n    your acceptance of the Terms as modified.</p>\r\n\r\n  <H4>3. Eligibility</H4>\r\n  <p>You hereby represent and warrant that you are fully able and competent to enter into the terms, conditions,\r\n    obligations, affirmations, representations and warranties set forth in these Terms and to abide by and comply with\r\n    these Terms.</p>\r\n\r\n  <p>Kukai Wallet is a global platform and by accessing the Content or Services, you are representing and warranting\r\n    that you are of the legal age of majority in your jurisdiction as is required to access such Services and Content\r\n    and enter into arrangements as provided by the Services. You further represent that you are otherwise legally\r\n    permitted to use the service in your jurisdiction including owning cryptographic tokens of value, and interacting\r\n    with the Services or Content in any way. You further represent you are responsible for ensuring compliance with the\r\n    laws of your jurisdiction and acknowledge that Kukai Wallet is not liable for your compliance with such laws.</p>\r\n\r\n  <p>In addition, you represent to us that you and your financial institutions, or any party that owns or controls you\r\n    or your financial institutions, are (1) not subject to sanctions or otherwise designated on any list of prohibited\r\n    or restricted parties, including but not limited to the lists maintained by the United Nations Security Council, the\r\n    U.S. Government (e.g., the Specially Designated Nationals List and Foreign Sanctions Evaders List of the U.S.\r\n    Department of Treasury and the Entity List of the U.S. Department of Commerce), the European Union or its Member\r\n    States, or other applicable government authority and (2) not located in any country to which the United States has\r\n    embargoed goods or has otherwise applied any sanctions.</p>\r\n\r\n  <H4>4. Account Password and Security</H4>\r\n  <p>When setting up an account within Kukai Wallet, you will be responsible for keeping your own account secrets, which\r\n    may be a word seed phrase, an account file, or other locally stored secret information. Kukai Wallet encrypts this\r\n    information locally with a password you provide, that we never send to our servers. You agree to (a) never use the\r\n    same password for Kukai Wallet that you have ever used outside of this service, (b) keep your secret information and\r\n    password confidential and do not share them with anyone else and (c) immediately notify Kukai Wallet of any\r\n    unauthorized use of your account or breach of security. Kukai Wallet cannot and will not be liable for any loss or\r\n    damage arising from your failure to comply with this section.\r\n\r\n  <H4>5. DISCLAIMERS- RISKS</H4>\r\n\r\n  <H5>5.1. Warranty Disclaimer</H5>\r\n  <p>You expressly understand and agree that your use of the Services is at your sole risk. The Services (including the\r\n    Site and the Content) are provided on an “as is” and “as available” basis, without warranties of any kind, either\r\n    express or implied, including, without limitation, implied warranties of merchantability, fitness for a particular\r\n    purpose or non-infringement. You acknowledge that Kukai Wallet has no control over, and no duty to take any action\r\n    regarding: which users gain access to or use the Services; what effects the Content may have on you; how you may\r\n    interpret or use the Content; or what actions you may take as a result of having been exposed to the Content. You\r\n    release Kukai Wallet from any and all liability for you having acquired or not acquired Content through the\r\n    Services. Kukai Wallet makes no representations concerning any Content contained in or accessed through the\r\n    Services, and Kukai Wallet will not be responsible or liable for the accuracy, copyright compliance, legality or\r\n    decency of material contained in or accessed through the Services.</p>\r\n\r\n  <p>We do not represent or warrant that access to the Services will be continuous, uninterrupted, timely or secure. You\r\n    acknowledge and accept that the Services (a) may contain bugs, errors and defects, (b) may function improperly or be\r\n    subject to periods of downtime and unavailability, (c) may result in total or partial loss or corruption of data and\r\n    (d) may be modified at any time, including through the release of subsequent versions, all with or without notice to\r\n    you.</p>\r\n\r\n  <p>You acknowledge that Kukai Wallet is not responsible for transferring, safeguarding, or maintaining your private\r\n    keys or any digital currency associated therewith. If you lose, mishandle or have stolen associated digital currency\r\n    private keys, you acknowledge that you may not be able to recover associated digital currency, and that Kukai Wallet\r\n    is not responsible for such loss. You acknowledge that Kukai Wallet is not responsible for any loss, damage or\r\n    liability arising from your failure to comply with the terms hereunder.</p>\r\n\r\n  <H5>5.2 Sophistication and Risk of Cryptographic Systems</H5>\r\n  <p>By utilizing the Services or interacting with the Content or platform in any way, you represent that you understand\r\n    the inherent risks associated with cryptographic systems; and warrant that you have an understanding of the usage\r\n    and intricacies of the native cryptographic token Tezos (xtz), smart contract based tokens, and blockchain-based\r\n    software systems.</p>\r\n\r\n  <H5>5.3 Risk of Regulatory Actions in One or More Jurisdictions</H5>\r\n  <p>Kukai Wallet and any supported cryptographic token and blockchain could be impacted by one or more regulatory\r\n    inquiries or regulatory action, which could impede or limit the ability of Kukai Wallet to continue to develop, or\r\n    which could impede or limit your ability to access or use the Services or the underlying blockchain network.</p>\r\n\r\n  <H5>5.4 Risk of Weaknesses or Exploits in the Field of Cryptography</H5>\r\n  <p>You acknowledge and understand that Cryptography is a progressing field. Advances in code cracking or technical\r\n    advances such as the development of quantum computers may present risks to cryptocurrencies and Services of Content,\r\n    which could result in the theft or loss of your cryptographic tokens or property. To the extent possible, Kukai\r\n    Wallet intends to update the protocol underlying Services to account for any advances in cryptography and to\r\n    incorporate additional security measures, but does not guarantee or otherwise represent full security of the system.\r\n    By using the Services or accessing Content, you acknowledge these inherent risks.</p>\r\n\r\n  <H5>5.5 Volatility of Cryptocurrencies</H5>\r\n  <p>You understand that Tezos and other blockchain technologies and associated cryptographic tokens are highly volatile\r\n    due to many factors including but not limited to adoption, speculation, technology and security risks. You also\r\n    acknowledge that the cost of transacting on such technologies is variable and may increase at any time causing\r\n    impact to any activities taking place on the blockchain network. You acknowledge these risks and agree that Kukai\r\n    Wallet cannot be held liable for such fluctuations or increased costs.</p>\r\n\r\n  <H5>5.6 Application Security</H5>\r\n  <p>You further acknowledge that blockchain applications are code subject to flaws and acknowledge that you are solely\r\n    responsible for evaluating any code provided by the Services or Content and the trustworthiness of any third-party\r\n    websites, products, smart-contracts, or Content you access or use through the Services. You further expressly\r\n    acknowledge and represent that blockchain applications can be written maliciously or negligently, that Kukai Wallet\r\n    cannot be held liable for your interaction with such applications and that such applications may cause the loss of\r\n    property or even identity. This warning and others later provided by Kukai Wallet in no way evidence or represent an\r\n    on-going duty to alert you to all of the potential risks of utilizing the Services or Content. The code to Kukai\r\n    Wallet can be found at: https://github.com/kukai-wallet/kukai.</p>\r\n\r\n  <H4>6. Indemnity</H4>\r\n  <p>You agree to release and to indemnify, defend and hold harmless Kukai Wallet and its principles, subsidiaries,\r\n    affiliates and agencies, as well as the officers, directors, employees, shareholders and representatives of any of\r\n    the foregoing entities, from and against any and all losses, liabilities, expenses, damages, costs (including\r\n    attorneys’ fees and court costs) claims or actions of any kind whatsoever arising or resulting from your use of the\r\n    Services, your violation of these Terms, and any of your acts or omissions that implicate publicity rights,\r\n    defamation or invasion of privacy, and privacy laws. Kukai Wallet reserves the right, at its own expense, to assume\r\n    exclusive defense and control of any matter otherwise subject to indemnification by you and, in such case, you agree\r\n    to cooperate with Kukai Wallet in the defense of such matter.</p>\r\n\r\n  <H4>7. Limitation on Liability</H4>\r\n  <p>YOU ACKNOWLEDGE AND AGREE THAT YOU ASSUME FULL RESPONSIBILITY FOR YOUR USE OF THE SITE AND THE SERVICES. YOU\r\n    ACKNOWLEDGE AND AGREE THAT ANY INFORMATION YOU SEND OR RECEIVE DURING YOUR USE OF THE SITE AND THE SERVICES MAY NOT\r\n    BE SECURE AND MAY BE INTERCEPTED OR LATER ACQUIRED BY UNAUTHORIZED PARTIES. YOU ACKNOWLEDGE AND AGREE THAT YOUR USE\r\n    OF THE SITE AND THE SERVICES IS AT YOUR OWN RISK. RECOGNIZING SUCH, YOU UNDERSTAND AND AGREE THAT, TO THE FULLEST\r\n    EXTENT PERMITTED BY APPLICABLE LAW, NEITHER KUKAI WALLET NOR ITS SUPPLIERS OR LICENSORS WILL BE LIABLE TO YOU FOR\r\n    ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY OR OTHER DAMAGES OF ANY KIND,\r\n    INCLUDING WITHOUT LIMITATION DAMAGES FOR LOSS OF PROFITS, GOODWILL, USE, DATA OR OTHER TANGIBLE OR INTANGIBLE LOSSES\r\n    OR ANY OTHER DAMAGES BASED ON CONTRACT, TORT, STRICT LIABILITY OR ANY OTHER THEORY (EVEN IF KUKAI WALLET HAD BEEN\r\n    ADVISED OF THE POSSIBILITY OF SUCH DAMAGES), RESULTING FROM THE SITE OR SERVICES; THE USE OR THE INABILITY TO USE\r\n    THE SITE OR THE SERVICES; UNAUTHORIZED ACCESS TO OR ALTERATION OF YOUR TRANSMISSIONS OR DATA; STATEMENTS OR CONDUCT\r\n    OF ANY THIRD PARTY ON THE SITE OR THE SERVICES; ANY ACTIONS WE TAKE OR FAIL TO TAKE AS A RESULT OF COMMUNICATIONS\r\n    YOU SEND TO US; HUMAN ERRORS; TECHNICAL MALFUNCTIONS; FAILURES, INCLUDING PUBLIC UTILITY OR TELEPHONE OUTAGES;\r\n    OMISSIONS, INTERRUPTIONS, LATENCY, DELETIONS OR DEFECTS OF ANY DEVICE OR NETWORK, PROVIDERS, OR SOFTWARE (INCLUDING,\r\n    BUT NOT LIMITED TO, THOSE THAT DO NOT PERMIT PARTICIPATION IN THE SERVICES); ANY INJURY OR DAMAGE TO COMPUTER\r\n    EQUIPMENT; INABILITY TO FULLY ACCESS THE SITE OR THE SERVICES OR ANY OTHER WEBSITE; THEFT, TAMPERING, DESTRUCTION,\r\n    OR UNAUTHORIZED ACCESS TO, IMAGES OR OTHER CONTENT OF ANY KIND; DATA THAT IS PROCESSED LATE OR INCORRECTLY OR IS\r\n    INCOMPLETE OR LOST; TYPOGRAPHICAL, PRINTING OR OTHER ERRORS, OR ANY COMBINATION THEREOF; OR ANY OTHER MATTER\r\n    RELATING TO THE SITE OR ANY OTHER ASPECT OF THE SERVICES.</p>\r\n\r\n  <p>SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF CERTAIN WARRANTIES OR THE LIMITATION OR EXCLUSION OF LIABILITY FOR\r\n    INCIDENTAL OR CONSEQUENTIAL DAMAGES. ACCORDINGLY, SOME OF THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU.</p>\r\n\r\n  <H4>8. Intellectual Property</H4>\r\n  <H5>8.1 Our Proprietary Rights</H5>\r\n  <p>All title, ownership and intellectual property rights in and to the Services are owned by Kukai Wallet or its\r\n    licensors. You acknowledge and agree that the Services contains proprietary and confidential information that is\r\n    protected by applicable intellectual property and other laws. Except as expressly authorized by Kukai Wallet, you\r\n    agree not to copy, modify, rent, lease, loan, sell, distribute, perform, display or create derivative works based on\r\n    the Site, or the Services, in whole or in part.</p>\r\n\r\n  <H5>8.2 Limited License</H5>\r\n  <p>We grant you limited, non-exclusive, revocable permission to make use of the Site, and the Services (collectively\r\n    referred to as, “Access”). This Access shall remain in effect until and unless terminated by you or us. You promise\r\n    and agree that you will not redistribute or transfer the Services.</p>\r\n\r\n  <p>The Kukai Wallet software application, including without limitation the Site, and the Services, are not sold or\r\n    transferred to you, and Kukai Wallet and its licensors retain ownership of all copies of the software applications\r\n    even after installation on your personal computers, mobile handsets, tablets, wearable devices, speakers and/or\r\n    other devices (“Devices”).</p>\r\n\r\n  <p>All Kukai Wallet trademarks, service marks, trade names, logos, domain names, and any other features of the Kukai\r\n    Wallet brand (“Kukai Wallet Brand Features”) are the sole property of Kukai Wallet or its licensors. The Terms do\r\n    not grant you any rights to use any Kukai Wallet Brand Features whether for commercial or non-commercial use.</p>\r\n\r\n  <p>You agree to abide by our user guidelines and not to use the Services or any part thereof in any manner not\r\n    expressly permitted by the Terms. Except for the rights expressly granted to you in the Terms, Kukai Wallet grants\r\n    no right, title, or interest to you in the Site or the Services.</p>\r\n\r\n  <p>Third party software (for example, open source software libraries) included in the Services are made available to\r\n    you under the relevant third party software library’s license terms.</p>\r\n\r\n  <p>Notwithstanding anything herein to the contrary, nothing in the Terms entitles you to copy, modify, fork, merge,\r\n    combine with another program or create a derivative work of the Services, including without limitation the Site.</p>\r\n\r\n  <H4>9. Links</H4>\r\n  <p>The Services provide, or third parties may provide, links to other World Wide Web or accessible sites, applications\r\n    or resources. Because Kukai Wallet has no control over such sites, applications and resources, you acknowledge and\r\n    agree that Kukai Wallet is not responsible for the availability of such external sites, applications or resources,\r\n    and does not endorse and is not responsible or liable for any content, advertising, products or other materials on\r\n    or available from such sites or resources. You further acknowledge and agree that Kukai Wallet shall not be\r\n    responsible or liable, directly or indirectly, for any damage or loss caused or alleged to be caused by or in\r\n    connection with use of or reliance on any such content, goods or services available on or through any such site or\r\n    resource.</p>\r\n\r\n  <H4>10. Termination and Suspension</H4>\r\n  <p>Kukai Wallet may terminate or suspend all or part of the Services and your Kukai Wallet access immediately, without\r\n    prior notice or liability, if you breach any of the terms or conditions of the Terms. Upon termination of your\r\n    access, your right to use the Services will immediately cease.</p>\r\n\r\n  <p>The following provisions of the Terms survive any termination of these Terms: INDEMNITY; WARRANTY DISCLAIMERS;\r\n    LIMITATION ON LIABILITY; OUR PROPRIETARY RIGHTS; LINKS; TERMINATION; NO THIRD PARTY BENEFICIARIES; BINDING\r\n    ARBITRATION AND CLASS ACTION WAIVER; GENERAL INFORMATION.</p>\r\n\r\n  <H4>11. No Third Party Beneficiaries</H4>\r\n  <p>You agree that, except as otherwise expressly provided in these Terms, there shall be no third party beneficiaries\r\n    to the Terms.</p>\r\n\r\n  <H4>12. Notice and Procedure For Making Claims of Copyright Infringement</H4>\r\n  <p>If you believe that your copyright or the copyright of a person on whose behalf you are authorized to act has been\r\n    infringed, please provide Kukai Wallet’s Copyright Agent a written Notice containing the following information:</p>\r\n\r\n  <p>- an electronic or physical signature of the person authorized to act on behalf of the owner of the copyright or\r\n    other intellectual property interest;\r\n    <BR>- a description of the copyrighted work or other intellectual property that you claim has been infringed;\r\n    <BR>- a description of where the material that you claim is infringing is located on the Services;\r\n    your address, telephone number, and email address;\r\n    <BR>- a statement by you that you have a good faith belief that the disputed use is not authorized by the copyright\r\n    owner, its agent, or the law;\r\n    <BR>- a statement by you, made under penalty of perjury, that the above information in your Notice is accurate and\r\n    that you are the copyright or intellectual property owner or authorized to act on the copyright or intellectual\r\n    property owner’s behalf.</p>\r\n\r\n  <p>Kukai Wallet’s Copyright Agent can be reached at:</p>\r\n\r\n  <p>Email: legal@kukai.app</p>\r\n\r\n  <H4>13. Binding Arbitration and Class Action Waiver</H4>\r\n\r\n  <p>PLEASE READ THIS SECTION CAREFULLY – IT MAY SIGNIFICANTLY AFFECT YOUR LEGAL RIGHTS, INCLUDING YOUR RIGHT TO FILE A\r\n    LAWSUIT IN COURT</p>\r\n\r\n  <H5>13.1 Initial Dispute Resolution</H5>\r\n\r\n  <p>The parties shall use their best efforts to engage directly to settle any dispute, claim, question, or disagreement\r\n    and engage in good faith negotiations which shall be a condition to either party initiating a lawsuit or\r\n    arbitration.</p>\r\n\r\n  <H5>13.2 Binding Arbitration</H5>\r\n\r\n  <p>If the parties do not reach an agreed upon solution within a period of 30 days from the time informal dispute\r\n    resolution under the Initial Dispute Resolution provision begins, then either party may initiate arbitration as the\r\n    sole means to resolve all claims, subject to the terms set forth below. Specifically, all claims arising out of or\r\n    relating to these Terms (including their formation, performance and breach), the parties’ relationship with each\r\n    other and/or your use of the Services shall be finally settled by binding arbitration administered by the American\r\n    Arbitration Association in accordance with the provisions of its Commercial Arbitration Rules and the supplementary\r\n    procedures for consumer related disputes of the American Arbitration Association (the “AAA”), excluding any rules or\r\n    procedures governing or permitting class actions.</p>\r\n\r\n  <p>The arbitrator, and not any federal, state or local court or agency, shall have exclusive authority to resolve all\r\n    disputes arising out of or relating to the interpretation, applicability, enforceability or formation of these\r\n    Terms, including, but not limited to any claim that all or any part of these Terms are void or voidable, or whether\r\n    a claim is subject to arbitration. The arbitrator shall be empowered to grant whatever relief would be available in\r\n    a court under law or in equity. The arbitrator’s award shall be written, and binding on the parties and may be\r\n    entered as a judgment in any court of competent jurisdiction.</p>\r\n\r\n  <p>The parties understand that, absent this mandatory provision, they would have the right to sue in court and have a\r\n    jury trial. They further understand that, in some instances, the costs of arbitration could exceed the costs of\r\n    litigation and the right to discovery may be more limited in arbitration than in court.</p>\r\n\r\n  <H5>13.3 Location</H5>\r\n\r\n  <p>Binding arbitration shall take place in Louisiana. You agree to submit to the personal jurisdiction of any federal\r\n    or state court in Orleans Parish, Louisiana, in order to compel arbitration, to stay proceedings pending\r\n    arbitration, or to confirm, modify, vacate or enter judgment on the award entered by the arbitrator.</p>\r\n\r\n  <H5>13.4 Class Action Waiver</H5>\r\n\r\n  <p>The parties further agree that any arbitration shall be conducted in their individual capacities only and not as a\r\n    class action or other representative action, and the parties expressly waive their right to file a class action or\r\n    seek relief on a class basis. YOU AND KUKAI WALLET AGREE THAT EACH MAY BRING CLAIMS AGAINST THE OTHER ONLY IN YOUR\r\n    OR ITS INDIVIDUAL CAPACITY, AND NOT AS A PLAINTIFF OR CLASS MEMBER IN ANY PURPORTED CLASS OR REPRESENTATIVE\r\n    PROCEEDING. If any court or arbitrator determines that the class action waiver set forth in this paragraph is void\r\n    or unenforceable for any reason or that an arbitration can proceed on a class basis, then the arbitration provision\r\n    set forth above shall be deemed null and void in its entirety and the parties shall be deemed to have not agreed to\r\n    arbitrate disputes.</p>\r\n\r\n  <H5>13.5 Exception - Litigation of Intellectual Property and Small Claims Court Claims</H5>\r\n\r\n  <p>Notwithstanding the parties’ decision to resolve all disputes through arbitration, either party may bring an action\r\n    in state or federal court to protect its intellectual property rights (“intellectual property rights” means patents,\r\n    copyrights, moral rights, trademarks, and trade secrets, but not privacy or publicity rights). Either party may also\r\n    seek relief in a small claims court for disputes or claims within the scope of that court’s jurisdiction.</p>\r\n\r\n  <H5>13.6 Choice of Law</H5>\r\n\r\n  <p>The Terms and the relationship between you and Kukai Wallet shall be governed by the laws of the State of Louisiana\r\n    without regard to conflict of law provisions.</p>\r\n\r\n  <H4>14. GENERAL INFORMATION</H4>\r\n\r\n  <H5>14.1 Entire Agreement</H5>\r\n\r\n  <p>These Terms (and any additional terms, rules and conditions of participation that Kukai Wallet may post on the\r\n    Services) constitute the entire agreement between you and Kukai Wallet with respect to the Services and supersedes\r\n    any prior agreements, oral or written, between you and Kukai Wallet. In the event of a conflict between these Terms\r\n    and the additional terms, rules and conditions of participation, the latter will prevail over the Terms to the\r\n    extent of the conflict.</p>\r\n\r\n  <H5>14.2 Waiver and Severability of Terms</H5>\r\n\r\n  <p>The failure of Kukai Wallet to exercise or enforce any right or provision of the Terms shall not constitute a\r\n    waiver of such right or provision. If any provision of the Terms is found by an arbitrator or court of competent\r\n    jurisdiction to be invalid, the parties nevertheless agree that the arbitrator or court should endeavor to give\r\n    effect to the parties’ intentions as reflected in the provision, and the other provisions of the Terms remain in\r\n    full force and effect.</p>\r\n\r\n  <H5>14.3 Statute of Limitations</H5>\r\n\r\n  <p>You agree that regardless of any statute or law to the contrary, any claim or cause of action arising out of or\r\n    related to the use of the Services or the Terms must be filed within one (1) year after such claim or cause of\r\n    action arose or be forever barred.</p>\r\n\r\n  <H5>14.4 Section Titles</H5>\r\n\r\n  <p>The section titles in the Terms are for convenience only and have no legal or contractual effect.</p>\r\n\r\n  <H5>14.5 Communications</H5>\r\n\r\n  <p>Users with questions, complaints or claims with respect to the Services may contact us using the relevant contact\r\n    information set forth above or email us at: contact@kukai.app</p>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-logged-in',\r\n  templateUrl: './logged-in.component.html',\r\n  styleUrls: ['./logged-in.component.scss']\r\n})\r\nexport class LoggedInComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div><app-uri-handler></app-uri-handler></div>\r\n<router-outlet></router-outlet>","import { Injectable } from '@angular/core';\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { Account } from '../wallet/wallet';\r\n\r\n@Injectable()\r\nexport class DelegateService {\r\n  constructor(\r\n    private walletService: WalletService,\r\n    private operationService: OperationService\r\n  ) {}\r\n  getDelegates() {\r\n    if (\r\n      this.walletService.wallet &&\r\n      this.walletService.wallet.implicitAccounts\r\n    ) {\r\n      for (const account of this.walletService.wallet.getAccounts()) {\r\n        this.getDelegate(account);\r\n      }\r\n    }\r\n  }\r\n  getDelegate(account: Account) {\r\n    this.operationService.getDelegate(account.address).subscribe(\r\n      (data: any) => {\r\n        if (data.success) {\r\n          this.handleDelegateResponse(account, data.payload.delegate);\r\n        }\r\n      },\r\n      (err) => console.log(JSON.stringify(err))\r\n    );\r\n  }\r\n  handleDelegateResponse(account: Account, data: any) {\r\n    if (data) {\r\n      if (account.delegate !== data) {\r\n        account.delegate = data;\r\n        this.walletService.storeWallet();\r\n      } else {\r\n        console.log('delegate for ' + account.address + ' up to date');\r\n      }\r\n    } else {\r\n      if (account.delegate !== '') {\r\n        account.delegate = '';\r\n        this.walletService.storeWallet();\r\n      }\r\n    }\r\n  }\r\n}\r\n","export const BAKERSLIST: any = [\r\n     {\r\n        baker_name: '888 XTZ',\r\n        identity: 'tz1WBfwbT66FC6BTLexc2BoyCCBM9LG7pnVW',\r\n        image: 'assets/img/bakers/888xtz.png'\r\n     },\r\n     {\r\n        baker_name: 'AirBie',\r\n        identity: 'tz1iLbZZ9uoRuVJCrZ9ZwiJMpfzhy3c67mav',\r\n        image: 'assets/img/bakers/airbie.png'\r\n     },\r\n     {\r\n        baker_name: 'Airfoil',\r\n        identity: 'tz1gk3TDbU7cJuiBRMhwQXVvgDnjsxuWhcEA',\r\n        image: 'assets/img/bakers/airfoil2.png'\r\n     },\r\n     {\r\n        baker_name: 'At James',\r\n        identity: 'tz3e75hU4EhDU3ukyJueh5v6UvEHzGwkg3yC',\r\n        image: 'assets/img/bakers/atjames.png'\r\n     },\r\n     {\r\n        baker_name: 'Bake Tz',\r\n        identity: 'tz1ei4WtWEMEJekSv8qDnu9PExG6Q8HgRGr3',\r\n        image: 'assets/img/bakers/bake_tz.png'\r\n     },\r\n     {\r\n        baker_name: 'Bake ꜩ For Me',\r\n        identity: 'tz1NRGxXV9h6SdNaZLcgmjuLx3hyy2f8YoGN',\r\n        image: 'assets/img/bakers/bake_tz_for_me.jpg'\r\n     },\r\n     {\r\n        baker_name: 'Bake\\'n\\'Rolls',\r\n        identity: 'tz1NortRftucvAkD1J58L32EhSVrQEWJCEnB',\r\n        image: 'assets/img/bakers/bake_n_rolls.png'\r\n     },\r\n     {\r\n        baker_name: 'Baked Tezos',\r\n        identity: 'tz1aRhFErGMgL57DYHMT1vYwv7PzsJN1chrk',\r\n        image: 'assets/img/bakers/baked_tezos.jpg'\r\n     },\r\n     {\r\n        baker_name: 'Bakemon',\r\n        identity: 'tz1Z1WwoqgRFbLE3YNdYRpCx44NSfiMJzeAG',\r\n        image: 'assets/img/bakers/bakemon.png'\r\n     },\r\n     {\r\n        baker_name: 'BakeMyStake',\r\n        identity: 'tz1NkFRjmkqqcGkAhqe78fdgemDNKXvL7Bod',\r\n        image: 'assets/img/bakers/bakeyourstake.png'\r\n      },\r\n    /*\r\n     {\r\n        baker_name: 'Baker Avenue',\r\n        identity: 'tz1YgNQBeLTgbwRb7QiyvHrx7hwN7AUbdqpB',        ote3: '',\r\n        image: 'assets/img/bakers/baker-avenue.png'\r\n    },\r\n    {\r\n        baker_name: 'BAKER-IL',\r\n        identity: 'tz1cYufsxHXJcvANhvS55h3aY32a9BAFB494',\r\n        image: 'assets/img/bakers/bakery-il.png'\r\n    },\r\n    */\r\n    {\r\n        baker_name: 'Baking Tacos',\r\n        identity: 'tz1RV1MBbZMR68tacosb7Mwj6LkbPSUS1er1',\r\n        image: 'assets/img/bakers/bakingtacos.png'\r\n    },\r\n    {\r\n        baker_name: 'Blockpower',\r\n        identity: 'tz1LmaFsWRkjr7QMCx5PtV6xTUz3AmEpKQiF',\r\n        image: 'assets/img/bakers/blockpowerstaking.png'\r\n    },\r\n    /*{\r\n          baker_name: 'Bitfinex',\r\n          identity: 'tz1KtGwriE7VuLwT3LwuvU9Nv4wAxP7XZ57d',\r\n          image: 'assets/img/bakers/bitfinex.png'\r\n    },*/\r\n    {\r\n        baker_name: 'BTFD',\r\n        identity: 'tz1d2EwsrmoCPmhNUjt7unCQ8a9RwVsVXEmd',\r\n        image: 'assets/img/bakers/btfd.png'\r\n    },\r\n    {\r\n        baker_name: 'Ceibo XTZ',\r\n        identity: 'tz3bEQoFCZEEfZMskefZ8q8e4eiHH1pssRax',\r\n        image: 'assets/img/bakers/ceiboxtz2.png'\r\n    },\r\n    {\r\n        baker_name: 'Coinbase',\r\n        identity: 'tz1irJKkXS2DBWkU1NnmFQx1c1L7pbGg4yhk',\r\n        image: 'assets/img/bakers/coinbase.png'\r\n    },\r\n    {\r\n        baker_name: 'Coinone',\r\n        identity: 'tz1SYq214SCBy9naR6cvycQsYcUGpBqQAE8d',\r\n        image: 'assets/img/bakers/coinone.png'\r\n    },\r\n    {\r\n        baker_name: 'Cryptium Labs',\r\n        identity: 'tz1eEnQhbwf6trb8Q8mPb2RaPkNk2rN7BKi8',\r\n        image: 'assets/img/bakers/cryptiumlabs3.png'\r\n    },\r\n    {\r\n        baker_name: 'Crypto Delegate',\r\n        identity: 'tz1Tnjaxk6tbAeC2TmMApPh8UsrEVQvhHvx5',\r\n        image: 'assets/img/bakers/cryptodelegate.png'\r\n    },\r\n    {\r\n        baker_name: 'Dash Master',\r\n        identity: 'tz1Lc87p6zRaDwzJs9kHvdpm7XzeWE8QTwVB',\r\n        image: 'assets/img/bakers/dashmaster.png'\r\n    },\r\n    {\r\n        baker_name: 'Delegated Capital',\r\n        identity: 'tz1ZRWFLgT9sz8iFi1VYWPfRYeUvUSFAaDao',\r\n        image: 'assets/img/bakers/delegatedcapital.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Elite Tezos',\r\n        identity: 'tz1W1f1JrE7VsqgpUpj1iiDobqP5TixgZhDk',\r\n        image: 'assets/img/bakers/elitetezos.jpg'\r\n    },\r\n    {\r\n        baker_name: 'EON',\r\n        identity: 'tz1PK8bNrfPbc73BtHH1A63jfU5UtbRFkvU4',\r\n        image: 'assets/img/bakers/eon.png'\r\n    },\r\n    {\r\n        baker_name: 'Everstake',\r\n        identity: 'tz1MXFrtZoaXckE41bjUCSjAjAap3AFDSr3N',\r\n        image: 'assets/img/bakers/everstake.png'\r\n    },\r\n    {\r\n        baker_name: 'Figment',\r\n        identity: 'tz1Scdr2HsZiQjc7bHMeBbmDRXYVvdhjJbBh',\r\n        image: 'assets/img/bakers/figment.png'\r\n    },\r\n    {\r\n        baker_name: 'First Block',\r\n        identity: 'tz1ZQppA6UerMz5CJtGvZmmB6z8L9syq7ixu',\r\n        image: 'assets/img/bakers/firstblock.jpeg'\r\n    },\r\n    {\r\n        baker_name: 'Flippin\\' tacos',\r\n        identity: 'tz1TzaNn7wSQSP5gYPXCnNzBCpyMiidCq1PX',\r\n        image: 'assets/img/bakers/flippintacos.png'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 1',\r\n        identity: 'tz3RDC3Jdn4j15J7bBHZd29EUee9gVB1CxD9',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 2',\r\n        identity: 'tz3bvNMQ95vfAYtG8193ymshqjSvmxiCUuR5',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 3',\r\n        identity: 'tz3RB4aoyjov4KEVRbuhvQ1CKJgBJMWhaeB8',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 4',\r\n        identity: 'tz3bTdwZinP8U1JmSweNzVKhmwafqWmFWRfk',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 5',\r\n        identity: 'tz3NExpXn9aPNZPorRE4SdjJ2RGrfbJgMAaV',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 6',\r\n        identity: 'tz3UoffC7FG7zfpmvmjUmUeAaHvzdcUvAj6r',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 7',\r\n        identity: 'tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Foundation Baker 8',\r\n        identity: 'tz3VEZ4k6a4Wx42iyev6i2aVAptTRLEAivNN',\r\n        image: 'assets/img/bakers/foundationbaker.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Fresh Tezos',\r\n        identity: 'tz1QLXqnfN51dkjeghXvKHkJfhvGiM5gK4tc',\r\n        image: 'assets/img/bakers/freshtezos.png'\r\n    },\r\n    {\r\n        baker_name: 'Gate.io',\r\n        identity: 'tz1NpWrAyDL9k2Lmnyxcgr9xuJakbBxdq7FB',\r\n        image: 'assets/img/bakers/gateio.png'\r\n    },\r\n    {\r\n        baker_name: 'Happy Tezos',\r\n        identity: 'tz1WCd2jm4uSt4vntk4vSuUWoZQGhLcDuR9q',\r\n        image: 'assets/img/bakers/happytezos.png'\r\n    },\r\n    {\r\n        baker_name: 'HashQuark',\r\n        identity: 'tz1KzSC1J9aBxKp7u8TUnpN8L7S65PBRkgdF',\r\n        image: 'assets/img/bakers/hashquark.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Hayek Lab',\r\n        identity: 'tz1SohptP53wDPZhzTWzDUFAUcWF6DMBpaJV',\r\n        image: 'assets/img/bakers/hayeklab2.png'\r\n    },\r\n    {\r\n        baker_name: 'Hot Stake',\r\n        identity: 'tz1Z3KCf8CLGAYfvVWPEr562jDDyWkwNF7sT',\r\n        image: 'assets/img/bakers/hotstake.png'\r\n    },\r\n    {\r\n        baker_name: 'Hyper Blocks Pro',\r\n        identity: 'tz1VHFxUuBhwopxC9YC9gm5s2MHBHLyCtvN1',\r\n        image: 'assets/img/bakers/hyperblocks2.png'\r\n    },\r\n    /*\r\n    {\r\n        baker_name: 'iBakeTezos',\r\n        identity: 'tz1dp3tScJZy8Go3byPdioSujgDi5CdemiuZ',\r\n        image: 'assets/img/bakers/ibaketezos.jpg'\r\n    },\r\n    */\r\n    {\r\n        baker_name: 'Illuminarean',\r\n        identity: 'tz1Ryat7ZuRapjGUgsPym9DuMGrTYYyDBJoq',\r\n        image: 'assets/img/bakers/illuminarean.png'\r\n    },\r\n    {\r\n        baker_name: 'Infinity Stones',\r\n        identity: 'tz1awXW7wuXy21c66vBudMXQVAPgRnqqwgTH',\r\n        image: 'assets/img/bakers/infinitystones.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Just a Baker',\r\n        identity: 'tz1ZTG13gkvouxSANka3HG3uys8C5gu3DPXZ',\r\n        image: 'assets/img/bakers/justabaker.png'\r\n    },\r\n    {\r\n        baker_name: 'Kraken 1',\r\n        identity: 'tz1bDXD6nNSrebqmAnnKKwnX1QdePSMCj4MX',\r\n        image: 'assets/img/bakers/kraken.png'\r\n    },\r\n    {\r\n        baker_name: 'Kraken 2',\r\n        identity: 'tz1NH4A2kRyFQUYhyi9aL8jrrySQUrCgNsX9',\r\n        image: 'assets/img/bakers/kraken.png'\r\n    },\r\n    {\r\n        baker_name: 'LetzBake!',\r\n        identity: 'tz1aqcYgG6NuViML5vdWhohHJBYxcDVLNUsE',\r\n        image: 'assets/img/bakers/letzbake.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Lucid Mining',\r\n        identity: 'tz1VmiY38m3y95HqQLjMwqnMS7sdMfGomzKi',\r\n        image: 'assets/img/bakers/lucidmining.png'\r\n    },\r\n    {\r\n        baker_name: 'My Tezos Baking',\r\n        identity: 'tz1d6Fx42mYgVFnHUW8T8A7WBfJ6nD9pVok8',\r\n        image: 'assets/img/bakers/mytezosbaking.png'\r\n    },\r\n    {\r\n        baker_name: 'Norn Delegate',\r\n        identity: 'tz1YdCPrYbksK7HCoYKDyzgfXwY16Fy9rrGa',\r\n        image: 'assets/img/bakers/norndelegate.png'\r\n    },\r\n    {\r\n        baker_name: 'Ø Crypto Pool',\r\n        identity: 'tz1KtvGSYU5hdKD288a1koTBURWYuADJGrLE',\r\n        image: 'assets/img/bakers/ocryptopool.png'\r\n    },\r\n    {\r\n        baker_name: 'Own Block',\r\n        identity: 'tz1X1fpAZtwQk94QXUgZwfgsvkQgyc2KHp9d',\r\n        image: 'assets/img/bakers/ownblock.png'\r\n    },\r\n    {\r\n        baker_name: 'P2P Validator',\r\n        identity: 'tz1P2Po7YM526ughEsRbY4oR9zaUPDZjxFrb',\r\n        image: 'assets/img/bakers/p2pvalidator.png'\r\n    },\r\n    {\r\n        baker_name: 'PayTezos',\r\n        identity: 'tz1Ldzz6k1BHdhuKvAtMRX7h5kJSMHESMHLC',\r\n        image: 'assets/img/bakers/paytezos.png'\r\n    },\r\n    {\r\n        baker_name: 'Polychain Labs',\r\n        identity: 'tz1Yju7jmmsaUiG9qQLoYv35v5pHgnWoLWbt',\r\n        image: 'assets/img/bakers/polychain.png'\r\n    },\r\n    {\r\n        baker_name: 'Polychain Labs',\r\n        identity: 'tz2TSvNTh2epDMhZHrw73nV9piBX7kLZ9K9m',\r\n        image: 'assets/img/bakers/polychain.png'\r\n    },\r\n    {\r\n        baker_name: 'POS Bakerz',\r\n        identity: 'tz1Vyuu4EJ5Nym4JcrfRLnp3hpaq1DSEp1Ke',\r\n        image: 'assets/img/bakers/pos_bakerz.png'\r\n    },\r\n    {\r\n        baker_name: 'Shake \\'n Bake',\r\n        identity: 'tz1V4qCyvPKZ5UeqdH14HN42rxvNPQfc9UZg',\r\n        image: 'assets/img/bakers/shakenbake.png'\r\n    },\r\n    {\r\n        baker_name: 'Stack Tezos',\r\n        identity: 'tz1MDKr36woXfVtrtXfV1ppPJERxPcm2wU6V',\r\n        image: 'assets/img/bakers/stacktezos.png'\r\n    },\r\n    {\r\n        baker_name: 'Stake House',\r\n        identity: 'tz1V2FYediKBAEaTpXXJBSjuQpjkyCzrTSiE',\r\n        image: 'assets/img/bakers/stake_house.png'\r\n    },\r\n    {\r\n        baker_name: 'Staked',\r\n        identity: 'tz1RCFbB9GpALpsZtu6J58sb74dm8qe6XBzv',\r\n        image: 'assets/img/bakers/staked.png'\r\n    },\r\n    {\r\n        baker_name: 'Stakery',\r\n        identity: 'tz1go7f6mEQfT2xX2LuHAqgnRGN6c2zHPf5c',\r\n        image: 'assets/img/bakers/stakery.png'\r\n    },\r\n    {\r\n        baker_name: 'Staking Facilities',\r\n        identity: 'tz1WpeqFaBG9Jm73Dmgqamy8eF8NWLz9JCoY',\r\n        image: 'assets/img/bakers/stakingfacilities.png'\r\n    },\r\n    {\r\n        baker_name: 'Stir Delegate',\r\n        identity: 'tz1LH4L6XYT2JNPhvWYC4Zq3XEiGgEwzNRvo',\r\n        image: 'assets/img/bakers/stirdelegate.png'\r\n    },\r\n    {\r\n        baker_name: 'Tez Baker',\r\n        identity: 'tz1Lhf4J9Qxoe3DZ2nfe8FGDnvVj7oKjnMY6',\r\n        image: 'assets/img/bakers/tez_baker.png'\r\n    },\r\n    {\r\n        baker_name: 'Tez Mania',\r\n        identity: 'tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz',\r\n        image: 'assets/img/bakers/tez_mania.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tez Milk',\r\n        identity: 'tz1bakeKFwqmtLBzghw8CFnqFvRxLj849Vfg',\r\n        image: 'assets/img/bakers/tez_milk.png'\r\n    },\r\n    {\r\n        baker_name: 'Tez Patisserie',\r\n        identity: 'tz1UUgPwikRHW1mEyVZfGYy6QaxrY6Y7WaG5',\r\n        image: 'assets/img/bakers/tez_patisserie.png'\r\n    },\r\n    {\r\n        baker_name: 'TEZ Rocket',\r\n        identity: 'tz1abTjX2tjtMdaq5VCzkDtBnMSCFPW2oRPa',\r\n        image: 'assets/img/bakers/tez_rocket.png'\r\n    },\r\n    {\r\n        baker_name: 'Tez Whale',\r\n        identity: 'tz1isXamBXpTUgbByQ6gXgZQg4GWNW7r6rKE',\r\n        image: 'assets/img/bakers/tez_whale.png'\r\n    },\r\n    {\r\n        baker_name: 'Tez-Baking',\r\n        identity: 'tz1LBEKXaxQbd5Gtzbc1ATCwc3pppu81aWGc',\r\n        image: 'assets/img/bakers/tezbaking.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezetetic',\r\n        identity: 'tz1VceyYUpq1gk5dtp6jXQRtCtY8hm5DKt72',\r\n        image: 'assets/img/bakers/tezetetic.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezmania',\r\n        identity: 'tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz',\r\n        image: 'assets/img/bakers/tezmania.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezocracy',\r\n        identity: 'tz1TaLYBeGZD3yKVHQGBM857CcNnFFNceLYh',\r\n        image: 'assets/img/bakers/tezocracy.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Bakery',\r\n        identity: 'tz1fZ767VDbqx4DeKiFswPSHh513f51mKEUZ',\r\n        image: 'assets/img/bakers/tezos_bakery.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Berlin',\r\n        identity: 'tz1Y42aKCk53vMbaJNpf1hBg1rznGdBxHJ5C',\r\n        image: 'assets/img/bakers/tezos_berlin.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Capital',\r\n        identity: 'tz2PdGc7U5tiyqPgTSgqCDct94qd6ovQwP6u',\r\n        image: 'assets/img/bakers/tezos_capital.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Capital Legacy',\r\n        identity: 'tz1TDSmoZXwVevLTEvKCTHWpomG76oC9S2fJ',\r\n        image: 'assets/img/bakers/tezos_capital_legacy.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Cat',\r\n        identity: 'tz1XXayQohB8XRXN7kMoHbf2NFwNiH3oMRQQ',\r\n        image: 'assets/img/bakers/tezos_cat.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Chef',\r\n        identity: 'tz1hThMBD8jQjFt78heuCnKxJnJtQo9Ao25X',\r\n        image: 'assets/img/bakers/tezos_chef.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Delegate EU',\r\n        identity: 'tz1YTyvABUyhE7JHpxMVBVqjZnZM4ofMrWKE',\r\n        image: 'assets/img/bakers/tezos_delegateEU.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos France',\r\n        identity: 'tz1U638Z3xWRiXDDKx2S125MCCaAeGDdA896',\r\n        image: 'assets/img/bakers/tezos_france.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos HODL',\r\n        identity: 'tz1WnfXMPaNTBmH7DBPwqCWs9cPDJdkGBTZ8',\r\n        image: 'assets/img/bakers/tezos_hodl.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Hot Bakery',\r\n        identity: 'tz1bLwpPfr3xqy1gWBF4sGvv8bLJyPHR11kx',\r\n        image: 'assets/img/bakers/tezos_hotbakery.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Istanbul',\r\n        identity: 'tz1Vm5cfHncKGBo7YvZfHc4mmudY4qpWzvSB',\r\n        image: 'assets/img/bakers/tezos_istanbul.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Kitchen',\r\n        identity: 'tz1Nn14BBsDULrPXtkM9UQeXaE4iqJhmqmK5',\r\n        image: 'assets/img/bakers/tezos_kitchen.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Korea',\r\n        identity: 'tz1PPUo28B8BroqmVCMMNDudG4ShA2bzicrU',\r\n        image: 'assets/img/bakers/tezos_korea.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Mars',\r\n        identity: 'tz1S1Aew75hMrPUymqenKfHo8FspppXKpW7h',\r\n        image: 'assets/img/bakers/tezos_mars.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Moon',\r\n        identity: 'tz1TgvirXEwVJPg1cCrxT9zFubdzw7Ng6Ke9',\r\n        image: 'assets/img/bakers/tezos_moon.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Ninja',\r\n        identity: 'tz1djEKk6j1FqigTgbRsunbnY9BB7qsn1aAQ',\r\n        image: 'assets/img/bakers/tezos_ninja.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Panda',\r\n        identity: 'tz1PeZx7FXy7QRuMREGXGxeipb24RsMMzUNe',\r\n        image: 'assets/img/bakers/tezos_panda.png'\r\n    },\r\n    /*\r\n    {\r\n        baker_name: 'Tezos Rio',\r\n        identity: 'tz1gfipKzYrNRT14oSNQJMCdRRsUtcbZoKsd',\r\n        image: 'assets/img/bakers/tezos_rio.png'\r\n    },\r\n    */\r\n    {\r\n        baker_name: 'Tezos Suisse',\r\n        identity: 'tz1hAYfexyzPGG6RhZZMpDvAHifubsbb6kgn',\r\n        image: 'assets/img/bakers/tezos_suisse.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Tacos',\r\n        identity: 'tz1bkKTY9Y3rTsHbpr2fbGUCRm736LLquQfM',\r\n        image: 'assets/img/bakers/tezos_tacos.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Tokyo',\r\n        identity: 'tz1VYQpZvjVhv1CdcENuCNWJQXu1TWBJ8KTD',\r\n        image: 'assets/img/bakers/tezos_tokyo.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezos Vote',\r\n        identity: 'tz1bHzftcTKZMTZgLLtnrXydCm6UEqf4ivca',\r\n        image: 'assets/img/bakers/tezos_vote.png'\r\n    },\r\n    {\r\n        baker_name: 'TezosBC',\r\n        identity: 'tz1QGZ3dD2YpRKZ4APeso6EXTeyCUUkw6MQC',\r\n        image: 'assets/img/bakers/tezosbc.png'\r\n    },\r\n    {\r\n        baker_name: 'TezosBr',\r\n        identity: 'tz1YKh8T79LAtWxX29N5VedCSmaZGw9LNVxQ',\r\n        image: 'assets/img/bakers/tezosbrazil.png'\r\n    },\r\n    {\r\n        baker_name: 'TezosRUs',\r\n        identity: 'tz1b9MYGrbN1NAxphLEsPPNT9JC7aNFc5nA4',\r\n        image: 'assets/img/bakers/tezosrus.jpg'\r\n    },\r\n    {\r\n        baker_name: 'TezosSEAsia',\r\n        identity: 'tz1R6Ej25VSerE3MkSoEEeBjKHCDTFbpKuSX',\r\n        image: 'assets/img/bakers/tezosseasia.jpg'\r\n    },\r\n    {\r\n        baker_name: 'TezoSteam',\r\n        identity: 'tz1LLNkQK4UQV6QcFShiXJ2vT2ELw449MzAA',\r\n        image: 'assets/img/bakers/tezosteam2.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezry',\r\n        identity: 'tz1UJvHTgpVzcKWhTazGxVcn5wsHru5Gietg',\r\n        image: 'assets/img/bakers/tezry.png'\r\n    },\r\n    {\r\n        baker_name: 'TezTech Labs',\r\n        identity: 'tz1Vtimi84kLh9RANfRVX2JvYtP4NPCT1aFm',\r\n        image: 'assets/img/bakers/teztechlabs.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezz City',\r\n        identity: 'tz1Zcxkfa5jKrRbBThG765GP29bUCU3C4ok5',\r\n        image: 'assets/img/bakers/tezzcity.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tezzieland',\r\n        identity: 'tz1fUjvVhJrHLZCbhPNvDRckxApqbkievJHN',\r\n        image: 'assets/img/bakers/tezzieland.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezzigator (HSM)',\r\n        identity: 'tz3adcvQaKXTCg12zbninqo3q8ptKKtDFTLv',\r\n        image: 'assets/img/bakers/tezzigator.png'\r\n    },\r\n    {\r\n        baker_name: 'Tezzigator Legacy',\r\n        identity: 'tz1iZEKy4LaAjnTmn2RuGDf2iqdAQKnRi8kY',\r\n        image: 'assets/img/bakers/tezzigator.png'\r\n    },\r\n    {\r\n        baker_name: 'TZ Bake',\r\n        identity: 'tz1Zhv3RkfU2pHrmaiDyxp7kFZpZrUCu1CiF',\r\n        image: 'assets/img/bakers/tz_bake.png'\r\n    },\r\n    {\r\n        baker_name: 'Tz Bakery',\r\n        identity: 'tz1cX93Q3KsiTADpCC4f12TBvAmS5tw7CW19',\r\n        image: 'assets/img/bakers/tz_bakery.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tz Bank',\r\n        identity: 'tz1bkg7rynMXVcjomoe3diB4URfv8GU2GAcw',\r\n        image: 'assets/img/bakers/tz_bank.png'\r\n    },\r\n    {\r\n        baker_name: 'Tz Dutch',\r\n        identity: 'tz1PesW5khQNhy4revu2ETvMtWPtuVyH2XkZ',\r\n        image: 'assets/img/bakers/tz_dutch.png'\r\n    },\r\n    {\r\n        baker_name: 'Tz Envoy',\r\n        identity: 'tz1iJ4qgGTzyhaYEzd1RnC6duEkLBd1nzexh',\r\n        image: 'assets/img/bakers/tz_envoy.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Tz Node',\r\n        identity: 'tz1Vd1rXpV8hTHbFXCXN3c3qzCsgcU5BZw1e',\r\n        image: 'assets/img/bakers/tz_node.png'\r\n    },\r\n    {\r\n        baker_name: 'TzBakeOven',\r\n        identity: 'tz1Yh1nLXfwqVpP8btykuRguu61n3veVmADa',\r\n        image: 'assets/img/bakers/tzbakeoven.gif'\r\n    },\r\n    {\r\n        baker_name: 'Tzscan',\r\n        identity: 'tz1LWub69XbTxdatJnBkm7caDQoybSgW4T3s',\r\n        image: 'assets/img/bakers/tzscan.png'\r\n    },\r\n    {\r\n        baker_name: 'Validators.com',\r\n        identity: 'tz1Pwgj6j55akKCyvTwwr9X4np1RskSXpQY4',\r\n        image: 'assets/img/bakers/validators.png'\r\n    },\r\n    {\r\n        baker_name: 'View Nodes',\r\n        identity: 'tz1aiYKXmSRckyJ9EybKmpVry373rfyngJU8',\r\n        image: 'assets/img/bakers/viewnodestezos.jpg'\r\n    },\r\n    {\r\n        baker_name: 'Wetez Wallet',\r\n        identity: 'tz1iMAHAVpkCVegF9FLGWUpQQeiAHh4ffdLQ',\r\n        image: 'assets/img/bakers/wetez.jpg'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Antipodes',\r\n        identity: 'tz1TcH4Nb3aHNDJ7CGZhU7jgAK1BkSP4Lxds',\r\n        image: 'assets/img/bakers/xtzantipodes.png'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Baker',\r\n        identity: 'tz1ZKi4VrDMEQpypn2NTn9pPbZL3xLRkETLA',\r\n        image: 'assets/img/bakers/xtzbaker.png'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Bakery',\r\n        identity: 'tz1P9GwUWeAyPoT3ZwBc6gWCTP9exEPaVU3w',\r\n        image: 'assets/img/bakers/xtzbakery.jpg'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Delegate',\r\n        identity: 'tz1Xek93iSXXckyQ6aYLVS5Rr2tge2en7ZxS',\r\n        image: 'assets/img/bakers/xtzdelegate.png'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Land',\r\n        identity: 'tz1Z1tMai15JWUWeN2PKL9faXXVPMuWamzJj',\r\n        image: 'assets/img/bakers/xtzland.png'\r\n    },\r\n    {\r\n        baker_name: 'XTZ Master',\r\n        identity: 'tz1KfEsrtDaA1sX7vdM4qmEPWuSytuqCDp5j',\r\n        image: 'assets/img/bakers/xtzmaster.png'\r\n    },\r\n    {\r\n        baker_name: 'You Loaf We Bake',\r\n        identity: 'tz1eZwq8b5cvE2bPKokatLkVMzkxz24z3Don',\r\n        image: 'assets/img/bakers/youloafwebake.png'\r\n    },\r\n    {\r\n        baker_name: 'Zednode',\r\n        identity: 'tz1L3vFD8mFzBaS8yLHFsd7qDJY1t276Dh8i',\r\n        image: 'assets/img/bakers/zednode.png'\r\n    }\r\n];\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { BAKERSLIST } from '../../data/bakers-list';\r\n\r\n@Pipe({\r\n    name: 'delegatorName'\r\n})\r\nexport class DelegatorNamePipe implements PipeTransform {\r\n    transform(pkh: string): string {\r\n        if (!pkh) {\r\n            return '';\r\n        }\r\n        const index = BAKERSLIST.findIndex(b => b.identity === pkh);\r\n        if (index !== -1) {\r\n            return BAKERSLIST[index].baker_name;\r\n        } else {\r\n            return pkh;\r\n        }\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { saveAs } from 'file-saver';\r\n\r\n@Injectable()\r\nexport class ExportService {\r\n\r\n  constructor(\r\n  ) { }\r\n  downloadWallet(data: any) {\r\n    const blob = new Blob([JSON.stringify(data, null, 4)], { type: 'application/json' });\r\n    let filename = 'wallet.tez';\r\n    if (data.walletType === 1) {\r\n      filename = 'view-only_wallet.tez';\r\n    } else if (data.walletType === 2) {\r\n      filename = 'observer_wallet.tez';\r\n    } else if (data.walletType === 3) {\r\n      filename = 'ledger_wallet.tez';\r\n    } else if (data.walletType === 4) {\r\n      filename = 'hd-wallet.tez';\r\n    }\r\n    saveAs(blob, filename);\r\n  }\r\n\r\n  downloadOperationData(hex: string, signed: boolean) {\r\n    const data = {\r\n      hex: hex,\r\n      signed: signed\r\n    };\r\n    let filename;\r\n    if (signed) {\r\n      filename = 'signed.tzop';\r\n    } else {\r\n      filename = 'unsigned.tzop';\r\n    }\r\n    const blob = new Blob([JSON.stringify(data, null, 4)], { type: 'application/json' });\r\n    saveAs(blob, filename);\r\n  }\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { LocationStrategy, HashLocationStrategy } from '@angular/common';\r\nimport { HttpClientModule, HttpClient } from '@angular/common/http';\r\nimport { AppRoutingModule } from './app-routing.module';\r\n\r\n// From Angular Material\r\nimport { MatSortModule } from '@angular/material/sort';\r\nimport { MatTabsModule } from '@angular/material/tabs';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\n\r\n// For translation\r\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\r\nimport {TranslateHttpLoader} from '@ngx-translate/http-loader';\r\n\r\n// External libraries\r\nimport { ComponentLoaderFactory } from 'ngx-bootstrap/component-loader';\r\nimport { ModalModule, AlertModule, ProgressbarModule, ButtonsModule, BsDropdownModule, TabsModule } from 'ngx-bootstrap';\r\nimport { CollapseModule } from 'ngx-bootstrap/collapse';\r\nimport { AppComponent } from './app.component';\r\n\r\nimport { PerfectScrollbarModule } from 'ngx-perfect-scrollbar';\r\nimport { PERFECT_SCROLLBAR_CONFIG } from 'ngx-perfect-scrollbar';\r\nimport { PerfectScrollbarConfigInterface } from 'ngx-perfect-scrollbar';\r\n\r\n\r\nconst DEFAULT_PERFECT_SCROLLBAR_CONFIG: PerfectScrollbarConfigInterface = {\r\n  suppressScrollX: true\r\n};\r\n\r\n// Services\r\nimport { MessageService } from './services/message/message.service';\r\nimport { WalletService } from './services/wallet/wallet.service';\r\nimport { ActivityService } from './services/activity/activity.service';\r\nimport { BalanceService } from './services/balance/balance.service';\r\nimport { EncryptionService } from './services/encryption/encryption.service';\r\nimport { ImportService } from './services/import/import.service';\r\nimport { TzrateService } from './services/tzrate/tzrate.service';\r\nimport { ExportService } from './services/export/export.service';\r\nimport { DelegateService } from './services/delegate/delegate.service';\r\nimport { InputValidationService } from './services/input-validation/input-validation.service';\r\nimport { LedgerService } from './services/ledger/ledger.service';\r\nimport { EstimateService } from './services/estimate/estimate.service';\r\nimport { BeaconService } from './services/beacon/beacon.service';\r\nimport { TorusService } from './services/torus/torus.service';\r\n\r\n// View components\r\nimport { StartComponent } from './components/start/start.component';\r\nimport { SendComponent } from './components/send/send.component';\r\nimport { NewWalletComponent } from './components/new-wallet/new-wallet.component';\r\nimport { ReceiveComponent } from './components/receive/receive.component';\r\nimport { DelegateComponent } from './components/delegate/delegate.component';\r\nimport { PositioningService } from 'ngx-bootstrap/positioning';\r\nimport { MnemonicImportComponent } from './components/mnemonic-import/mnemonic-import.component';\r\nimport { CoordinatorService } from './services/coordinator/coordinator.service';\r\nimport { OperationService } from './services/operation/operation.service';\r\nimport { ActivateComponent } from './components/activate/activate.component';\r\nimport { MessagesComponent } from './components/messages/messages.component';\r\nimport { HeaderComponent } from './components/header/header.component';\r\nimport { P404Component } from './views/error/404.component';\r\nimport { P500Component } from './views/error/500.component';\r\n\r\n// Pipes\r\nimport { ErrorHandlingPipe } from './pipes/error-handling.pipe';\r\nimport { DelegatorNamePipe } from './pipes/delegator-name.pipe';\r\nimport { TruncatePipe } from './pipes/truncate.pipe';\r\nimport { TimeAgoPipe } from './pipes/time-ago.pipe';\r\nimport { ConnectLedgerComponent } from './components/connect-ledger/connect-ledger.component';\r\nimport { FooterComponent } from './components/footer/footer.component';\r\nimport { AccountsComponent } from './components/accounts/accounts.component';\r\nimport { AccountViewComponent } from './components/account-view/account-view.component';\r\nimport { NewImplicitComponent } from './components/new-implicit/new-implicit.component';\r\nimport { SpinnerComponent } from './components/spinner/spinner.component';\r\nimport { AgreementComponent } from './components/agreement/agreement.component';\r\nimport { TermsOfUseComponent } from './components/agreement/terms-of-use/terms-of-use.component';\r\nimport { PrivacyPolicyComponent } from './components/agreement/privacy-policy/privacy-policy.component';\r\nimport { TorusComponent } from './components/torus/torus.component';\r\nimport { TokenComponent } from './components/token/token.component';\r\nimport { UriHandlerComponent } from './components/uri-handler/uri-handler.component';\r\nimport { PermissionRequestComponent } from './components/permission-request/permission-request.component';\r\nimport { LoggedInComponent } from './components/logged-in/logged-in.component';\r\nimport { SettingsComponent } from './components/settings/settings.component';\r\nimport { QrScannerComponent } from './components/qr-scanner/qr-scanner.component';\r\nimport { EmbeddedComponent } from './components/embedded/embedded.component';\r\nimport { SigninComponent } from './components/embedded/signin/signin.component';\r\nimport { SignExprComponent } from './components/sign-expr/sign-expr.component';\r\n\r\n// AoT requires an exported function for factories\r\nexport function HttpLoaderFactory(http: HttpClient) {\r\n  return new TranslateHttpLoader(http, './assets/i18n/', '.json');\r\n}\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n\r\n    // View components\r\n    NewWalletComponent,\r\n    StartComponent,\r\n    SendComponent,\r\n    ReceiveComponent,\r\n    DelegateComponent,\r\n    MnemonicImportComponent,\r\n    ActivateComponent,\r\n    MessagesComponent,\r\n    HeaderComponent,\r\n    P404Component,\r\n    P500Component,\r\n\r\n    // Pipes\r\n    ErrorHandlingPipe,\r\n    DelegatorNamePipe,\r\n    TruncatePipe,\r\n    TimeAgoPipe,\r\n    ConnectLedgerComponent,\r\n    FooterComponent,\r\n    AccountsComponent,\r\n    AccountViewComponent,\r\n    NewImplicitComponent,\r\n    SpinnerComponent,\r\n    AgreementComponent,\r\n    TermsOfUseComponent,\r\n    PrivacyPolicyComponent,\r\n    TorusComponent,\r\n    TokenComponent,\r\n    UriHandlerComponent,\r\n    PermissionRequestComponent,\r\n    LoggedInComponent,\r\n    SettingsComponent,\r\n    QrScannerComponent,\r\n    EmbeddedComponent,\r\n    SigninComponent,\r\n    SignExprComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    MatTabsModule,\r\n    MatSortModule,\r\n    FormsModule,\r\n    AppRoutingModule,\r\n    HttpClientModule,\r\n    CollapseModule.forRoot(),\r\n    ModalModule.forRoot(),\r\n    AlertModule.forRoot(),\r\n    PerfectScrollbarModule,\r\n    ProgressbarModule.forRoot(),\r\n    ButtonsModule.forRoot(),\r\n    BsDropdownModule.forRoot(),\r\n    TabsModule.forRoot(),\r\n    TranslateModule.forRoot({\r\n      loader: {\r\n        provide: TranslateLoader,\r\n        useFactory: HttpLoaderFactory,\r\n        deps: [HttpClient]\r\n      }\r\n    })  // lazy loading will need TranslateModule.forChild() in the lazy loaded modules\r\n  ],\r\n  providers: [\r\n    // Services\r\n    MessageService,\r\n    WalletService,\r\n    ActivityService,\r\n    EncryptionService,\r\n    BalanceService,\r\n    ImportService,\r\n    ComponentLoaderFactory,\r\n    PositioningService,\r\n    TzrateService,\r\n    CoordinatorService,\r\n    OperationService,\r\n    ExportService,\r\n    DelegateService,\r\n    InputValidationService,\r\n    LedgerService,\r\n    EstimateService,\r\n    BeaconService,\r\n    TorusService,\r\n\r\n    // Pipes\r\n    ErrorHandlingPipe,\r\n    DelegatorNamePipe,\r\n    TruncatePipe,\r\n    TimeAgoPipe\r\n  ],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","import { Injectable } from '@angular/core';\r\nimport { CONSTANTS } from '../../../../environments/environment';\r\nimport { Indexer } from '../indexer.service';\r\nimport * as cryptob from 'crypto-browserify';\r\nimport { WalletObject, Activity } from '../../wallet/wallet';\r\n\r\ninterface TokenMetadata {\r\n  name: string;\r\n  tokenType: 'FA2' | 'FA1.2';\r\n  decimals: number;\r\n  symbol?: string;\r\n  description?: string;\r\n  displayUri?: string;\r\n  thumbnailUri?: string;\r\n  category?: string;\r\n  nonTransferable?: boolean;\r\n  symbolPreference?: boolean;\r\n  booleanAmount?: boolean;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TzktService implements Indexer {\r\n  CONSTANTS: any;\r\n  public readonly bcd = 'https://api.better-call.dev/v1';\r\n  constructor() { }\r\n  async getContractAddresses(pkh: string): Promise<any> {\r\n    return fetch(`https://api.${CONSTANTS.NETWORK}.tzkt.io/v1/operations/originations?contractManager=${pkh}`)\r\n      .then(response => response.json())\r\n      .then(data => data.map((op: any) => {\r\n        return (op?.status === 'applied' && op?.originatedContract?.kind === 'delegator_contract') ? op.originatedContract.address : '';\r\n      }).filter((address: string) => address.length));\r\n  }\r\n  async accountInfo(address: string, knownTokenIds: string[] = []): Promise<any> {\r\n    const network = CONSTANTS.NETWORK;\r\n    const tokens = [];\r\n    const unknownTokenIds = [];\r\n    return fetch(`${this.bcd}/account/${network}/${address}`)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        if (data) {\r\n          if (data?.tokens?.length) {\r\n            for (const token of data.tokens) {\r\n              tokens.push(token);\r\n              if (!knownTokenIds.includes(`${token.contract}:${token.token_id}`)) {\r\n                unknownTokenIds.push(`${token.contract}:${token.token_id}`);\r\n              }\r\n            }\r\n          }\r\n          tokens.sort(\r\n            function (a: any, b: any) {\r\n              if (`${a.contract}:${a.token_id}` < `${b.contract}:${b.token_id}`) {\r\n                return -1;\r\n              } else {\r\n                return 1;\r\n              }\r\n            }\r\n          );\r\n          const payload: string =\r\n            (data.balance ? data.balance : '') +\r\n            (data.last_action ? data.last_action : '') +\r\n            (tokens ? JSON.stringify(tokens) : '');\r\n          const input = Buffer.from(payload);\r\n          const hash = cryptob.createHash('md5').update(input, 'base64').digest('hex');\r\n          if (payload && payload !== '0001-01-01T00:00:00Z[]') {\r\n            return { counter: hash, unknownTokenIds, tokens };\r\n          }\r\n        }\r\n        return { counter: '', unknownTokenIds, tokens };\r\n      });\r\n  }\r\n  async getOperations(address: string, knownTokenIds: string[] = [], wallet: WalletObject): Promise<any> {\r\n    const ops = await fetch(`https://api.${CONSTANTS.NETWORK}.tzkt.io/v1/accounts/${address}/operations?limit=20&type=delegation,origination,transaction`)\r\n      .then(response => response.json())\r\n      .then(data => data.map(op => {\r\n        if (!(op.hasInternals && wallet.getAccount(op.target.address)) && op.status === 'applied') {\r\n          let destination = { address: '' };\r\n          let amount = '0';\r\n          let entrypoint = '';\r\n          switch (op.type) {\r\n            case 'transaction':\r\n              if ((address !== op.target.address &&\r\n                address !== op.sender.address)) {\r\n                return null;\r\n              }\r\n              destination = op.target;\r\n              amount = op.amount.toString();\r\n              entrypoint = this.extractEntrypoint(op);\r\n              break;\r\n            case 'delegation':\r\n              if (address !== op.sender.address) {\r\n                return null;\r\n              }\r\n              destination = op.newDelegate ? op.newDelegate : { address: '' };\r\n              amount = '0';\r\n              break;\r\n            case 'origination':\r\n              destination = op.originatedContract;\r\n              if (op.contractBalance) {\r\n                amount = op.contractBalance.toString();\r\n              }\r\n              break;\r\n            default:\r\n              console.log(`Ignoring kind ${op.type}`);\r\n              return null;\r\n          }\r\n          const activity: Activity = {\r\n            type: op.type,\r\n            block: op.block,\r\n            status: 1,\r\n            amount,\r\n            source: op.sender,\r\n            destination,\r\n            hash: op.hash,\r\n            timestamp: (new Date(op.timestamp)).getTime(),\r\n            entrypoint\r\n          };\r\n          return activity;\r\n        }\r\n      }).filter(obj => obj));\r\n    const unknownTokenIds: string[] = [];\r\n    const tokenTxs = await fetch(`${this.bcd}/tokens/${CONSTANTS.NETWORK}/transfers/${address}?size=20`)\r\n      .then(response => response.json())\r\n      .then(data => data.transfers.map(tx => {\r\n        const tokenId = `${tx.contract}:${tx.token_id}`;\r\n        if (tx.contract && tokenId && tx.status === 'applied') {\r\n          if (!knownTokenIds.includes(tokenId)) {\r\n            unknownTokenIds.push(tokenId);\r\n          }\r\n          const source: any = { address: tx.from };\r\n          if (tx.from === '' && tx.contract) {\r\n            source.address = tx.contract;\r\n            if (tx.alias) {\r\n              source.alias = tx.alias;\r\n            }\r\n          }\r\n          const index = ops.findIndex((op: any) => op.hash === tx.hash);\r\n          if (index !== -1) {\r\n            ops.splice(index, 1); // Hide token transfer invokation\r\n          }\r\n          const activity: Activity = {\r\n            type: 'transaction',\r\n            block: '',\r\n            status: 1,\r\n            amount: tx.amount,\r\n            tokenId,\r\n            source,\r\n            destination: { address: tx.to },\r\n            hash: tx.hash,\r\n            timestamp: (new Date(tx.timestamp)).getTime()\r\n          };\r\n          return activity;\r\n        } else {\r\n          return null;\r\n        }\r\n      }).filter(obj => obj));\r\n    const operations = ops.concat(tokenTxs).sort(\r\n      function (a: any, b: any) {\r\n        return b.timestamp - a.timestamp;\r\n      }\r\n    );\r\n    return { operations, unknownTokenIds };\r\n  }\r\n  private extractEntrypoint(op: any): string {\r\n    try {\r\n      if (op.parameters) {\r\n        const entrypoint = op.parameters.match(/\\{\\\"entrypoint\\\":\\\"[^\\\"]*/g)?.map(i => {\r\n          return i.slice(15);\r\n        });\r\n        if (entrypoint !== null && entrypoint.length) {\r\n          return entrypoint[0];\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n    return '';\r\n  }\r\n  async getTokenMetadata(contractAddress, id): Promise<TokenMetadata> {\r\n    const tokenKind = fetch(`${this.bcd}/contract/${CONSTANTS.NETWORK}/${contractAddress}`)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        if (data?.tags?.includes('fa2')) {\r\n          return 'FA2';\r\n        } else if (data?.tags.includes('fa12')) {\r\n          return 'FA1.2';\r\n        }\r\n        return null;\r\n      }).catch(e => {\r\n        return null;\r\n      });\r\n    const contractMetadata = fetch(`${this.bcd}/account/${CONSTANTS.NETWORK}/${contractAddress}/metadata`)\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        const meta: any = {};\r\n        if (data?.tags?.includes('fa2')) {\r\n          meta.tokenType = 'FA2';\r\n        } else if (data?.tags?.includes('fa2')) {\r\n          meta.tokenType = 'FA1.2';\r\n        }\r\n        if (data?.category) {\r\n          meta.category = data.category;\r\n        }\r\n        return meta;\r\n      }).catch(e => {\r\n        console.log(`No contract metadata found for ${contractAddress}:${id}`);\r\n        return {};\r\n      });\r\n    const tokenMetadata = fetch(`${this.bcd}/contract/${CONSTANTS.NETWORK}/${contractAddress}/tokens`)\r\n      .then(response => response.json())\r\n      .then(datas => {\r\n        const keys = [\r\n          { key: 'name', type: 'string' },\r\n          { key: 'decimals', type: 'number' },\r\n          { key: 'symbol', type: 'string' },\r\n          { key: 'description', type: 'string' },\r\n          { key: 'displayUri', type: 'string' },\r\n          { key: 'thumbnailUri', type: 'string' },\r\n          { key: 'nonTransferable', type: 'boolean' },\r\n          { key: 'symbolPreference', type: 'boolean' },\r\n          { key: 'booleanAmount', type: 'boolean' }\r\n        ];\r\n        for (const data of datas) {\r\n          if (data?.token_id === Number(id)) {\r\n            this.flattern(data);\r\n            const metadata: any = {};\r\n            for (const a of keys) {\r\n              if (typeof data[a.key] === a.type) {\r\n                metadata[a.key] = data[a.key];\r\n              }\r\n            }\r\n            if (metadata.displayUri) {\r\n              metadata.displayUri = this.uriToUrl(metadata.displayUri);\r\n            }\r\n            if (metadata.thumbnailUri) {\r\n              metadata.thumbnailUri = this.uriToUrl(metadata.thumbnailUri);\r\n            }\r\n            return metadata;\r\n          }\r\n        }\r\n        console.log(`No token metadata found for ${contractAddress}:${id}`);\r\n        return {};\r\n      }).catch(e => {\r\n        return {};\r\n      });\r\n    const ans = await Promise.all([contractMetadata, tokenMetadata, tokenKind])\r\n      .then(res => {\r\n        const merged: any = { ...res[0], ...res[1] };\r\n        if (!merged.tokenType && res[2]) {\r\n          merged.tokenType = res[2];\r\n        }\r\n        return merged;\r\n      });\r\n    return ans ? ans : null;\r\n  }\r\n  private flattern(obj: any): any {\r\n    const keys = Object.keys(obj);\r\n    for (const key of keys) {\r\n      if (typeof obj[key] === 'object' && !Array.isArray(obj[key])) {\r\n        const childKeys = Object.keys(obj[key]);\r\n        for (const childKey of childKeys) {\r\n          if (typeof obj[childKey] === 'undefined' && typeof obj[key][childKey] !== 'object') {\r\n            obj[childKey] = obj[key][childKey];\r\n          }\r\n        }\r\n        delete obj[key];\r\n      }\r\n    }\r\n  }\r\n  async getTokenMetadataDepricated(contractAddress: string, id: number): Promise<any> {\r\n    console.log(contractAddress + ':' + id);\r\n    const bigMapId = await this.getBigMapIds(contractAddress);\r\n    if (bigMapId.token !== -1) {\r\n      const tokenMetadata = await this.extractTokenMetadata(bigMapId.token, id);\r\n      const contractMetadata = await this.extractContractMetadata(bigMapId.contract);\r\n      const metadata = { ...tokenMetadata, ...contractMetadata };\r\n      return metadata;\r\n    }\r\n    return null;\r\n  }\r\n  async extractTokenMetadata(bigMapId: number, id: number) {\r\n    const tokenBigMap = await this.fetchApi(`${this.bcd}/bigmap/${CONSTANTS.NETWORK}/${bigMapId}/keys?size=1000`);\r\n    console.log(`${this.bcd}/bigmap/${CONSTANTS.NETWORK}/${bigMapId}/keys`);\r\n    let url = '';\r\n    const metadata: any = {};\r\n    const lookFor = {\r\n      strings: ['name', 'symbol', 'description', 'displayUri', 'displayURI'],\r\n      numbers: ['decimals'],\r\n      booleans: ['nonTransferable', 'booleanAmount', 'symbolPreference']\r\n    };\r\n    try {\r\n      for (const child of tokenBigMap) {\r\n        if (child.data.key.value === id.toString()) {\r\n          for (const child2 of child.data.value.children) {\r\n            if (child2.name === 'token_metadata_map') {\r\n              console.log('token_metadata_map', child2.children);\r\n              for (const child3 of child2.children) {\r\n                if (!child3.name || child3.name === '\"\"') {\r\n                  url = this.uriToUrl(child3.value);\r\n                } else {\r\n                  for (const key of lookFor.strings) {\r\n                    if (child3.name === key) {\r\n                      metadata[key] = child3.value;\r\n                    }\r\n                  }\r\n                  for (const key of lookFor.numbers) {\r\n                    if (child3.name === key) {\r\n                      metadata[key] = Number(child3.value);\r\n                    }\r\n                  }\r\n                  for (const key of lookFor.booleans) {\r\n                    if (child3.name === key) {\r\n                      if (child3.value === '00') {\r\n                        metadata[key] = false;\r\n                      } else if (child3.value.toUpperCase() === 'FF') {\r\n                        metadata[key] = true;\r\n                      }\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n              break;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn(e);\r\n      return null;\r\n    }\r\n    console.log(metadata);\r\n    console.log(url);\r\n    if (!url) {\r\n      console.log('No offchain metadata');\r\n      if (!metadata['displayUri'] && metadata['displayURI']) {\r\n        metadata['displayUri'] = metadata['displayURI'];\r\n        delete metadata['displayURI'];\r\n      }\r\n      if (metadata['displayUri']) {\r\n        metadata['displayUri'] = this.uriToUrl(metadata['displayUri']);\r\n      }\r\n      return metadata;\r\n    }\r\n    const offChainMeta = await this.fetchApi(`${url}`);\r\n    if (!offChainMeta) {\r\n      console.warn('Failed to fetch offchain metadata');\r\n      return null;\r\n    }\r\n    console.log(offChainMeta);\r\n    for (const key of lookFor.strings) {\r\n      if (offChainMeta[key] && typeof offChainMeta[key] === 'string' && typeof metadata[key] === 'undefined') {\r\n        metadata[key] = offChainMeta[key];\r\n      }\r\n    }\r\n    for (const key of lookFor.numbers) {\r\n      if (typeof offChainMeta[key] !== 'undefined' && typeof metadata[key] === 'undefined') {\r\n        if (typeof offChainMeta[key] === 'string') {\r\n          metadata[key] = Number(offChainMeta[key]);\r\n        } else if (typeof offChainMeta[key] === 'number') {\r\n          metadata[key] = offChainMeta[key];\r\n        }\r\n      }\r\n    }\r\n    for (const key of lookFor.booleans) {\r\n      if (typeof offChainMeta[key] !== 'undefined' && typeof offChainMeta[key] === 'boolean' && typeof metadata[key] === 'undefined') {\r\n        metadata[key] = offChainMeta[key];\r\n      }\r\n    }\r\n    if (!metadata['displayUri'] && metadata['displayURI']) {\r\n      metadata['displayUri'] = metadata['displayURI'];\r\n      delete metadata['displayURI'];\r\n    }\r\n    if (metadata['displayUri']) {\r\n      metadata['displayUri'] = this.uriToUrl(metadata['displayUri']);\r\n    }\r\n    if (metadata.decimals === undefined) {\r\n      metadata.decimals = 0;\r\n    }\r\n    console.log(metadata);\r\n    return metadata;\r\n  }\r\n  async extractContractMetadata(bigMapId: number) {\r\n    const contractBigMap = await this.fetchApi(`${this.bcd}/bigmap/${CONSTANTS.NETWORK}/${bigMapId}/keys`);\r\n    let url = '';\r\n    try {\r\n      for (const child of contractBigMap) {\r\n        if (child.data.key.value === '') {\r\n          url = this.uriToUrl(child.data.value.value);\r\n          break;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n    if (!url) { return null; }\r\n    if (bigMapId !== -1) {\r\n      try {\r\n        const metadata: any = {};\r\n        const contractMeta = await this.fetchApi(`${url}`);\r\n        if (contractMeta.interfaces) {\r\n          if (contractMeta.interfaces.includes('TZIP-12')) {\r\n            metadata['tokenType'] = 'FA2';\r\n          } else if (contractMeta.interfaces.includes('TZIP-7')) {\r\n            metadata['tokenType'] = 'FA1.2';\r\n          }\r\n        }\r\n        if (contractMeta['tokenCategory']) {\r\n          metadata['tokenCategory'] = contractMeta['tokenCategory'];\r\n        }\r\n        console.log('contract metadata', metadata);\r\n        return metadata;\r\n      } catch { }\r\n    }\r\n    return null;\r\n  }\r\n  async getBigMapIds(contractAddress: string): Promise<{ contract: number, token: number }> {\r\n    const storage: any = await this.fetchApi(`${this.bcd}/contract/${CONSTANTS.NETWORK}/${contractAddress}/storage`);\r\n    let token = -1;\r\n    let contract = -1;\r\n    try {\r\n      for (const child of storage.children) {\r\n        if (child?.name === 'admin') {\r\n          if (child.children) {\r\n            for (const admin of child.children) {\r\n              if (admin?.name === 'metadata') {\r\n                contract = admin.value;\r\n              }\r\n            }\r\n          }\r\n        } else if (child?.name === 'assets') {\r\n          if (child.children) {\r\n            for (const asset of child.children) {\r\n              if (asset?.name === 'token_metadata') {\r\n                token = asset.value;\r\n              }\r\n            }\r\n          }\r\n        } else if (child?.name === 'metadata') {\r\n          contract = child.value;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n    return { contract, token };\r\n  }\r\n  uriToUrl(uri: string): string {\r\n    if (uri && uri.length > 7) {\r\n      if (uri.startsWith('ipfs://')) {\r\n        return `https://cloudflare-ipfs.com/ipfs/${uri.slice(7)}`;\r\n      } else if (uri.startsWith('https://')) {\r\n        return uri;\r\n      } else if (!CONSTANTS.MAINNET && (uri.startsWith('http://localhost') || uri.startsWith('http://127.0.0.1'))) {\r\n        return uri;\r\n      } else {\r\n        console.warn('wrong prefix', uri);\r\n      }\r\n    } else {\r\n      console.warn('No uri');\r\n    }\r\n    return '';\r\n  }\r\n  async fetchApi(url: string): Promise<any> {\r\n    return fetch(url)\r\n      .then(response => response.json())\r\n      .then(data => data);\r\n  }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport Big from 'big.js';\r\nimport { TokenService, TokenResponseType } from '../../services/token/token.service';\r\nimport { ImplicitAccount } from '../../services/wallet/wallet';\r\n\r\n@Component({\r\n  selector: 'app-token',\r\n  templateUrl: './token.component.html',\r\n  styleUrls: ['./token.component.scss']\r\n})\r\nexport class TokenComponent implements OnInit {\r\n  @Input() account: ImplicitAccount;\r\n  @Input() token: TokenResponseType;\r\n  balance = '';\r\n  modalOpen = false;\r\n  constructor(\r\n    private tokenService: TokenService\r\n  ) {\r\n  }\r\n  ngOnInit(): void {\r\n  }\r\n  listDisplayText(): string {\r\n    const tokenKey = `${this.token.contractAddress}:${this.token.id}`;\r\n    const tokenBalance = this.account.getTokenBalance(tokenKey);\r\n    if (this.token.name === '[Unknown token]') {\r\n      return (this.tokenService.searchTimeMs(tokenKey) > 90000) ? this.token.name : 'Searching for metadata...';\r\n    }\r\n    return this.tokenService.formatAmount(tokenKey, tokenBalance);\r\n  }\r\n  openModal() {\r\n    console.log('open');\r\n    const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n    document.body.style.marginRight = scrollBarWidth.toString();\r\n    document.body.style.overflow = 'hidden';\r\n    this.modalOpen = true;\r\n  }\r\n  closeModal() {\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.modalOpen = false;\r\n  }\r\n  getDescription(): string {\r\n    return this.token.description ? this.token.description : '—';\r\n  }\r\n}\r\n","<div class=\"list-item\" (click)=\"openModal()\">\r\n  <div class=\"imgWrapper\"><img src=\"{{ token.thumbnailUrl }}\"></div>\r\n    <span>{{ listDisplayText() }}</span>\r\n</div>\r\n\r\n<!-- Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\">\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModal()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1>Token Info</H1>\r\n    </div>\r\n    <div class=\"km-body\">\r\n      <div class=\"top-wrapper\">\r\n        <div class=\"basics\">\r\n          <div class=\"group\">\r\n            <label>Name</label>\r\n            <p>{{ token.name }}</p>\r\n          </div>\r\n          <div class=\"group\">\r\n            <label>Symbol</label>\r\n            <p style=\"margin-bottom: 0\">{{ token.symbol }}</p>\r\n          </div>\r\n        </div>\r\n        <img src=\"{{ token.thumbnailUrl }}\">\r\n      </div>\r\n      <div class=\"group\">\r\n        <label>Description</label>\r\n        <p>{{ getDescription() }}</p>\r\n      </div>\r\n      <div *ngIf=\"token.contractAddress\" class=\"group\">\r\n        <label>Contract Address</label>\r\n        <p>{{ token.contractAddress }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"crnd\";","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { flatMap, catchError } from 'rxjs/operators';\r\nimport { of, Observable } from 'rxjs';\r\nimport { DefaultTransactionParams } from '../../interfaces';\r\nimport Big from 'big.js';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\n\r\nconst httpOptions = { headers: { 'Content-Type': 'application/json' } };\r\nconst hardGasLimit = 1040000;\r\nconst hardStorageLimit = 60000;\r\n@Injectable()\r\nexport class EstimateService {\r\n  readonly costPerByte = '250';\r\n  readonly revealGasLimit = 1000;\r\n  queue = [];\r\n  nodeURL = CONSTANTS.NODE_URL;\r\n  pkh: string;\r\n  pk: string;\r\n  hash: string;\r\n  chainId: string;\r\n  manager: string;\r\n  counter: number;\r\n  constructor(\r\n    private http: HttpClient,\r\n    private operationService: OperationService\r\n  ) { }\r\n  init(hash: string, chainId: string, counter: number, manager: string, pk: string, pkh: string) {\r\n    this.hash = hash;\r\n    this.chainId = chainId;\r\n    this.counter = counter;\r\n    this.manager = manager;\r\n    this.pk = pk;\r\n    this.pkh = pkh;\r\n  }\r\n  async preLoadData(pkh: string, pk: string) {\r\n    this.pkh = pkh;\r\n    this.pk = pk;\r\n    await Promise.all([this.operationService.getHeader().toPromise(), this.getCounter(pkh), this.getManager(pkh)]).then(req => {\r\n      if (req[0] && req[1] && (req[2]) || req[2] === null) {\r\n        this.init(req[0].hash, req[0].chain_id, req[1], req[2], pk, pkh);\r\n      }\r\n    });\r\n  }\r\n  async estimate(transactions: any, from: string, tokenTransfer: string = '', callback) {\r\n    this.queue.push({ transactions, from, callback });\r\n    if (this.queue.length === 1) {\r\n      while (this.queue.length > 0) {\r\n        while (this.queue.length > 1) {\r\n          this.queue[0].callback(null);\r\n          this.queue.shift();\r\n        }\r\n        let retry = false;\r\n        for (let i = 0; i < 1 || retry && i < 2; i++) {\r\n          await this._estimate(this.queue[0].transactions, this.queue[0].from, tokenTransfer).then((res) => {\r\n            this.queue[0].callback(res);\r\n          }).catch(async (error) => {\r\n            if (error.message && error.message === 'An operation assumed a contract counter in the past' && !retry) {\r\n              console.log('Update counter');\r\n              await this.preLoadData(this.pkh, this.pk);\r\n              retry = true;\r\n            } else {\r\n              this.queue[0].callback({ error });\r\n            }\r\n          });\r\n        }\r\n        this.queue.shift();\r\n      }\r\n    }\r\n  }\r\n  private async _estimate(transactions: any, from: string, tokenTransfer: string): Promise<any> {\r\n    const extraGas = 80;\r\n    if (!this.hash) { return null; }\r\n    const simulation = {\r\n      fee: 0,\r\n      gasLimit: hardGasLimit,\r\n      storageLimit: hardStorageLimit\r\n    };\r\n    for (const tx of transactions) {\r\n      if (!tx.amount) {\r\n        tx.amount = 0;\r\n      }\r\n      if (tx.to.slice(0, 3) !== 'KT1' && !tokenTransfer) {\r\n        tx.amount = 0.000001;\r\n      }\r\n      tx.gasLimit = simulation.gasLimit;\r\n      tx.storageLimit = simulation.storageLimit;\r\n    }\r\n    if (this.hash && this.counter && (this.manager || this.manager === null)) {\r\n      const op = this.operationService.createTransactionObject(this.hash, this.counter, this.manager, transactions,\r\n        this.pkh, this.pk, from, simulation.fee, tokenTransfer);\r\n      const result = await this.simulate(op).toPromise().catch(\r\n        e => {\r\n          console.warn(e);\r\n          return null;\r\n        }\r\n      );\r\n      if (result && result.contents) {\r\n        let reveal = false;\r\n        const limits = [];\r\n        for (const content of result.contents) {\r\n          if (content.kind === 'reveal') {\r\n            reveal = true;\r\n          } else {\r\n            if (content.kind === 'transaction' && content.metadata.operation_result.status === 'applied') {\r\n              const { gasUsage, storageUsage } = this.getOpUsage(content);\r\n              limits.push({ gasLimit: gasUsage + extraGas, storageLimit: storageUsage });\r\n            } else {\r\n              return null;\r\n            }\r\n          }\r\n        }\r\n        return await this.operationService.localForge(op).pipe(flatMap(fop => {\r\n          const bytes = (fop.length / 2) + 64;\r\n          const gas = this.averageGasLimit(limits);\r\n          const storage = this.averageStorageLimit(limits);\r\n          const dtp: DefaultTransactionParams = { customLimits: limits, fee: this.recommendFee(limits, reveal, bytes), burn: this.burnFee(limits), gas, storage, reveal };\r\n          console.log(JSON.stringify(dtp));\r\n          return of(dtp);\r\n        })).toPromise();\r\n      } else if (typeof result.success === 'boolean' && result.success === false) {\r\n        console.log(result);\r\n        throw new Error(result.payload.msg);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  getOpUsage(content: any): { gasUsage: number, storageUsage: number } {\r\n    let gasUsage = 0;\r\n    let burn = Big(0);\r\n    if (content.source && content.source === this.pkh) {\r\n      burn = burn.minus(content.amount ? content.amount : '0');\r\n      burn = burn.minus(content.fee ? content.fee : '0');\r\n    }\r\n    if (content.destination && content.destination === this.pkh) {\r\n      burn = burn.plus(content.amount ? content.amount : '0');\r\n    }\r\n    if (content.metadata.operation_result.balance_updates) {\r\n      for (const balanceUpdate of content.metadata.operation_result.balance_updates) {\r\n        if (balanceUpdate.contract === this.pkh) {\r\n          burn = burn.minus(balanceUpdate.change);\r\n        }\r\n      }\r\n    }\r\n    if (content.metadata.balance_updates) {\r\n      for (const balanceUpdate of content.metadata.balance_updates) {\r\n        if (balanceUpdate.contract === this.pkh) {\r\n          burn = burn.minus(balanceUpdate.change);\r\n        }\r\n      }\r\n    }\r\n    gasUsage += content.metadata.operation_result.consumed_gas ? Number(content.metadata.operation_result.consumed_gas) : 0;\r\n    if (content.metadata.internal_operation_results) {\r\n      for (const internalResult of content.metadata.internal_operation_results) {\r\n        if (internalResult.result) {\r\n          if (internalResult.result.consumed_gas) {\r\n            gasUsage += internalResult.result && internalResult.result.consumed_gas ? Number(internalResult.result.consumed_gas) : 0;\r\n          }\r\n          if (internalResult.result.balance_updates) {\r\n            for (const balanceUpdate of internalResult.result.balance_updates) {\r\n              if (balanceUpdate.contract === this.pkh && balanceUpdate.change.slice(0, 1) === '-') {\r\n                burn = burn.minus(balanceUpdate.change);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const storageUsage = Math.round(burn / Number(this.costPerByte));\r\n    if (gasUsage < 0 || gasUsage > hardGasLimit || storageUsage < 0 || storageUsage > hardStorageLimit) {\r\n      throw new Error('InvalidUsageCalculation');\r\n    }\r\n    const customUsage = this.getUsageException(content);\r\n    if (customUsage) {\r\n      return customUsage;\r\n    }\r\n    return { gasUsage, storageUsage };\r\n  }\r\n  /*\r\n    Need to be updated when fee market appear or default behavior for bakers changes\r\n  */\r\n  recommendFee(limits: any, reveal: boolean, bytes: number): number {\r\n    const minimalFee = 100;\r\n    const feePerByte = 1;\r\n    const feePerGasUnit = 0.1;\r\n    let gasUnits = 0;\r\n    let numberOfOperations = 0;\r\n    if (reveal) {\r\n      gasUnits += this.revealGasLimit;\r\n      numberOfOperations++;\r\n    }\r\n    for (const data of limits) {\r\n      gasUnits += data.gasLimit;\r\n      numberOfOperations++;\r\n    }\r\n    bytes += 10 * numberOfOperations; // add 10 extra bytes for variation in amount & fee\r\n    return Number(Big(Math.ceil(minimalFee + (feePerByte * bytes) + (feePerGasUnit * gasUnits))).div(1000000).toString());\r\n  }\r\n  averageGasLimit(limits: any): number {\r\n    let totalGasLimit = 0;\r\n    for (const data of limits) {\r\n      totalGasLimit += data.gasLimit;\r\n    }\r\n    return Math.ceil(totalGasLimit / limits.length);\r\n  }\r\n  averageStorageLimit(limits: any): number {\r\n    let totalStorageLimit = 0;\r\n    for (const data of limits) {\r\n      totalStorageLimit += data.storageLimit;\r\n    }\r\n    return Math.ceil(totalStorageLimit / limits.length);\r\n  }\r\n  burnFee(limits: any): number {\r\n    let totalStorageLimit = Big(0);\r\n    for (const data of limits) {\r\n      totalStorageLimit = totalStorageLimit.plus(data.storageLimit);\r\n    }\r\n    return Number(Big(totalStorageLimit).times(this.costPerByte).div('1000000').toString());\r\n  }\r\n  simulate(op: any): Observable<any> {\r\n    op.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\r\n    return this.http.post(this.nodeURL + '/chains/main/blocks/head/helpers/scripts/run_operation',\r\n      { operation: op, chain_id: this.chainId }, httpOptions).pipe(flatMap(res => {\r\n        this.operationService.checkApplied([res]);\r\n        return of(res);\r\n      })).pipe(catchError(err => this.operationService.errHandler(err)));\r\n  }\r\n  private getUsageException(content: any): any {\r\n    const entrypoint = content?.parameters?.entrypoint;\r\n    const destination = content?.destination;\r\n    if (entrypoint && destination) {\r\n      switch (`${destination}:${entrypoint}`) {\r\n        case 'KT1TWb6cE56q2L8yTeNNchXqDSXacrNqyVNZ:reward':\r\n          return { gasUsage: 59920, storageUsage: 80 };\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  private async getCounter(pkh: string): Promise<number> {\r\n    return fetch(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh + '/counter', {}).then(response => {\r\n      return response.json();\r\n    });\r\n  }\r\n  private async getManager(pkh: string): Promise<string> {\r\n    return fetch(this.nodeURL + '/chains/main/blocks/head/context/contracts/' + pkh + '/manager_key', {}).then(response => {\r\n      return response.json();\r\n    });\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  templateUrl: '500.component.html',\r\n  styleUrls: ['./error.scss']\r\n})\r\nexport class P500Component {\r\n\r\n  constructor() { }\r\n\r\n}\r\n","<div id=\"error\" class=\"app flex-row align-items-center\" style=\"height: 100vh;\">\r\n  <div class=\"container\">\r\n    <div class=\"row justify-content-center\">\r\n      <div class=\"col-md-6\">\r\n        <div class=\"logo-container\">\r\n          <a class=\"logo\" routerLink=\"/\">\r\n            <img src=\"../../../assets/img/kukai-logo.svg\">\r\n          </a>\r\n        </div>\r\n        <div class=\"clearfix mt-5\">\r\n          <h1 class=\"float-left display-3 mr-4\">500</h1>\r\n          <h4 class=\"pt-3\">Houston, we have a problem!</h4>\r\n          <p>The page you are looking for is temporarily unavailable.</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n@Component({\r\n  selector: 'app-spinner',\r\n  templateUrl: './spinner.component.html',\r\n  styleUrls: ['./spinner.component.scss']\r\n})\r\nexport class SpinnerComponent implements OnInit {\r\n\r\n  constructor(public messageService: MessageService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n}\r\n","<div *ngIf=\"messageService.spinnerOn\" class=\"spinner-wrapper\">\r\n    <div class=\"container\">\r\n        <div class=\"row\">\r\n            <div id=\"loader\">\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"dot\"></div>\r\n                <div class=\"loading\">{{ messageService.spinnerText }}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>","<app-signin (loginResponse)=\"loginResponse($event)\" *ngIf=\"login\"></app-signin>\r\n<app-send *ngIf=\"activeAccount\" (operationResponse)=\"operationResponse($event)\" [beaconMode]=true [operationRequest]=operationRequests\r\n    [activeAccount]=activeAccount></app-send>","import { Component, OnInit } from '@angular/core';\r\nimport { TorusService } from '../../services/torus/torus.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\nimport { ImportService } from '../../services/import/import.service';\r\nimport { KeyPair } from '../../interfaces';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { PartialTezosTransactionOperation, TezosOperationType } from '@airgap/beacon-sdk';\r\nimport { EmbeddedTorusWallet, ImplicitAccount, TorusWallet } from '../../services/wallet/wallet';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { utils, common } from '@tezos-core-tools/crypto-utils';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { LookupService } from '../../services/lookup/lookup.service';\r\n\r\n// could use literals instead of an enum\r\nexport enum MessageTypes {\r\n  loginRequest = 'login_request',\r\n  loginResponse = 'login_response',\r\n  operationRequest = 'operation_request',\r\n  operationResponse = 'operation_response',\r\n  logoutRequest = 'logout_request',\r\n  logoutResponse = 'logout_response'\r\n}\r\n\r\nexport interface Failure {\r\n  failed: true;\r\n  error: string;\r\n}\r\n\r\nexport interface LoginRequest {\r\n  type: MessageTypes.loginRequest;\r\n}\r\n\r\nexport type LoginResponse = {\r\n  type: MessageTypes.loginResponse\r\n} & ({\r\n  instanceId: string,\r\n  pk: string,\r\n  pkh: string,\r\n  userData: {\r\n    typeOfLogin: string,\r\n    id: string\r\n  }\r\n} | Failure);\r\n\r\nexport interface OperationRequest {\r\n  type: MessageTypes.operationRequest;\r\n  operations: PartialTezosTransactionOperation[];\r\n}\r\n\r\nexport type OperationResponse = {\r\n  type: MessageTypes.operationResponse\r\n} & ({\r\n  opHash: string\r\n} | Failure);\r\n\r\nexport interface LogoutRequest {\r\n  type: MessageTypes.logoutRequest;\r\n}\r\n\r\nexport type LogoutResponse = {\r\n  type: MessageTypes.logoutResponse\r\n} & ({\r\n  instanceId: string\r\n} | Failure);\r\n\r\nexport type RequestMessage =\r\n  LoginRequest |\r\n  OperationRequest |\r\n  LogoutRequest;\r\n\r\nexport type ResponseMessage =\r\n  LoginResponse |\r\n  OperationResponse |\r\n  LogoutResponse;\r\n\r\n@Component({\r\n  selector: 'app-embedded',\r\n  templateUrl: './embedded.component.html',\r\n  styleUrls: ['./embedded.component.scss']\r\n})\r\nexport class EmbeddedComponent implements OnInit {\r\n  allowedOrigins = ['http://localhost', 'https://www.tezos.help'];\r\n  origin = '';\r\n  login = false;\r\n  activeAccount: ImplicitAccount = null;\r\n  operationRequests = null;\r\n  constructor(\r\n    private torusService: TorusService,\r\n    private importService: ImportService,\r\n    private walletService: WalletService,\r\n    private coordinatorService: CoordinatorService,\r\n    private route: ActivatedRoute,\r\n    private lookupService: LookupService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    document.body.style.background = 'none';\r\n    this.torusService.initTorus();\r\n    if (window.addEventListener) {\r\n      window.addEventListener('message', this.handleRequest, false);\r\n    } else {\r\n      (window as any).attachEvent('onmessage', this.handleRequest);\r\n    }\r\n    console.log('icabod is connected...');\r\n    this.route.queryParams\r\n      .filter(params => params.instanceId)\r\n      .subscribe(params => {\r\n        this.walletService.loadStoredWallet(params.instanceId);\r\n        if (this.walletService.wallet instanceof EmbeddedTorusWallet) {\r\n          this.origin = this.walletService.wallet.origin;\r\n          this.activeAccount = this.walletService.wallet.implicitAccounts[0];\r\n          this.coordinatorService.startAll();\r\n        }\r\n      }\r\n      );\r\n  }\r\n  handleRequest = (evt) => {\r\n    try {\r\n      const data: RequestMessage = JSON.parse(evt.data);\r\n      if (this.allowedOrigins.includes(evt.origin)) {\r\n        console.log(`Received ${evt.data} from ${evt.origin}`);\r\n        if (data && data.type && /* restricted to dev enviroment for now */ !CONSTANTS.MAINNET) {\r\n          this.origin = evt.origin;\r\n          switch (data.type) {\r\n            case MessageTypes.loginRequest:\r\n              this.login = true;\r\n              break;\r\n            case MessageTypes.operationRequest:\r\n              if (this.walletService.wallet instanceof EmbeddedTorusWallet && evt.origin === this.walletService.wallet.origin &&\r\n                data.operations) {\r\n                this.operationRequests = this.beaconTypeGuard(data.operations);\r\n              } else {\r\n                this.noWalletError();\r\n              }\r\n              break;\r\n            case MessageTypes.logoutRequest:\r\n              if (this.walletService.wallet instanceof EmbeddedTorusWallet && evt.origin === this.walletService.wallet.origin &&\r\n                this.walletService.wallet.instanceId) {\r\n                const instanceId = this.walletService.wallet.instanceId;\r\n                this.logout(instanceId);\r\n                this.sendResponse({\r\n                  type: MessageTypes.logoutResponse,\r\n                  instanceId\r\n                });\r\n              } else {\r\n                this.noWalletError();\r\n              }\r\n              break;\r\n            default:\r\n              console.warn('Unknown request');\r\n          }\r\n        }\r\n      } else if (data && data.type) {\r\n        console.log(`Invalid origin (${evt.origin})`);\r\n      }\r\n    } catch { }\r\n  }\r\n  loginResponse(loginData: any) {\r\n    if (loginData) {\r\n      const { keyPair, userInfo } = loginData;\r\n      const filteredUserInfo = { typeOfLogin: userInfo.typeOfLogin, id: userInfo.verifierId, name: userInfo.name };\r\n      const instanceId = this.generateInstanceId();\r\n      this.sendResponse({\r\n        type: MessageTypes.loginResponse,\r\n        // 128 bits of entropy, base58 encoded\r\n        // TODO should the OperationsService be used instead of this dependancy??\r\n        instanceId,\r\n        pk: keyPair.pk,\r\n        pkh: keyPair.pkh,\r\n        userData: filteredUserInfo\r\n      });\r\n      this.importAccount(keyPair, userInfo, instanceId);\r\n    } else {\r\n      this.abort();\r\n    }\r\n    this.login = false;\r\n  }\r\n  abort() {\r\n    this.sendResponse({ type: MessageTypes.loginResponse, failed: true, error: 'ABORTED_BY_USER' });\r\n  }\r\n  noWalletError() {\r\n    this.sendResponse({\r\n      type: MessageTypes.logoutResponse,\r\n      failed: true,\r\n      error: 'NO_WALLET_FOUND'\r\n    });\r\n  }\r\n  operationResponse(opHash: string) {\r\n    this.operationRequests = null;\r\n    let response: ResponseMessage;\r\n    if (!opHash) {\r\n      response = { type: MessageTypes.operationResponse, failed: true, error: 'ABORTED_BY_USER' };\r\n    } else if (opHash === 'broadcast_error') {\r\n      response = { type: MessageTypes.operationResponse, failed: true, error: 'BROADCAST_ERROR' };\r\n    } else {\r\n      response = { type: MessageTypes.operationResponse, opHash };\r\n    }\r\n    this.sendResponse(response);\r\n  }\r\n  private sendResponse(resp: ResponseMessage) {\r\n    window.parent.window.postMessage(JSON.stringify(resp), this.origin);\r\n  }\r\n  private async importAccount(keyPair: KeyPair, userInfo: any, instanceId: string) {\r\n    if (keyPair) {\r\n      await this.importService\r\n        .importWalletFromPk(keyPair.pk, '', { verifier: userInfo.typeOfLogin, id: userInfo.verifierId, name: userInfo.name, embedded: true, origin: this.origin }, keyPair.sk, instanceId)\r\n        .then((success: boolean) => {\r\n          if (success) {\r\n            console.log('success');\r\n            this.activeAccount = this.walletService.wallet.implicitAccounts[0];\r\n            // should disable the message component in headless mode\r\n            this.coordinatorService.startAll();\r\n          }\r\n        });\r\n    }\r\n  }\r\n  private beaconTypeGuard(transactions: PartialTezosTransactionOperation[]): any {\r\n    try {\r\n      transactions.forEach((tx) => {\r\n        if (\r\n          tx.kind !== 'transaction' ||\r\n          typeof tx.amount !== 'string' ||\r\n          !utils.validAddress(tx.destination)\r\n        ) {\r\n          throw new Error('Invalid transaction');\r\n        }\r\n      });\r\n    } catch (e) {\r\n      console.warn(e);\r\n      return null;\r\n    }\r\n    return { operationDetails: transactions };\r\n  }\r\n  private generateInstanceId(): string {\r\n    return common.base58encode(utils.mnemonicToEntropy(utils.generateMnemonic(15)), new Uint8Array([]));\r\n  }\r\n  private logout(instanceId: string) {\r\n    this.coordinatorService.stopAll();\r\n    this.walletService.clearWallet(instanceId);\r\n    this.lookupService.clear();\r\n  }\r\n}\r\n","<div class=\"outside-container\" *ngIf=\"!beaconMode\">\r\n  <span *ngIf=\"!activeAccount.delegate\">No delegate set <span (click)=\"openModal()\">(Choose a baker)</span></span>\r\n  <span *ngIf=\"activeAccount.delegate\">{{ activeAccount.delegate }} <span (click)=\"openModal()\">(Change&nbsp;baker)</span></span>\r\n</div>\r\n<!-- The Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\" [class.top]=\"beaconMode\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModalAction()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1>Delegate (Choose a baker)</H1>\r\n    </div>\r\n    <!-- Prepare delegation -->\r\n    <div class=\"km-body\" *ngIf=\"activeView === 0\">\r\n      <div class=\"group\">\r\n        <label>Current Account Address</label>\r\n        <p>{{ activeAccount.address }}</p>\r\n      </div>\r\n      <div class=\"group\">\r\n        <label>Delegate to Baker Address</label>\r\n        <input #toPkhInput type=\"text\" class=\"text\" [(ngModel)]=\"toPkh\" [disabled]=\"beaconMode\">\r\n      </div>\r\n      <div class=\"group\">\r\n        <label>Fee (tez)</label>\r\n        <input type=\"text\" class=\"text\" [(ngModel)]=\"fee\" placeholder={{this.recommendedFee.toString()}}\r\n          (keypress)=\"keyPressNumbersDecimal($event, 'fee')\">\r\n      </div>\r\n      <span *ngIf=\"formInvalid\" class=\"danger no-margin\">\r\n        {{ formInvalid }}\r\n      </span>\r\n      <button class=\"blue\" (click)=\"openModal2()\">Preview</button>\r\n    </div>\r\n    <!-- Confirm transaction -->\r\n    <div class=\"km-body\" *ngIf=\"activeView === 1\">\r\n      <p class=\"preview\">\r\n        Current Account Address — {{ activeAccount.address }}\r\n      </p>\r\n      <p *ngIf=\"getDelegate()\" class=\"preview\">\r\n        Delegate to Baker Address — {{ getDelegate() | delegatorName }}\r\n      </p>\r\n      <p *ngIf=\"!getDelegate()\" class=\"preview\">\r\n        Withdraw delegation\r\n      </p>\r\n      <p class=\"preview\">\r\n        Fee — {{ getFee() | number:'1.0-6' }} tez\r\n      </p>\r\n      <div class=\"row-group\" style=\"margin: 1.25rem 0 1.5rem;\">\r\n        <input *ngIf=\"!walletService.isLedgerWallet() && !walletService.isTorusWallet()\" [(ngModel)]=\"password\" placeholder=\"Password\" \r\n        autocomplete=\"current-password\" class=\"text password\" type=\"password\" (input)=\"this.pwdValid = ''\" (change)=\"this.pwdValid = ''\" (keydown.enter)='inject()'>\r\n        <button *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\" class=\"blue confirm\" (click)=\"ledgerSign()\">Sign with Ledger</button>\r\n        <ng-template #elseBlock>\r\n          <button class=\"blue confirm\" (click)=\"inject()\" [disabled]=\"walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)\">\r\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : 'Confirm'}}</button>\r\n        </ng-template>\r\n      </div>\r\n      <span *ngIf=\"this.pwdValid\" class=\"danger margin\">{{ this.pwdValid }}</span>\r\n    </div>\r\n  </div>\r\n</div>","import { Component, TemplateRef, OnInit, Input, ViewChild, ElementRef, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { BsModalService } from 'ngx-bootstrap/modal';\r\nimport { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';\r\nimport { KeyPair } from '../../interfaces';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { ExportService } from '../../services/export/export.service';\r\nimport { DelegatorNamePipe } from '../../pipes/delegator-name.pipe';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { LedgerService } from '../../services/ledger/ledger.service';\r\nimport { LedgerWallet, Account, ImplicitAccount, OriginatedAccount, TorusWallet } from '../../services/wallet/wallet';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport Big from 'big.js';\r\n\r\n@Component({\r\n  selector: 'app-delegate',\r\n  templateUrl: './delegate.component.html',\r\n  styleUrls: ['./delegate.component.scss']\r\n})\r\nexport class DelegateComponent implements OnInit, OnChanges {\r\n  modalOpen = false;\r\n  activeView = 0;\r\n  recommendedFee = 0.0004;\r\n  revealFee = 0;\r\n  pkhFee = 0.0004;\r\n  ktFee = 0.0008;\r\n  @ViewChild('toPkhInput') toPkhView: ElementRef;\r\n  @Input() beaconMode = false;\r\n  @Input() operationRequest: any;\r\n  @Output() operationResponse = new EventEmitter();\r\n  @Input() activeAccount: Account;\r\n  implicitAccounts;\r\n  toPkh: string;\r\n  storedDelegate: string;\r\n  fee: string;\r\n  storedFee: string;\r\n  password: string;\r\n  pwdValid: string;\r\n  formInvalid = '';\r\n  sendResponse: any;\r\n  ledgerError = '';\r\n  modalRef1: BsModalRef;\r\n  modalRef2: BsModalRef;\r\n  modalRef3: BsModalRef;\r\n\r\n  constructor(\r\n    private modalService: BsModalService,\r\n    private walletService: WalletService,\r\n    private operationService: OperationService,\r\n    private coordinatorService: CoordinatorService,\r\n    private exportService: ExportService,\r\n    private inputValidationService: InputValidationService,\r\n    private ledgerService: LedgerService,\r\n    private messageService: MessageService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (this.walletService.wallet) {\r\n      this.init();\r\n    }\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (this.beaconMode) {\r\n      if (this.operationRequest) {\r\n        if (this.operationRequest.operationDetails[0].kind === 'delegation') {\r\n          this.openModal();\r\n          if (this.operationRequest.operationDetails[0].delegate) {\r\n            this.toPkh = this.operationRequest.operationDetails[0].delegate;\r\n          } else {\r\n            console.warn('No delegate');\r\n          }\r\n        } else {\r\n          console.log('Not a delegation');\r\n        }\r\n      } else {\r\n        this.operationResponse.emit(null);\r\n      }\r\n    }\r\n  }\r\n  init() {\r\n    this.implicitAccounts = this.walletService.wallet.implicitAccounts;\r\n  }\r\n  openModal() {\r\n    if (this.walletService.wallet) {\r\n      // hide body scrollbar\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflow = 'hidden';\r\n      this.clearForm();\r\n      this.checkReveal();\r\n      this.modalOpen = true;\r\n      if (window.innerWidth > 1300) {\r\n        setTimeout(() => {\r\n          const inputElem = <HTMLInputElement>this.toPkhView.nativeElement;\r\n          inputElem.focus();\r\n        }, 100);\r\n      }\r\n    }\r\n  }\r\n  closeModalAction() {\r\n    this.operationResponse.emit(null);\r\n    this.closeModal();\r\n  }\r\n  closeModal() {\r\n    // restore body scrollbar\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.modalOpen = false;\r\n    this.activeView = 0;\r\n    this.clearForm();\r\n    this.ledgerError = '';\r\n    this.messageService.stopSpinner();\r\n  }\r\n  async openModal2() {\r\n    this.formInvalid = this.invalidInput();\r\n    if (!this.formInvalid) {\r\n      if (!this.fee) { this.fee = this.recommendedFee.toString(); }\r\n      this.storedFee = this.fee;\r\n      this.storedDelegate = this.toPkh;\r\n      this.activeView = 1;\r\n      if (this.walletService.isLedgerWallet()) {\r\n        this.ledgerError = '?';\r\n      }\r\n    }\r\n  }\r\n  async inject() {\r\n    const pwd = this.password;\r\n    this.password = '';\r\n    this.messageService.startSpinner('Signing operation...');\r\n    let keys;\r\n    try {\r\n      keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\r\n    } catch {\r\n      this.messageService.stopSpinner();\r\n    }\r\n    if (this.walletService.isLedgerWallet()) {\r\n      this.broadCastLedgerTransaction();\r\n      this.sendResponse = null;\r\n    } else {\r\n      if (keys) {\r\n        this.pwdValid = '';\r\n        this.messageService.startSpinner('Sending operation...');\r\n        this.sendDelegation(keys);\r\n        this.closeModal();\r\n      } else {\r\n        this.messageService.stopSpinner();\r\n        if (this.walletService.wallet instanceof TorusWallet) {\r\n          this.pwdValid = `Authorization failed`;\r\n        } else {\r\n          this.pwdValid = 'Wrong password!';\r\n        }\r\n      }\r\n    }\r\n  }\r\n  async ledgerSign() {\r\n    const keys = await this.walletService.getKeys('');\r\n    if (keys) {\r\n      this.sendDelegation(keys);\r\n    }\r\n  }\r\n\r\n  close1() {\r\n    this.modalRef1.hide();\r\n    this.modalRef1 = null;\r\n  }\r\n\r\n  close2() {\r\n    this.modalRef2.hide();\r\n    this.modalRef2 = null;\r\n  }\r\n\r\n  close3() {\r\n    this.modalRef3.hide();\r\n    this.modalRef3 = null;\r\n  }\r\n\r\n  async sendDelegation(keys: KeyPair) {\r\n    let fee = this.storedFee;\r\n    this.fee = '';\r\n    if (!fee) {\r\n      fee = '0';\r\n    }\r\n    this.operationService.delegate(this.activeAccount.address, this.getDelegate(), Number(fee), keys).subscribe(\r\n      async (ans: any) => {\r\n        this.sendResponse = ans;\r\n        console.log(JSON.stringify(ans));\r\n        if (ans.success === true) {\r\n          if (ans.payload.opHash) {\r\n            this.operationResponse.emit(ans.payload.opHash);\r\n            const metadata = { delegate: this.getDelegate(), opHash: ans.payload.opHash };\r\n            this.coordinatorService.boost(this.activeAccount.address, metadata);\r\n          } else if (this.walletService.isLedgerWallet()) {\r\n            this.requestLedgerSignature();\r\n          }\r\n        } else {\r\n          this.messageService.stopSpinner();\r\n          console.log('Delegation error id ', ans.payload.msg);\r\n          this.messageService.addError(ans.payload.msg, 0);\r\n          this.operationResponse.emit('broadcast_error');\r\n          if (this.walletService.isLedgerWallet) {\r\n            this.closeModal();\r\n          }\r\n        }\r\n      },\r\n      err => {\r\n        console.log('Error Message ', JSON.stringify(err));\r\n        this.ledgerError = 'Failed to create operation';\r\n      }\r\n    );\r\n  }\r\n  async requestLedgerSignature() {\r\n    if (this.walletService.wallet instanceof LedgerWallet) {\r\n      const op = this.sendResponse.payload.unsignedOperation;\r\n      this.messageService.startSpinner('Waiting for Ledger signature');\r\n      let signature;\r\n      try {\r\n        signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\r\n      } finally {\r\n        this.messageService.stopSpinner();\r\n      }\r\n      if (signature) {\r\n        const signedOp = op + signature;\r\n        this.sendResponse.payload.signedOperation = signedOp;\r\n        console.log(this.sendResponse);\r\n        this.ledgerError = '';\r\n      } else {\r\n        this.ledgerError = 'Failed to sign operation';\r\n      }\r\n    }\r\n  }\r\n  async broadCastLedgerTransaction() {\r\n    this.messageService.startSpinner('Broadcasting operation');\r\n    this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(\r\n      ((ans: any) => {\r\n        this.sendResponse = ans;\r\n        if (ans.success && this.activeAccount.address) {\r\n          const metadata = { delegate: this.getDelegate(), opHash: ans.payload.opHash };\r\n          this.coordinatorService.boost(this.activeAccount.address, metadata);\r\n        } else {\r\n          this.messageService.addError(this.sendResponse.payload.msg, 0);\r\n          this.operationResponse.emit('broadcast_error');\r\n        }\r\n        this.closeModal();\r\n        console.log('ans: ' + JSON.stringify(ans));\r\n      }),\r\n      (error => {\r\n        this.messageService.stopSpinner();\r\n        this.messageService.addError(error, 0);\r\n        this.operationResponse.emit('broadcast_error');\r\n      })\r\n    );\r\n  }\r\n  checkReveal() {\r\n    console.log('check reveal ' + this.activeAccount.pkh);\r\n    this.operationService.isRevealed(this.activeAccount.pkh)\r\n      .subscribe((revealed: boolean) => {\r\n        if (!revealed) {\r\n          this.revealFee = 0.0002;\r\n        } else {\r\n          this.revealFee = 0;\r\n        }\r\n        this.checkSource();\r\n      });\r\n  }\r\n  checkSource() {\r\n    if (this.activeAccount instanceof ImplicitAccount) {\r\n      this.recommendedFee = Number(new Big(this.revealFee).plus(this.pkhFee));\r\n    } else if (this.activeAccount instanceof OriginatedAccount) {\r\n      this.recommendedFee = Number(new Big(this.revealFee).plus(this.ktFee));\r\n    }\r\n  }\r\n  getFee() {\r\n    if (this.fee) {\r\n      return this.fee;\r\n    }\r\n    return this.storedFee;\r\n  }\r\n  getDelegate() {\r\n    if (this.toPkh) {\r\n      return this.toPkh;\r\n    }\r\n    return this.storedDelegate;\r\n  }\r\n  clearForm() {\r\n    this.toPkh = '';\r\n    this.fee = '';\r\n    this.password = '';\r\n    this.pwdValid = '';\r\n    this.formInvalid = '';\r\n    this.sendResponse = '';\r\n    this.ledgerError = '';\r\n  }\r\n  invalidInput(): string {\r\n    if ((!this.inputValidationService.address(this.toPkh) &&\r\n      this.toPkh !== '') || (\r\n        this.toPkh.length > 1 && this.toPkh.slice(0, 2) !== 'tz') || (\r\n        this.walletService.wallet.getImplicitAccount(this.toPkh))) {\r\n      return 'invalid delegate address';\r\n    } else if (!this.inputValidationService.fee(this.fee)) {\r\n      return 'invalid fee';\r\n    } else {\r\n      return '';\r\n    }\r\n  }\r\n  // Only Numbers with Decimals\r\n  keyPressNumbersDecimal(event, input) {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode !== 46 && charCode > 31\r\n      && (charCode < 48 || charCode > 57)) {\r\n      event.preventDefault();\r\n      return false;\r\n    } else if (charCode === 46 && this[input].length === 0) {\r\n      this[input] = '0' + this[input];\r\n    }\r\n    return true;\r\n  }\r\n  download() {\r\n    this.exportService.downloadOperationData(this.sendResponse.payload.unsignedOperation, false);\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-privacy-policy',\r\n  templateUrl: './privacy-policy.component.html',\r\n  styleUrls: ['./privacy-policy.component.scss']\r\n})\r\nexport class PrivacyPolicyComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"legal\">\r\n  <H1>Privacy Policy</H1>\r\n  <H5>Introduction</H5>\r\n  <p>Kukai Wallet (“hereinafter Kukai” “we” “our” “us”) is committed to ensuring the privacy of all our users. We take\r\n    our duty to process your personal data very seriously. This policy represents our commitment to your right to\r\n    privacy, giving you a clear explanation about how we use your information and your rights over that information. We\r\n    strive to be complaint with any data or privacy laws and regulations such as the California Consumer Privacy Act\r\n    (“CCPA”) and General Data Protection and Regulation (“GDPR”).</p>\r\n\r\n  <p>It's possible to use https://kukai.app/ (“hereinafter website”) without submitting any personal information. </p>\r\n\r\n  <H5>Scope of Privacy Policy</H5>\r\n  <p>This privacy policy applies only to your use of our website. Our website and Services may contain links to other\r\n    websites posted by members via images, content such as videos, links to other websites which are not hosted by us.\r\n    Please note that we have no control over how your data is collected, stored, or used by other websites or service\r\n    providers and we advise you to check the privacy policies of any such website(s) before providing any data to them.\r\n  </p>\r\n\r\n  <p>What types of information do we collect and how?\r\n  <p>The type and amount of information we receive and store depends on how you use the website and Services. We do not\r\n    store any information as all data is localized on the User’s computer or device. You can access the website and\r\n    Services without telling us who you are and without revealing any personal information.</p>\r\n\r\n  <p>Data protection laws require us to have a legal justification to process your personal information. We do not\r\n    collect any personally identifiable data from Users, nor do we store or maintain any of such data. All data is\r\n    localized on the User’s computer or device.</p>\r\n\r\n  <H5>Sharing of data</H5>\r\n  <p>In some circumstances your information may be shared with us by third parties, but only where you have specifically\r\n    consented.</p>\r\n\r\n  <p>We never sell user information to anyone.</p>\r\n\r\n  <H6>In order to operate the site, the following data sharing occurs:</H6>\r\n\r\n  <p>Our tech-related service providers may necessarily have access to user data, and could collect/store data beyond\r\n    what Kukai Wallet itself does. Third Party Service providers may or may not include, and are not limited to:\r\n    CoinGecko, Nautilus Cloud, and Tezos Giga Node. Please refer to their respective privacy policies and data\r\n    collection policies.</p>\r\n\r\n  <H5>Other sharing</H5>\r\n  <p>We may also share your personal information with your permission, or if we are legally required to disclose your\r\n    information in circumstances where this cannot be reasonably resisted.</p>\r\n\r\n  <H5>Legal obligation</H5>\r\n  <p>We will process your personal information to fulfil any legal obligations placed upon us, through a lawfully valid\r\n    legal order by a court of competent jurisdiction.</p>\r\n\r\n  <H5>Jurisdiction</H5>\r\n  <p>Our website and Services provided is under U.S. jurisdiction and is subject to U.S. subpoenas, wiretap orders,\r\n    preservation orders (which would negate the above retention rules), and similar. Furthermore, our service\r\n    providers could also be subject to similar orders without our knowledge.</p>\r\n\r\n  <H5>Security</H5>\r\n  <p>We take appropriate security measures to ensure that we keep your limited information secure, accurate and up\r\n    to date. However the transmission of information over the Internet is never completely secure, so while we do\r\n    our best to protect personal information, we cannot guarantee the security of information transmitted to our\r\n    website.</p>\r\n\r\n  <H5>Hosting and processing arrangements</H5>\r\n  <p>Our website is hosted by third party service providers and therefore any personal details you submit through\r\n    them may be processed by that third party service provider. Please see the above for the third party service\r\n    providers.</p>\r\n\r\n  <H5>Retention Period For Data</H5>\r\n  <p>All User data is localized and retained by the User’s computer or device. We do not retain any User\r\n    information.</p>\r\n\r\n  <H5>Complaints</H5>\r\n  <p>If you wish to lodge a complaint about our handling of your personal data please get in touch with us on the\r\n    details above with the details of your complaint; we aim to respond to all complaints within 14 working days.\r\n    All legal requests will be reviewed by our legal department and appropriate action will be taken. If you have a\r\n    legal request, please contact legal@kukai.app</p>\r\n\r\n</div>","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n    name: 'truncate'\r\n})\r\nexport class TruncatePipe implements PipeTransform {\r\n    transform(value?: string, args?: number, endTrail?: boolean): string {\r\n        const limit = args ? args : 3;\r\n        const trail = '...';\r\n\r\n        let returnString;\r\n\r\n        if (endTrail && value.length > limit) {\r\n            const endTrailstring = value.slice(-limit);\r\n            returnString = value.substring(0, limit) + trail + endTrailstring;\r\n\r\n            return returnString;\r\n        } else {\r\n            return value.length > limit ? value.substring(0, limit) + trail : value;\r\n        }\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport 'babel-polyfill';\r\nimport TransportU2F from '@ledgerhq/hw-transport-u2f';\r\nimport Tezos from '@obsidiansystems/hw-app-xtz';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { MessageService } from '../message/message.service';\r\n\r\n@Injectable()\r\nexport class LedgerService {\r\n  transport: any;\r\n  errorMessage = 'U2F browser support is needed for Ledger. Please use Chrome, Opera ' +\r\n    'or Firefox with a U2F extension. Also make sure you\\'re on an HTTPS connection';\r\n  constructor(\r\n    private operationService: OperationService,\r\n    private messageService: MessageService\r\n  ) { }\r\n  async setTransport() {\r\n    if (!this.transport) {\r\n      console.log('Trying to use U2F for transport...');\r\n      try {\r\n        this.transport = await TransportU2F.create();\r\n        console.log('Transport is now set to use U2F!');\r\n      } catch (e) {\r\n        console.log('Couldn\\'t use U2F for transport!');\r\n      }\r\n    }\r\n  }\r\n  async transportCheck() {\r\n    if (!this.transport) {\r\n      await this.setTransport();\r\n    }\r\n    if (!this.transport) {\r\n      this.messageService.addError(this.errorMessage);\r\n    }\r\n  }\r\n  async getPublicAddress(path: string) {\r\n    await this.transportCheck();\r\n    const xtz = new Tezos(this.transport);\r\n    const result = await xtz.getAddress(path, true)\r\n      .catch(e => {\r\n        if (e.message) {\r\n          this.messageService.addError(e.message);\r\n        } else {\r\n          this.messageService.addError(e);\r\n        }\r\n        throw e;\r\n      });\r\n    const pk = this.operationService.hex2pk(result.publicKey);\r\n    return pk;\r\n  }\r\n  async signOperation(op: string, path: string) {\r\n    if (!['03', '05'].includes(op.slice(0, 2))) {\r\n      throw new Error('Invalid prefix');\r\n    }\r\n    await this.transportCheck();\r\n    const xtz = new Tezos(this.transport);\r\n    let result;\r\n    console.log('op', op);\r\n    result = await xtz.signOperation(path, op)\r\n      .catch(e => {\r\n        console.warn(e);\r\n        this.messageService.addError(e, 0);\r\n      });\r\n    console.log(JSON.stringify(result));\r\n    if (result && result.signature) {\r\n      return result.signature;\r\n    }\r\n    return null;\r\n  }\r\n  async signHash(hash: string, path: string) {\r\n    if (hash.length !== 64) {\r\n      throw new Error('Invalid hash!');\r\n    }\r\n    await this.transportCheck();\r\n    const xtz = new Tezos(this.transport);\r\n    let result;\r\n    result = await xtz.signHash(path, hash)\r\n      .catch(e => {\r\n        this.messageService.addError(e, 0);\r\n      });\r\n    console.log(JSON.stringify(result));\r\n    if (result && result.signature) {\r\n      return result.signature;\r\n    }\r\n    return null;\r\n  }\r\n}\r\n","import { Component, OnInit, ViewChild, TemplateRef, Input } from '@angular/core';\r\n\r\nimport { BsModalService } from 'ngx-bootstrap/modal';\r\nimport { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';\r\nimport * as QRCode from 'qrcode';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n\r\n\r\n@Component({\r\n    selector: 'app-receive',\r\n    templateUrl: './receive.component.html',\r\n    styleUrls: ['./receive.component.scss']\r\n})\r\nexport class ReceiveComponent implements OnInit {\r\n    @ViewChild('modal1') modal1: TemplateRef<any>;\r\n    @Input() activeAddress: String;\r\n    showReceiveFormat = {\r\n        btnOutline: true,\r\n        dropdownItem: false,\r\n    };\r\n    modalRef1: BsModalRef;\r\n    modalOpen = false;\r\n    constructor(\r\n        private modalService: BsModalService,\r\n        private messageService: MessageService\r\n    ) { }\r\n\r\n    ngOnInit() {\r\n    }\r\n    openModal() {\r\n      // hide body scrollbar\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflow = 'hidden';\r\n      this.modalOpen = true;\r\n      setTimeout(() => {\r\n        this.getQR();\r\n      }, 100);\r\n    }\r\n    closeModal() {\r\n      // restore body scrollbar\r\n      document.body.style.marginRight = '';\r\n      document.body.style.overflow = '';\r\n      this.modalOpen = false;\r\n    }\r\n    getQR() {\r\n        QRCode.toCanvas(document.getElementById('canvas'), this.activeAddress, { errorCorrectionLevel: 'H' , scaleFactor: 2, color: { light: '#FCFCFC'}}, function (err, canvas) {\r\n            if (err) { throw err; }\r\n        });\r\n    }\r\n\r\n    open1(template1: TemplateRef<any>) {\r\n        if (this.activeAddress) {\r\n            this.modalRef1 = this.modalService.show(template1, { class: 'first' });  // modal-sm / modal-lg\r\n            setTimeout(() => {\r\n                this.getQR();\r\n            }, 100);\r\n        } else {\r\n            this.messageService.add('Select an address first by clicking on it!');\r\n        }\r\n    }\r\n\r\n}\r\n","\r\n<img class=\"qr-icon\" src=\"../../../assets/img/qr.svg\" (click)=\"openModal()\">\r\n<!-- The Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModal()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1>{{ 'RECEIVECOMPONENT.RECEIVETEZ' | translate }}</H1>\r\n    </div>\r\n    <!-- Prepare delegation -->\r\n    <div class=\"km-body\">\r\n      <label>Your account QR code</label>\r\n      <center>\r\n        <canvas id='canvas'></canvas>\r\n      </center>\r\n      <span>{{ activeAddress }}</span>\r\n    </div>\r\n  </div>\r\n</div>","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\n\r\n@Injectable()\r\nexport class TzrateService {\r\n  public apiUrl = 'https://api.coingecko.com/api/v3/simple/price?ids=tezos&vs_currencies=usd';\r\n  constructor(private http: HttpClient,\r\n    private walletService: WalletService) {\r\n  }\r\n\r\n  getTzrate() {\r\n    if (CONSTANTS.MAINNET) {\r\n      this.http.get(this.apiUrl).subscribe(\r\n        (price: any) => {\r\n          this.walletService.wallet.XTZrate = price.tezos.usd;\r\n          this.updateFiatBalances();\r\n        },\r\n        err => console.log('Failed to get xtz price: ' + JSON.stringify(err))\r\n      );\r\n    } else {\r\n      this.walletService.wallet.XTZrate = 0;\r\n      this.updateFiatBalances();\r\n    }\r\n  }\r\n  updateFiatBalances() {\r\n    const accounts = this.walletService.wallet.getAccounts();\r\n    let tot = 0;\r\n    let change = false;\r\n    for (const account of accounts) {\r\n      if (account.balanceXTZ !== null) {\r\n        account.balanceUSD =\r\n          Number(account.balanceXTZ / 1000000 * this.walletService.wallet.XTZrate);\r\n        tot += account.balanceUSD;\r\n        change = true;\r\n      }\r\n    }\r\n    if (change) {\r\n      this.walletService.wallet.totalBalanceUSD = Number(tot);\r\n      this.walletService.storeWallet();\r\n    }\r\n  }\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\r\nimport { Account, Activity, ImplicitAccount, OriginatedAccount } from '../../services/wallet/wallet';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { TimeAgoPipe } from '../../pipes/time-ago.pipe';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport * as copy from 'copy-to-clipboard';\r\nimport { filter } from 'rxjs/internal/operators/filter';\r\nimport { CoordinatorService } from '../../services/coordinator/coordinator.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\nimport { LookupService } from '../../services/lookup/lookup.service';\r\nimport { ActivityService } from '../../services/activity/activity.service';\r\nimport Big from 'big.js';\r\nimport { TokenService, TokenResponseType } from '../../services/token/token.service';\r\n\r\n@Component({\r\n  selector: 'app-account-view',\r\n  templateUrl: './account-view.component.html',\r\n  styleUrls: ['./account-view.component.scss'],\r\n})\r\nexport class AccountViewComponent implements OnInit {\r\n  account: Account;\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private walletService: WalletService,\r\n    public translate: TranslateService,\r\n    public messageService: MessageService,\r\n    public timeAgoPipe: TimeAgoPipe,\r\n    private router: Router,\r\n    private coordinatorService: CoordinatorService,\r\n    private lookupService: LookupService,\r\n    private activityService: ActivityService,\r\n    public tokenService: TokenService\r\n  ) { }\r\n  trigger = true;\r\n  @Input() activity: any;\r\n  ngOnInit(): void {\r\n    if (!this.walletService.wallet) {\r\n      this.router.navigate(['']);\r\n    } else {\r\n      this.coordinatorService.startAll();\r\n      let address = this.route.snapshot.paramMap.get('address');\r\n      if (this.walletService.addressExists(address)) {\r\n        this.account = this.walletService.wallet.getAccount(address);\r\n      }\r\n      this.router.events\r\n        .pipe(filter((evt) => evt instanceof NavigationEnd))\r\n        .subscribe(() => {\r\n          address = this.route.snapshot.paramMap.get('address');\r\n          if (this.walletService.wallet && this.walletService.addressExists(address)) {\r\n            this.account = this.walletService.wallet.getAccount(address);\r\n          }\r\n        });\r\n      setInterval(() => this.trigger = !this.trigger, 1000);\r\n    }\r\n  }\r\n  getType(transaction: Activity): string {\r\n    if (transaction.type !== 'transaction') {\r\n      if (transaction.type === 'delegation') {\r\n        if (transaction.destination.address) {\r\n          return 'delegated';\r\n        } else {\r\n          return 'undelegated';\r\n        }\r\n      } else {\r\n        return transaction.type;\r\n      }\r\n    } else {\r\n      let operationType = '';\r\n      if (transaction.source.address === this.account.address) {\r\n        operationType = 'sent';\r\n      } else {\r\n        operationType = 'received';\r\n      }\r\n      return operationType;\r\n    }\r\n  }\r\n\r\n  getCounterparty(transaction: any): string {\r\n    return this.activityService.getCounterparty(transaction, this.account);\r\n  }\r\n  copy(account: Account) {\r\n    copy(account.address);\r\n    const copyToClipboard = this.translate.instant(\r\n      'OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD'\r\n    );\r\n    this.messageService.add(account.address + ' ' + copyToClipboard, 5);\r\n  }\r\n  explorerURL(hash: string) {\r\n    const baseURL = CONSTANTS.BLOCK_EXPLORER_URL;\r\n    return `${baseURL}/${hash}`;\r\n  }\r\n  printAmount(activity: Activity): string {\r\n    return this.tokenService.formatAmount(activity.tokenId, activity.amount.toString());\r\n  }\r\n  sentKind(activity): string {\r\n    if (activity.entrypoint) {\r\n      return `Called ${activity.entrypoint}`;\r\n    }\r\n    return 'Sent';\r\n  }\r\n  zeroSent(activity) {\r\n    return (this.sentKind(activity).length > 4 && activity.amount === '0');\r\n  }\r\n  receivedKind(activity): string {\r\n    return (activity.tokenId && activity.source.address && (activity.tokenId.split(':')[0] === activity.source.address)) ? 'Minted' : 'Received';\r\n  }\r\n  displayTokenCard(): boolean {\r\n    return (this.account instanceof ImplicitAccount) || (this.account?.tokens?.length > 0);\r\n  }\r\n}\r\n\r\n","<app-header [activeAccount]=\"account\"></app-header>\r\n<div id=\"wrapper\" *ngIf=\"account\">\r\n  <div class=\"left-container\">\r\n    <div class=\"main-container small\" [class.expanded]=\"!displayTokenCard()\">\r\n      <div class=\"top-container\">\r\n        <H1>Account Information</H1>\r\n      </div>\r\n      <div id=\"account-container\">\r\n        <div class=\"mid-container\">\r\n          <div class=\"address-container\">\r\n            <H2 style=\"margin-top: 0\">Address</H2>\r\n            <div class=\"icons\">\r\n              <img class=\"copy-icon\" src=\"../../../assets/img/copy-icon.svg\" (click)=\"copy(account)\">\r\n              <app-receive [activeAddress]=\"account.address\"></app-receive>\r\n            </div>\r\n          </div>\r\n          <span style=\"width: auto; font-size: 0.8125rem\">{{ account.address }}</span>\r\n          <H2>Balance</H2>\r\n          <div style=\"margin-top: 0\"><span>{{ account.balanceXTZ / 1000000 | number: \"1.0-6\" }} tez</span><span\r\n              class=\"mark\">—</span><span class=\"grey\" style=\"font-size: 0.75rem\">{{ account.balanceUSD | number: \"1.0-0\"\r\n              }} USD</span></div>\r\n          <H2>Delegate</H2>\r\n          <app-delegate [activeAccount]=\"account\"></app-delegate>\r\n        </div>\r\n        <div class=\"bottom-container\">\r\n          <app-send [activeAccount]=\"account\"></app-send>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"main-container small\" style=\"margin-top: 2rem\" *ngIf=\"displayTokenCard()\">\r\n      <div class=\"top-container\">\r\n        <H1>Tokens</H1>\r\n      </div>\r\n      <div class=\"token-container\">\r\n        <ng-container *ngIf=\"account.tokens.length; else noTokens\">\r\n          <ng-container *ngFor=\"let token of account.tokens\">\r\n            <div class=\"seperator\"></div>\r\n            <ng-container *ngIf=\"tokenService.getAsset(token.tokenId); else unknownToken; let tokenData\">\r\n              <div class=\"token-row\">\r\n                <app-token [account]=\"account\" [token]=\"tokenData\"></app-token>\r\n                <app-send [activeAccount]=\"account\" [tokenTransfer]=\"token.tokenId\"></app-send>\r\n              </div>\r\n            </ng-container>\r\n            <ng-template #unknownToken>\r\n              <div class=\"token-row\">\r\n                <app-token [account]=\"account\" [token]=\"this.tokenService.getPlaceholderToken(token.tokenId)\">\r\n                </app-token>\r\n              </div>\r\n            </ng-template>\r\n          </ng-container>\r\n        </ng-container>\r\n        <ng-template #noTokens>\r\n          <span class=\"no-tokens\">No tokens found</span>\r\n        </ng-template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"main-container large\">\r\n    <div class=\"top-container\">\r\n      <H1 style=\"float:left\">Recent Activity</H1>\r\n      <a class=\"view-all\" href=\"{{ explorerURL(account.address) }}\" target=\"_blank\">View in explorer</a>\r\n    </div>\r\n    <div id=\"operations-container\" *ngIf=\"this.translate.store.translations.en\">\r\n      <ng-container *ngIf=\"!account.activities.length\">\r\n        <div class=\"line\"><span>No transactions yet</span></div>\r\n      </ng-container>\r\n      <ng-container *ngFor=\"let activity of account.activities | slice:0:5\">\r\n        <ng-container [ngSwitch]=\"getType(activity)\">\r\n          <ng-template #CounterpartyRef let-myactivity>\r\n            <span class=\"grey truncate-overflow\">\r\n              <ng-container *ngIf=\"myactivity.name; else elseBlock\">\r\n                <ng-container [ngSwitch]=\"myactivity.lookupType\">\r\n                  <img *ngSwitchCase=\"2\" height=\"12\" src=\"../../../assets/img/google-logo.svg\">\r\n                  <img *ngSwitchCase=\"3\" height=\"12\" src=\"../../../assets/img/reddit-logo.svg\">\r\n                  <img *ngSwitchCase=\"4\" height=\"12\" src=\"../../../assets/img/twitter-logo.svg\">\r\n                </ng-container>\r\n                &nbsp;{{ myactivity.name }}\r\n              </ng-container>\r\n              <ng-template #elseBlock>{{ myactivity.address }}</ng-template>\r\n            </span>\r\n          </ng-template>\r\n          <div *ngSwitchCase=\"'sent'\" class=\"sent\">\r\n            <img *ngIf=\"!zeroSent(activity)\" src=\"../../../assets/img/sent.svg\">\r\n            <img *ngIf=\"zeroSent(activity)\" src=\"../../../assets/img/sent-zero.svg\">\r\n            <div>\r\n              <div class=\"line\"><span class=\"black\" [class.red]=\"!zeroSent(activity)\" [class.black]=\"zeroSent(activity)\">{{ sentKind(activity) }}<ng-container *ngIf=\"activity?.amount !== '0'\"> {{ printAmount(activity) }}</ng-container></span><a\r\n                  href=\"{{ explorerURL(activity.hash) }}\" target=\"_blank\">\r\n                  <ng-container *ngIf=\"activity.status > 0\">{{ activity.timestamp | timeAgo:trigger }}</ng-container>\r\n                  <ng-container *ngIf=\"activity.status === 0\">Unconfirmed</ng-container>\r\n                </a></div>\r\n              <div class=\"line\"><span class=\"grey\">To —</span>\r\n                <ng-template [ngTemplateOutlet]=\"CounterpartyRef\"\r\n                  [ngTemplateOutletContext]=\"{ $implicit: getCounterparty(activity) }\"></ng-template>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngSwitchCase=\"'received'\" class=\"received\">\r\n            <img src=\"../../../assets/img/received.svg\">\r\n            <div>\r\n              <div class=\"line\"><span class=\"green\">{{ receivedKind(activity) }} {{ printAmount(activity) }}</span><a\r\n                  href=\"{{ explorerURL(activity.hash) }}\" target=\"_blank\">\r\n                  <ng-container *ngIf=\"activity.status > 0\">{{ activity.timestamp | timeAgo:trigger }}</ng-container>\r\n                  <ng-container *ngIf=\"activity.status === 0\">Unconfirmed</ng-container>\r\n                </a></div>\r\n              <div class=\"line\"><span class=\"grey\">From —</span>\r\n                <ng-template [ngTemplateOutlet]=\"CounterpartyRef\"\r\n                  [ngTemplateOutletContext]=\"{ $implicit: getCounterparty(activity) }\"></ng-template>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngSwitchCase=\"'delegated'\" class=\"delegated\">\r\n            <img src=\"../../../assets/img/delegated.svg\">\r\n            <div>\r\n              <div class=\"line\"><span class=\"blue\">Delegated</span><a href=\"{{ explorerURL(activity.hash) }}\"\r\n                  target=\"_blank\">\r\n                  <ng-container *ngIf=\"activity.status > 0\">{{ activity.timestamp | timeAgo:trigger }}</ng-container>\r\n                  <ng-container *ngIf=\"activity.status === 0\">Unconfirmed</ng-container>\r\n                </a></div>\r\n              <div class=\"line\"><span class=\"grey\">To —</span>\r\n                <ng-template [ngTemplateOutlet]=\"CounterpartyRef\"\r\n                  [ngTemplateOutletContext]=\"{ $implicit: getCounterparty(activity) }\"></ng-template>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngSwitchCase=\"'undelegated'\" class=\"delegated\">\r\n            <img src=\"../../../assets/img/delegated.svg\">\r\n            <div>\r\n              <div class=\"line\"><span class=\"blue\">Undelegated</span><a href=\"{{ explorerURL(activity.hash) }}\"\r\n                  target=\"_blank\">\r\n                  <ng-container *ngIf=\"activity.status > 0\">{{ activity.timestamp | timeAgo:trigger }}</ng-container>\r\n                  <ng-container *ngIf=\"activity.status === 0\">Unconfirmed</ng-container>\r\n                </a></div>\r\n              <div class=\"line\"><span class=\"grey\">To —</span>\r\n                <ng-template [ngTemplateOutlet]=\"CounterpartyRef\"\r\n                  [ngTemplateOutletContext]=\"{ $implicit: getCounterparty(activity) }\"></ng-template>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div *ngSwitchDefault>\r\n            <div style=\"padding-left: 0.75rem\">\r\n              <div class=\"line\"><span class=\"black\">{{ getType(activity) | titlecase }}</span><a\r\n                  href=\"{{ explorerURL(activity.hash) }}\" target=\"_blank\">\r\n                  <ng-container *ngIf=\"activity.status > 0\">{{ activity.timestamp | timeAgo:trigger }}</ng-container>\r\n                  <ng-container *ngIf=\"activity.status === 0\">Unconfirmed</ng-container>\r\n                </a></div>\r\n              <div class=\"line\"><span class=\"grey\">Counterparty —</span>\r\n                <ng-template [ngTemplateOutlet]=\"CounterpartyRef\"\r\n                  [ngTemplateOutletContext]=\"{ $implicit: getCounterparty(activity) }\"></ng-template>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </ng-container>\r\n    </div>\r\n  </div>\r\n</div>","export type WalletObject =\r\n  LegacyWalletV1\r\n  | LegacyWalletV2\r\n  | LegacyWalletV3\r\n  | LedgerWallet\r\n  | HdWallet\r\n  | TorusWallet;\r\n\r\nexport class Wallet {\r\n  totalBalanceXTZ: number | null;\r\n  totalBalanceUSD: number | null;\r\n  XTZrate: number | null;\r\n  implicitAccounts: ImplicitAccount[];\r\n  lookups: any[];\r\n  constructor() {\r\n    this.totalBalanceXTZ = null;\r\n    this.totalBalanceUSD = null;\r\n    this.XTZrate = null;\r\n    this.implicitAccounts = [];\r\n    this.lookups = [];\r\n  }\r\n  getAccounts(): Account[] {\r\n    const accounts: Account[] = [];\r\n    if (this.implicitAccounts.length) {\r\n      for (const implicitAccount of this.implicitAccounts) {\r\n        accounts.push(implicitAccount);\r\n        if (implicitAccount.originatedAccounts.length) {\r\n          for (const originatedAccount of implicitAccount.originatedAccounts) {\r\n            accounts.push(originatedAccount);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return accounts;\r\n  }\r\n  getImplicitAccounts(): ImplicitAccount[] {\r\n    return this.implicitAccounts;\r\n  }\r\n  getAccount(address: string): Account {\r\n    if (this.implicitAccounts.length) {\r\n      for (const implicitAccount of this.implicitAccounts) {\r\n        if (implicitAccount.address === address) {\r\n          return implicitAccount;\r\n        }\r\n        if (implicitAccount.originatedAccounts.length) {\r\n          for (const originatedAccount of implicitAccount.originatedAccounts) {\r\n            if (originatedAccount.address === address) {\r\n              return originatedAccount;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  getImplicitAccount(pkh: string): ImplicitAccount {\r\n    if (this.implicitAccounts.length) {\r\n      for (const implicitAccount of this.implicitAccounts) {\r\n        if (implicitAccount.pkh === pkh) {\r\n          return implicitAccount;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n}\r\n\r\nexport class FullWallet extends Wallet {\r\n  encryptedSeed: string;\r\n  constructor(encryptedSeed: string) {\r\n    super();\r\n    this.encryptedSeed = encryptedSeed;\r\n  }\r\n}\r\n\r\nexport class LegacyWalletV1 extends FullWallet {\r\n  salt: string;\r\n  constructor(salt: string, encrypedSeed: string) {\r\n    super(encrypedSeed);\r\n    this.salt = salt;\r\n  }\r\n}\r\n\r\nexport class LegacyWalletV2 extends FullWallet {\r\n  IV: string;\r\n  constructor(IV: string, encryptedSeed: string) {\r\n    super(encryptedSeed);\r\n    this.IV = IV;\r\n  }\r\n}\r\n\r\nexport class LegacyWalletV3 extends FullWallet {\r\n  encryptedEntropy: string;\r\n  IV: string;\r\n  constructor(IV: string, encryptedSeed: string, encryptedEntropy: string) {\r\n    super(encryptedSeed);\r\n    this.IV = IV;\r\n    this.encryptedEntropy = encryptedEntropy;\r\n  }\r\n}\r\n\r\nexport class HdWallet extends FullWallet {\r\n  encryptedEntropy: string;\r\n  IV: string;\r\n  index: number;\r\n  constructor(IV: string, encryptedSeed: string, encryptedEntropy: string) {\r\n    super(encryptedSeed);\r\n    this.encryptedEntropy = encryptedEntropy;\r\n    this.IV = IV;\r\n    this.index = 0;\r\n  }\r\n}\r\n\r\nexport class TorusWallet extends Wallet {\r\n  verifier: string;\r\n  id: string;\r\n  name: string;\r\n  constructor(verifier: string, id: string, name: string) {\r\n    super();\r\n    this.verifier = verifier;\r\n    this.id = id;\r\n    this.name = name;\r\n  }\r\n  displayName() {\r\n    if (this.verifier === 'twitter') {\r\n      return this.name;\r\n    }\r\n    return this.id;\r\n  }\r\n}\r\nexport class EmbeddedTorusWallet extends TorusWallet {\r\n    origin: string;\r\n    sk: string;\r\n    instanceId: string;\r\n    constructor(verifier: string, id: string, name: string, origin: string, sk: string, instanceId: string) {\r\n      super(verifier, id, name);\r\n      this.origin = origin;\r\n      this.sk = sk;\r\n      this.instanceId = instanceId;\r\n    }\r\n}\r\nexport class LedgerWallet extends Wallet {\r\n  constructor() {\r\n    super();\r\n  }\r\n}\r\n\r\n// Accounts\r\n\r\nexport abstract class Account {\r\n  balanceXTZ: number | null;\r\n  balanceUSD: number | null;\r\n  delegate: string;\r\n  state: string;\r\n  activities: Activity[];\r\n  tokens: Token[] = [];\r\n  pkh: string;\r\n  pk: string;\r\n  address: string;\r\n  constructor(pkh: string, pk: string, address: string) {\r\n    this.balanceXTZ = null;\r\n    this.balanceUSD = null;\r\n    this.delegate = '';\r\n    this.state = '';\r\n    this.activities = [];\r\n    this.pkh = pkh;\r\n    this.pk = pk;\r\n    this.address = address;\r\n  }\r\n  public abstract isImplicit(): boolean;\r\n  shortAddress(): string {\r\n    return this.address.slice(0, 7) + '...' + this.address.slice(-4);\r\n  }\r\n  getTokenBalance(tokenId: string): string {\r\n    if (this.tokens.length) {\r\n      for (const token of this.tokens) {\r\n        if (tokenId === token.tokenId) {\r\n          return token.balance;\r\n        }\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  updateTokenBalance(tokenId: string, balance: string) {\r\n    if (this.tokens.length) {\r\n      for (let i = 0; i < this.tokens.length; i++) {\r\n        if (tokenId === this.tokens[i].tokenId) {\r\n          if (this.tokens[i].balance !== balance) {\r\n            if (balance === '0' || (balance && balance.slice(0, 1) === '-')) {\r\n              this.tokens.splice(i, 1);\r\n            } else {\r\n              this.tokens[i].balance = balance;\r\n            }\r\n          }\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    if (tokenId.length > 37 && balance && balance !== '0' && balance.slice(0, 1) !== '-') {\r\n      this.tokens.push({ tokenId, balance});\r\n    }\r\n  }\r\n}\r\n\r\nexport class ImplicitAccount extends Account {\r\n  originatedAccounts: OriginatedAccount[];\r\n  derivationPath?: string;\r\n  constructor(pkh: string, pk: string, derivationPath?: string) {\r\n    super(pkh, pk, pkh);\r\n    this.originatedAccounts = [];\r\n    if (derivationPath) {\r\n      this.derivationPath = derivationPath;\r\n    }\r\n  }\r\n  isImplicit(): boolean {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport class OriginatedAccount extends Account {\r\n  constructor(ktAddress: string, managerPkh: string, managerPk: string) {\r\n    super(managerPkh, managerPk, ktAddress);\r\n  }\r\n  isImplicit(): boolean {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport class Activity {\r\n  type: string;\r\n  block: string;\r\n  status: number; // 0: unconfirmed, 1: confirmed, -1: failed\r\n  amount: string;\r\n  source: {\r\n    address: string,\r\n    alias?: string\r\n  };\r\n  destination: {\r\n    address: string,\r\n    alias?: string\r\n  };\r\n  fee?: string;\r\n  hash: string;\r\n  timestamp: number | null;\r\n  tokenId?: string;\r\n  entrypoint?: string;\r\n}\r\nexport class Token {\r\n  tokenId: string;\r\n  balance: string;\r\n}\r\n","\r\n<button (click)=\"openModal()\">Scan QR code</button>\r\n<!-- The Modal -->\r\n<div *ngIf=\"modalOpen\" id=\"myModal\" class=\"kukai-modal\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"closeModal()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n    </div>\r\n    <div class=\"km-body\">\r\n      <label>Scan QR code from dApp</label>\r\n      <div class=\"video-container\">\r\n        <video #videoPlayer>\r\n          Browser not supported\r\n        </video>\r\n        <p class=\"no-cam\" *ngIf=\"!qrScanner\">No camera detected</p>\r\n      </div>\r\n      <input *ngIf=\"!CONSTANTS.MAINNET\" type=\"text\" [(ngModel)]=\"manualInput\" class=\"text\" style=\"margin-top: 1rem\" (paste)=\"handlePaste($event)\" placeholder=\"...or paste pairing string here\">\r\n    </div>\r\n  </div>\r\n</div>","import { Component, OnInit, ViewChild, TemplateRef, Input, ElementRef } from '@angular/core';\r\nimport { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';\r\nimport { BeaconService } from '../../services/beacon/beacon.service';\r\nimport QrScanner from 'qr-scanner';\r\nimport { DeeplinkService } from '../../services/deeplink/deeplink.service';\r\nimport { CONSTANTS as _CONSTANTS } from '../../../environments/environment';\r\nimport { MessageService } from '../../services/message/message.service';\r\n\r\n@Component({\r\n  selector: 'app-qr-scanner',\r\n  templateUrl: './qr-scanner.component.html',\r\n  styleUrls: ['./qr-scanner.component.scss']\r\n})\r\nexport class QrScannerComponent implements OnInit {\r\n  readonly CONSTANTS = _CONSTANTS;\r\n  constructor(\r\n    private beaconService: BeaconService,\r\n    private deeplinkService: DeeplinkService,\r\n    private messageService: MessageService\r\n  ) { }\r\n  @ViewChild('videoPlayer') videoplayer: ElementRef;\r\n  modalRef1: BsModalRef;\r\n  modalOpen = false;\r\n  qrScanner: QrScanner;\r\n  manualInput = '';\r\n  ngOnInit() {\r\n  }\r\n  openModal() {\r\n    // hide body scrollbar\r\n    const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n    document.body.style.marginRight = scrollBarWidth.toString();\r\n    document.body.style.overflow = 'hidden';\r\n    this.modalOpen = true;\r\n    this.scan();\r\n  }\r\n  async scan() {\r\n    const hasCamera = await QrScanner.hasCamera();\r\n    if (hasCamera) {\r\n      QrScanner.WORKER_PATH = './assets/js/qr-scanner-worker.min.js';\r\n      this.qrScanner = new QrScanner(this.videoplayer.nativeElement, result => this.handleQrCode(result));\r\n      await this.qrScanner.start();\r\n    } else {\r\n      console.warn('no camera found');\r\n    }\r\n  }\r\n  handleQrCode(pairInfo: string) {\r\n    console.log('Pairing Info', pairInfo);\r\n    const pairingInfo = this.deeplinkService.QRtoPairingJson(pairInfo);\r\n    if (pairingInfo) {\r\n      this.beaconService.preNotifyPairing(pairingInfo);\r\n      this.beaconService.addPeer(pairingInfo);\r\n    }\r\n    this.closeModal();\r\n  }\r\n  handlePaste(ev: ClipboardEvent) {\r\n    const pairingString = ev?.clipboardData?.getData('text');\r\n    const pairingInfo = pairingString ? this.deeplinkService.QRtoPairingJson(pairingString) : '';\r\n    if (pairingInfo) {\r\n      this.beaconService.preNotifyPairing(pairingInfo);\r\n      this.beaconService.addPeer(pairingInfo);\r\n      this.closeModal();\r\n    } else {\r\n      this.messageService.addError('Invalid Base58 checksum!');\r\n    }\r\n  }\r\n  closeModal() {\r\n    // restore body scrollbar\r\n    if (this.qrScanner) {\r\n      this.qrScanner.stop();\r\n    }\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.modalOpen = false;\r\n    this.manualInput = '';\r\n  }\r\n\r\n}\r\n","import { Component, OnInit, HostBinding } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core'; // Multiple instances created ?\r\nimport { ImportService } from '../../services/import/import.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { ExportService } from '../../services/export/export.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { utils, hd } from '@tezos-core-tools/crypto-utils';\r\n\r\n@Component({\r\n  selector: 'app-mnemonic-import-wallet',\r\n  templateUrl: './mnemonic-import.component.html',\r\n  styleUrls: ['./mnemonic-import.component.scss']\r\n})\r\nexport class MnemonicImportComponent implements OnInit {\r\n  @HostBinding('class.tacos') showTacos = false;\r\n  MIN_PWD_LENGTH = 9;\r\n  mnemonic: string;\r\n  email: string;\r\n  password: string;\r\n  passphrase: string;\r\n  pkh: string;\r\n  importOption = 0;\r\n  activePanel = 0;\r\n  hdImport = false;\r\n  wallet: any;\r\n  walletJson: string;\r\n  pwd = '';\r\n  pwd1: string;\r\n  pwd2: string;\r\n  pwdStrength = '';\r\n  Downloaded = false;\r\n  fileName = '';\r\n  showWrongFileUploadMsg: false;\r\n  firefox = false;\r\n\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private importService: ImportService,\r\n    private router: Router,\r\n    private messageService: MessageService,\r\n    private walletService: WalletService,\r\n    private exportService: ExportService,\r\n    private inputValidationService: InputValidationService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.checkBrowser();\r\n  }\r\n  checkBrowser() {\r\n    try {\r\n      if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\r\n        this.firefox = true;\r\n      }\r\n    } catch (e) {\r\n      console.warn(e);\r\n    }\r\n  }\r\n  retrieve() {\r\n    if (this.mnemonic) {\r\n      this.mnemonic = this.mnemonic.toLowerCase().replace(/(\\r\\n|\\n|\\r)/gm, ' ').trim();\r\n    }\r\n    if (this.importOption === 2) {\r\n      this.passphrase = this.email + this.password;\r\n    }\r\n    if (!this.inputValidationService.mnemonics(this.mnemonic)) {\r\n      this.translate\r\n        .get('MNEMONICIMPORTCOMPONENT.INVALIDMNEMONIC')\r\n        .subscribe((res: string) => this.messageService.addWarning(res, 10));\r\n    } else if (\r\n      this.importOption === 2 &&\r\n      !this.inputValidationService.email(this.email)\r\n    ) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDEMAIL').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // 'Invalid email!'\r\n      );\r\n    } else if (this.importOption === 2 && !this.password) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPASSWORD').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // 'Invalid password!'\r\n      );\r\n    } else if (!this.inputValidationService.passphrase(this.passphrase)) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPASSPHRASE').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // 'Invalid passphrase!'\r\n      );\r\n    } else if (this.pkh && !this.inputValidationService.address(this.pkh)) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPKH').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // 'Invalid public key hash!'\r\n      );\r\n    } else {\r\n      let pkh = '';\r\n      if (this.pkh) {\r\n        if (this.importOption === 1 && this.hdImport) {\r\n          pkh = hd.keyPairFromAccountIndex(\r\n            utils.mnemonicToSeed(this.mnemonic, this.passphrase, true),\r\n            0\r\n          ).pkh;\r\n        } else {\r\n          pkh = utils.seedToKeyPair(\r\n            utils.mnemonicToSeed(this.mnemonic, this.passphrase, false)\r\n          ).pkh;\r\n        }\r\n      }\r\n      if (this.pkh && pkh !== this.pkh) {\r\n        if (this.importOption === 2) {\r\n          this.translate\r\n            .get('MNEMONICIMPORTCOMPONENT.INVALIDEMAILPASSWORD')\r\n            .subscribe((res: string) => this.messageService.addWarning(res, 5));\r\n        } else {\r\n          this.translate\r\n            .get('MNEMONICIMPORTCOMPONENT.INVALIDPASSPHRASE')\r\n            .subscribe((res: string) => this.messageService.addWarning(res, 5));\r\n        }\r\n      } else {\r\n        this.activePanel++;\r\n      }\r\n    }\r\n  }\r\n  async setPwd() {\r\n    if (this.validPwd()) {\r\n      const password = this.pwd1;\r\n      this.pwd1 = '';\r\n      this.pwd2 = '';\r\n      await this.messageService.startSpinner('Encrypting wallet...');\r\n      try {\r\n        this.wallet = await this.walletService.createEncryptedWallet(\r\n          this.mnemonic,\r\n          password,\r\n          this.passphrase,\r\n          this.importOption === 1 && this.hdImport\r\n        );\r\n      } finally {\r\n        this.messageService.stopSpinner();\r\n      }\r\n      this.mnemonic = '';\r\n      this.passphrase = '';\r\n      this.email = '';\r\n      this.password = '';\r\n      this.activePanel++;\r\n      if (document.body.offsetWidth >= 480) {\r\n        this.showTacos = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  validPwd(): boolean {\r\n    if (!this.inputValidationService.password(this.pwd1)) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.PASSWORDWEAK').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // 'Password is too weak!'\r\n      );\r\n      return false;\r\n    } else if (this.pwd1 !== this.pwd2) {\r\n      this.translate.get('MNEMONICIMPORTCOMPONENT.NOMATCHPASSWORDS').subscribe(\r\n        (res: string) => this.messageService.addWarning(res, 10) // Passwords don't match!\r\n      );\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n  calcStrength() {\r\n    this.pwdStrength = this.inputValidationService.passwordStrengthDisplay(\r\n      this.pwd1\r\n    );\r\n  }\r\n  export(): string {\r\n    return JSON.stringify(this.wallet.data);\r\n  }\r\n  showPkh(): string {\r\n    return this.wallet.pkh;\r\n  }\r\n  download() {\r\n    this.exportService.downloadWallet(this.wallet.data);\r\n    this.Downloaded = true;\r\n  }\r\n  async done() {\r\n    await this.messageService.startSpinner('Loading wallet...');\r\n    try {\r\n      await this.importService.importWalletFromObject(\r\n        this.wallet.data,\r\n        this.wallet.seed\r\n      );\r\n    } finally {\r\n      this.messageService.stopSpinner();\r\n    }\r\n    this.wallet = null;\r\n    if (this.walletService.wallet.implicitAccounts.length === 1 && this.walletService.wallet.implicitAccounts[0].originatedAccounts.length === 0) {\r\n      this.router.navigate([`/account/${this.walletService.wallet.implicitAccounts[0].address}`]);\r\n    } else {\r\n      this.router.navigate(['/accounts']);\r\n    }\r\n    this.translate\r\n      .get('MNEMONICIMPORTCOMPONENT.WALLETREADY')\r\n      .subscribe((res: string) => this.messageService.addSuccess(res));\r\n  }\r\n  /* Keystore handling */\r\n  importPreCheck(keyFile: string) {\r\n    this.typeCheckFile(keyFile);\r\n    if (this.importService.pwdRequired(keyFile)) {\r\n      this.walletJson = keyFile;\r\n    } else {\r\n      throw new Error('Unsupported wallet file');\r\n    }\r\n  }\r\n  typeCheckFile(keyFile: string) {\r\n    const obj = JSON.parse(keyFile);\r\n    // Required\r\n    try {\r\n      if (typeof obj.provider !== 'string') {\r\n        throw new Error('provider not a string!');\r\n      }\r\n      if (typeof obj.version !== 'number') {\r\n        throw new Error('version not a number!');\r\n      }\r\n      if (typeof obj.walletType !== 'number') {\r\n        throw new Error('walletType not a number!');\r\n      }\r\n      // Optional\r\n      if (obj.encryptedSeed && typeof obj.encryptedSeed !== 'string') {\r\n        throw new Error('encryptedSeed not a string!');\r\n      }\r\n      if (obj.pkh && typeof obj.pkh !== 'string') {\r\n        throw new Error('pkh not a string!');\r\n      }\r\n      if (obj.iv && typeof obj.iv !== 'string') {\r\n        throw new Error('iv not a string!');\r\n      }\r\n      if (obj.pk && typeof obj.pk !== 'string') {\r\n        throw new Error('pk not a string!');\r\n      }\r\n      if (obj.encryptedEntropy && typeof obj.encryptedEntropy !== 'string') {\r\n        throw new Error('encryptedEntropy not a string!');\r\n      }\r\n    } catch (e) {\r\n      this.messageService.addError(e);\r\n      throw e;\r\n    }\r\n  }\r\n  async checkImportPwd() {\r\n    if (this.pwd) {\r\n      await this.messageService.startSpinner('Importing wallet...');\r\n      try {\r\n        await this.import(this.walletJson, this.pwd);\r\n        this.pwd = '';\r\n      } finally {\r\n        this.messageService.stopSpinner();\r\n      }\r\n    } else {\r\n      this.messageService.addWarning('No password provided', 5);\r\n    }\r\n  }\r\n  async import(keyFile: string, pwd: string) {\r\n    this.typeCheckFile(keyFile);\r\n    await this.importService\r\n      .importWalletFromJson(keyFile, pwd)\r\n      .then((success: boolean) => {\r\n        if (success) {\r\n          if (this.walletService.wallet.implicitAccounts.length === 1 && this.walletService.wallet.implicitAccounts[0].originatedAccounts.length === 0) {\r\n            this.router.navigate([`/account/${this.walletService.wallet.implicitAccounts[0].address}`]);\r\n          } else {\r\n            this.router.navigate(['/accounts']);\r\n          }\r\n        } else {\r\n          console.log(success);\r\n          this.messageService.addError('Something went wrong');\r\n        }\r\n      }).catch((e) => {\r\n        this.messageService.addError(e);\r\n      });\r\n  }\r\n  handleFileInput(files: FileList) {\r\n    let fileToUpload = files.item(0);\r\n    if (!fileToUpload) {\r\n      return false;\r\n    } else if (!this.validateFile(fileToUpload.name)) {\r\n      let fileNotSupported = '';\r\n      this.translate\r\n        .get('IMPORTCOMPONENT.FILENOTSUPPORTED')\r\n        .subscribe((res: string) => (fileNotSupported = res));\r\n      this.messageService.add(fileNotSupported);\r\n\r\n      console.log('Selected file format is not supported');\r\n      fileToUpload = null;\r\n      this.walletJson = null;\r\n      return false;\r\n    } else {\r\n\r\n      const reader = new FileReader();\r\n      reader.readAsText(fileToUpload);\r\n      reader.onload = () => {\r\n        if (typeof reader.result === 'string') {\r\n          try {\r\n            this.importPreCheck(reader.result);\r\n          } catch (e) {\r\n            this.messageService.addError(e, 5);\r\n            this.walletJson = null;\r\n          }\r\n          if (this.walletJson) {\r\n            this.fileName = fileToUpload.name;\r\n          }\r\n        } else {\r\n          this.walletJson = null;\r\n          throw new Error('Not a string import');\r\n        }\r\n      };\r\n    }\r\n  }\r\n  validateFile(name: String) {\r\n    const ext = name.substring(name.lastIndexOf('.') + 1);\r\n    if (ext.toLowerCase() === 'tez' || ext.toLowerCase() === 'json') {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","<div class=\"kukai-card\">\r\n  <div *ngIf=\"activePanel === 0\">\r\n      <H1>Import wallet</H1>\r\n      <div class=\"import-options\">\r\n          <span [class.selected]=\"importOption===0\" (click)=\"importOption = 0\">Keystore File</span>\r\n          <span [class.selected]=\"importOption===1\" (click)=\"importOption = 1\">Seed Words</span>\r\n          <span [class.selected]=\"importOption===2\" (click)=\"importOption = 2\">Fundraiser</span>\r\n      </div>\r\n      <div class=\"grey-card menu\">\r\n        <ng-container *ngIf=\"importOption === 0\">\r\n            <p class=\"description bold\" style=\"font-size: 1rem\">\r\n                Import your wallet from an encrypted keystore file (.tez).\r\n            </p>\r\n            <input type=\"file\" (change)=\"handleFileInput($event.target.files)\" accept=\".tez{{ firefox ? ', application/json' : '' }}\" id=\"file\" name=\"file\"\r\n                class=\"input-file\">\r\n            <label for=\"file\" class=\"input-file\" [class.loaded]=\"walletJson\"><span\r\n                    *ngIf=\"walletJson\">{{ fileName }}</span><span>Browse</span></label>\r\n            <div class=\"authenticate\" *ngIf=\"walletJson\">\r\n                <input type=\"password\" class=\"text\" autocomplete=\"current-password\" (keydown.enter)='checkImportPwd()' id=\"pwd\" [(ngModel)]=\"pwd\"\r\n                    placeholder=\"Password\">\r\n                </div>\r\n                <div class=\"buttons\">\r\n                  <a routerLink=\"/\">\r\n                      <button class=\"button back\">Back</button>\r\n                  </a>\r\n                  <button class=\"button next\" [class.disabled-button]=\"!walletJson || !pwd\" (click)='checkImportPwd()'>Import</button>\r\n              </div>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"importOption > 0\">\r\n            <p class=\"description faucet\" *ngIf=\"importOption === 2\"><span>Please make sure to first <a routerLink=\"/activate\">activate</a> your fundraiser wallet.</span></p>\r\n            <ng-container>\r\n                <small>The seed (12-24 words)</small>\r\n                <textarea class=\"text\" [(ngModel)]=\"mnemonic\" autocomplete=\"off\" [placeholder]=\"'Seed Words (required)'\"></textarea>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"importOption === 1\">\r\n                <small>If your seed words are protected by a passphrase, it needs to be entered here</small>\r\n                <input class=\"text\" type=\"password\" name=\"passphrase\" autocomplete=\"one-time-code\" [(ngModel)]=\"passphrase\" [placeholder]=\"'Passphrase (optional)'\">\r\n            </ng-container>\r\n            <ng-container *ngIf=\"importOption === 2\">\r\n                <small>The email used during the fundraiser</small>\r\n                <input class=\"text\" type=\"text\" [(ngModel)]=\"email\" [placeholder]=\"'Email (required)'\">\r\n                <small>The password you chose during the fundraiser</small>\r\n                <input class=\"text\" type=\"password\" name=\"tge-password\" autocomplete=\"one-time-code\" [(ngModel)]=\"password\" [placeholder]=\"'Password (required)'\">\r\n            </ng-container>\r\n            <ng-container>\r\n                <small *ngIf=\"importOption === 1\">{{ 'MNEMONICIMPORTCOMPONENT.INFOPKH' | translate }}</small>\r\n                <small *ngIf=\"importOption === 2\">{{ 'MNEMONICIMPORTCOMPONENT.INFOPKHICO' | translate }}</small>\r\n                <input type=\"text\" class=\"text\" [(ngModel)]=\"pkh\" [placeholder]=\"'tz1... (recomended)'\">\r\n            </ng-container>\r\n            <div class=\"radios\" *ngIf=\"importOption === 1\">\r\n                <div>\r\n                    <input (change)=\"hdImport = !hdImport\" type=\"radio\" name=\"walletType\" value=\"legacy\" checked>\r\n                    <small>Legacy wallet</small>\r\n                </div>\r\n                <div>\r\n                    <input (change)=\"hdImport = !hdImport\" type=\"radio\" name=\"walletType\" value=\"hd\">\r\n                    <small>HD wallet</small>\r\n                </div>\r\n            </div>\r\n            <div class=\"buttons\">\r\n                <a routerLink=\"/\">\r\n                    <button class=\"button back\">Back</button>\r\n                </a>\r\n                <button class=\"button next\" (click)=\"retrieve()\">Import</button>\r\n            </div>\r\n        </ng-container>\r\n      </div>\r\n  </div>\r\n  <!-- Step 2 -->\r\n  <div *ngIf=\"activePanel==1\">\r\n      <H1>Set a password</H1>\r\n      <div class=\"grey-card\">\r\n        <p class=\"description bold blue\">This password will be used to create an encrypted keystore file.</p>\r\n        <p class=\"description\" style=\"margin-top: 1.25rem\">When performing operations that need to be signed with your secret key, this password will be required</p>\r\n        <input type=\"password\" style=\"margin-top: 2.5rem\" class=\"text\" autocomplete=\"new-password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.PASSWORD' | translate }}\" [(ngModel)]=\"pwd1\" (keyup)=\"calcStrength()\">\r\n        <small class=\"grey\" style=\"margin-top: 0.5rem\"> {{ 'NEWWALLETCOMPONENT.PASSWORDSTRENGTH' | translate }} — {{ pwdStrength }}</small>\r\n        <input type=\"password\" style=\"margin-top: 1.5rem\" class=\"text\" autocomplete=\"new-password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.CONFIRMPASSWORD' | translate }}\" [(ngModel)]=\"pwd2\">\r\n        <div class=\"buttons\" style=\"margin-top: 3rem\"><a routerLink=\"/\">\r\n                <button class=\"button back\">Cancel</button>\r\n            </a>\r\n            <button class=\"button next\" [class.disabled-button]=\"!pwd1\" (click)=\"setPwd()\">Next</button>\r\n        </div>\r\n      </div>\r\n  </div>\r\n  <!-- Step 3 -->\r\n  <div *ngIf=\"activePanel==2\">\r\n      <H1 style=\"background-color: #5963FF\">Wallet imported!</H1>\r\n      <div class=\"grey-card\">\r\n      <p class=\"description bold\">Your wallet is now set up and ready to be used.</p>\r\n      <p class=\"description\">Download your encrypted keystore file and import it when you want to access your wallet.</p>\r\n      <div class=\"whitebox final\">\r\n        <p class=\"description bold pkh\">Your public account address:&#10;&#13;{{ showPkh() }}</p>\r\n      </div>\r\n      <div class=\"buttons\" style=\"margin-top: 3rem\">\r\n        <button class=\"button next\" (click)=\"download()\">Download</button>\r\n        <button class=\"button next\" [class.disabled-button]=\"!Downloaded\" (click)=\"done()\">Open Wallet</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","import { Injectable } from '@angular/core';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { WalletClient, BeaconMessageType, PermissionResponseInput, SignPayloadResponseInput, P2PPairingRequest, BeaconErrorType, BEACON_VERSION, ErrorResponse, getSenderId } from '@airgap/beacon-sdk';\r\nimport { ExtendedP2PPairingResponse } from '@airgap/beacon-sdk/dist/cjs/types/P2PPairingResponse';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BeaconService {\r\n  client: WalletClient = null;\r\n  peers = [];\r\n  permissions = [];\r\n  constructor(\r\n    private messageService: MessageService\r\n  ) {}\r\n  preNotifyPairing(pairInfoJson: string) {\r\n    const pairInfo: P2PPairingRequest = JSON.parse(pairInfoJson);\r\n    const peersJson = localStorage.getItem('beacon:communication-peers');\r\n    let newPublicKey = true;\r\n    if (peersJson) {\r\n      const peers = JSON.parse(peersJson);\r\n      if (peers && peers.length > 0 && pairInfo.publicKey) {\r\n        for (const peer of peers) {\r\n          if (peer.publicKey && peer.publicKey === pairInfo.publicKey) {\r\n            newPublicKey = false;\r\n            console.log('Existing public key found!');\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (newPublicKey) {\r\n      this.messageService.addBeaconWait(`Pairing with ${pairInfo.name}. Please wait!`);\r\n    }\r\n  }\r\n  async addPeer(pairInfoJson: string) {\r\n    const pairInfo = JSON.parse(pairInfoJson);\r\n    console.log('PairInfo', pairInfo);\r\n    await this.client.addPeer(pairInfo);\r\n    this.syncBeaconState();\r\n    this.messageService.removeBeaconMsg();\r\n\r\n  }\r\n  async syncBeaconState() {\r\n    this.peers = await this.getPeers();\r\n    this.permissions = await this.getPermissions();\r\n  }\r\n  async removePeers() {\r\n    while (this.peers.length > 0) {\r\n      await this.removePeer(0);\r\n    }\r\n  }\r\n  async removePeer(index: number) {\r\n    const pairInfo: P2PPairingRequest = this.peers[index];\r\n    const senderId = await getSenderId(pairInfo.publicKey);\r\n    const peerResponse: ExtendedP2PPairingResponse = {\r\n      ...pairInfo,\r\n      type: 'p2p-pairing-response',\r\n      senderId\r\n    };\r\n    await this.client.removePeer(peerResponse);\r\n    await this.client.removeAppMetadata(senderId);\r\n    this.syncBeaconState();\r\n  }\r\n  async removePermissions() {\r\n    await this.client.removeAllPermissions();\r\n    this.syncBeaconState();\r\n  }\r\n  async removePermission(index: number) {\r\n    await this.client.removePermission(this.permissions[index].accountIdentifier);\r\n    this.syncBeaconState();\r\n  }\r\n  async getPeers(): Promise<any> {\r\n    return await this.client.getPeers();\r\n  }\r\n  async getPermissions(): Promise<any> {\r\n    return await this.client.getPermissions();\r\n  }\r\n  async rejectOnPermission(message: any) {\r\n    await this.respondWithError(BeaconErrorType.NOT_GRANTED_ERROR, message);\r\n  }\r\n  async rejectOnNetwork(message: any) {\r\n    await this.respondWithError(BeaconErrorType.NETWORK_NOT_SUPPORTED, message);\r\n  }\r\n  async rejectOnUserAbort(message: any) {\r\n    await this.respondWithError(BeaconErrorType.ABORTED_ERROR, message);\r\n  }\r\n  async rejectOnSourceAddress(message: any) {\r\n    await this.respondWithError(BeaconErrorType.NO_PRIVATE_KEY_FOUND_ERROR, message);\r\n  }\r\n  async rejectOnTooManyOps(message: any) {\r\n    await this.respondWithError(BeaconErrorType.TOO_MANY_OPERATIONS, message);\r\n  }\r\n  async rejectOnUnknown(message: any) {\r\n    await this.respondWithError(BeaconErrorType.UNKNOWN_ERROR, message);\r\n  }\r\n  async rejectOnParameters(message: any) {\r\n    await this.respondWithError(BeaconErrorType.PARAMETERS_INVALID_ERROR, message);\r\n  }\r\n  async rejectOnBroadcastError(message: any) {\r\n    await this.respondWithError(BeaconErrorType.BROADCAST_ERROR, message);\r\n  }\r\n  async respondWithError(errorType: BeaconErrorType, requestMessage: any) {\r\n    if (requestMessage) {\r\n      const response: ErrorResponse = {\r\n        type: BeaconMessageType.Error,\r\n        errorType,\r\n        version: BEACON_VERSION,\r\n        id: requestMessage.id,\r\n        senderId: await this.client.beaconId\r\n      };\r\n      await this.client.respond(response);\r\n    }\r\n  }\r\n  async approvePermissionRequest(message: any, publicKey: string) {\r\n    const response: PermissionResponseInput = {\r\n      type: BeaconMessageType.PermissionResponse,\r\n      network: message.network,\r\n      scopes: message.scopes,\r\n      id: message.id,\r\n      publicKey: publicKey\r\n    };\r\n    await this.client.respond(response);\r\n  }\r\n  async approveSignPayloadRequest(message: any, signature: string) {\r\n    const response: SignPayloadResponseInput = {\r\n      type: BeaconMessageType.SignPayloadResponse,\r\n      id: message.id,\r\n      signingType: message.signingType,\r\n      signature\r\n    };\r\n    await this.client.respond(response);\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\n@Component({\r\n  selector: 'app-activate',\r\n  templateUrl: './activate.component.html',\r\n  styleUrls: ['./activate.component.scss']\r\n})\r\nexport class ActivateComponent implements OnInit {\r\n  pkh: string;\r\n  secret: string;\r\n  formInvalid = '';\r\n  constructor(\r\n    private messageService: MessageService,\r\n    private operationService: OperationService,\r\n    private inputValidationService: InputValidationService,\r\n    private translate: TranslateService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n  activate() {\r\n    this.formInvalid = this.checkInput();\r\n    if (!this.formInvalid) {\r\n      const pkh = this.pkh;\r\n      const secret = this.secret;\r\n      this.pkh = '';\r\n      this.secret = '';\r\n      this.operationService.activate(pkh, secret).subscribe(\r\n        (ans: any) => {\r\n          if (ans.success) {\r\n            if (ans.payload.opHash) {\r\n              this.translate.get('ACTIVATECOMPONENT.ACTIVATESUCCESS').subscribe(\r\n                (res: string) => this.messageService.addSuccess(res)  // 'Activation successfully broadcasted to the blockchain!'\r\n              );\r\n            } else {\r\n              this.translate.get('ACTIVATECOMPONENT.RETRIEVEFAIL').subscribe(\r\n                (res: string) => this.messageService.addWarning(res)  // Could not retrieve an operation hash\r\n              );\r\n            }\r\n          } else {\r\n            let errorMessage = '';\r\n            if (typeof ans.payload.msg === 'string') {\r\n              errorMessage = 'NodeError ' + ans.payload.msg;\r\n            } else {\r\n              errorMessage = 'NodeError ' + JSON.stringify(ans.payload.msg);\r\n            }\r\n            this.messageService.addError(errorMessage);\r\n            console.log(JSON.stringify(ans.payload.msg));\r\n          }\r\n        },\r\n        err => {\r\n          this.translate.get('ACTIVATECOMPONENT.ACTIVATEFAIL').subscribe(\r\n            (res: string) => {\r\n              let errorMessage = '';\r\n              const activateFailed = res;\r\n              if (typeof err.payload.msg === 'string') {\r\n                errorMessage = activateFailed + ' ' + err.payload.msg;\r\n              } else {\r\n                errorMessage = activateFailed;\r\n              }\r\n              this.messageService.addError(errorMessage);\r\n            }  // 'Failed to activate wallet!'\r\n          );\r\n          console.log(JSON.stringify(err));\r\n        }\r\n      );\r\n    }\r\n  }\r\n  checkInput(): string {\r\n    if (!this.inputValidationService.address(this.pkh)) {\r\n      return 'Invalid public key hash!';\r\n    } else if (!this.inputValidationService.code(this.secret)) {\r\n      return 'Invalid activation code!';\r\n    }\r\n    return '';\r\n  }\r\n}\r\n","<div class=\"kukai-card\">\r\n    <H1>\r\n        Activate your ICO wallet\r\n    </H1>\r\n    <p class=\"description\">Wallets created during the fundraiser need to be activated. No private key is required for the activation process.</p>\r\n    <div class=\"grey-card\">\r\n      <small class=\"\">Your public key hash</small>\r\n      <input type=\"text\" class=\"text\" [(ngModel)]=\"pkh\" [placeholder]=\"'tz1...'\">\r\n      <small class=\"\">Your activation code</small>\r\n      <input type=\"text\" class=\"text\" [(ngModel)]=\"secret\" [placeholder]=\"'Code'\">\r\n      <div class=\"buttons\"><a routerLink=\"/import\"><button class=\"button back\">Back</button></a><button class=\"button next\" (click)=\"activate()\">Activate</button></div>\r\n      <span *ngIf=\"formInvalid\" class=\"text-danger\">\r\n          {{ formInvalid }}\r\n      </span>\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { Location } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-agreement',\r\n  templateUrl: './agreement.component.html',\r\n  styleUrls: ['./agreement.component.scss']\r\n})\r\nexport class AgreementComponent implements OnInit {\r\n  displayAgreement = false;\r\n  key = 'accepted-terms';\r\n  constructor(\r\n    private location: Location\r\n    ) { }\r\n  ngOnInit(): void {\r\n    // localStorage.removeItem(this.key);\r\n    const accepted = localStorage.getItem(this.key);\r\n    const path = this.location.path();\r\n    if (!accepted && path !== '/terms-of-use' && path !== '/privacy-policy') {\r\n      this.displayAgreement = true;\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflowY = 'hidden';\r\n    }\r\n  }\r\n  accept() {\r\n    localStorage.setItem(this.key, '1');\r\n    this.displayAgreement = false;\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflowY = '';\r\n  }\r\n  reject() {\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflowY = '';\r\n    window.open('', '_self');\r\n  }\r\n}\r\n","<div *ngIf=\"displayAgreement\" class=\"agreement-wrapper fade-in\">\r\n  <div class=\"agreement-body\">\r\n    <div class=\"agreement-footer fade-in\">\r\n      <p>By Accessing, Continuing to Use & Browse this Website including its Services provided therein (“Kukai Wallet”), you agree that you have read and reviewed our <a href=\"./terms-of-use\" target=\"_blank\">Terms of Use</a> and <a href=\"./privacy-policy\" target=\"_blank\">Privacy Policy</a>.</p>\r\n      <div><div class=\"accept\">\r\n        <button (click)=\"accept()\">Accept</button>\r\n        <p>I have reviewed the Terms of Use and Privacy Policy, I hereby Accept and Agree to the Terms of Use and Privacy Policy.</p>\r\n      </div>\r\n      <div>\r\n        <a href=\"about:blank\"><button>Decline</button></a>\r\n        <p>I have reviewed the Terms of Use and Privacy Policy, I hereby DO NOT Accept and Agree to the Terms of Use and Privacy Policy.</p>\r\n      </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","import { Injectable } from '@angular/core';\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { of, Observable, from as fromPromise } from 'rxjs';\r\nimport { flatMap } from 'rxjs/operators';\r\nimport { Activity, Account, ImplicitAccount } from '../wallet/wallet';\r\nimport { MessageService } from '../message/message.service';\r\nimport { LookupService } from '../lookup/lookup.service';\r\nimport { IndexerService } from '../indexer/indexer.service';\r\nimport Big from 'big.js';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\nimport { TokenService } from '../token/token.service';\r\n\r\n@Injectable()\r\nexport class ActivityService {\r\n  maxTransactions = 10;\r\n  constructor(\r\n    private walletService: WalletService,\r\n    private messageService: MessageService,\r\n    private lookupService: LookupService,\r\n    private indexerService: IndexerService,\r\n    private tokenService: TokenService\r\n  ) { }\r\n  updateTransactions(pkh): Observable<any> {\r\n    try {\r\n      const account = this.walletService.wallet.getAccount(pkh);\r\n      return this.getTransactonsCounter(account).pipe(\r\n        flatMap((ans: any) => {\r\n          return of(ans);\r\n        })\r\n      );\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  getTransactonsCounter(account: Account): Observable<any> {\r\n    const knownTokenIds: string[] = this.tokenService.knownTokenIds();\r\n    return fromPromise(this.indexerService.accountInfo(account.address, knownTokenIds)).pipe(\r\n      flatMap((data) => {\r\n        const counter = data.counter;\r\n        const unknownTokenIds = data.unknownTokenIds ? data.unknownTokenIds : [];\r\n        this.handleUnknownTokenIds(unknownTokenIds);\r\n        if (account.state !== counter) {\r\n          if (data.tokens) {\r\n            this.updateTokenBalances(account, data.tokens);\r\n          }\r\n          return this.getAllTransactions(account, counter);\r\n        } else {\r\n          return of({\r\n            upToDate: true,\r\n          });\r\n        }\r\n      })\r\n    );\r\n  }\r\n  private handleUnknownTokenIds(unknownTokenIds) {\r\n    if (unknownTokenIds.length) {\r\n      for (const tokenId of unknownTokenIds) {\r\n        const tok = tokenId.split(':');\r\n        this.tokenService.searchMetadata(tok[0], tok[1]);\r\n      }\r\n    }\r\n  }\r\n  async updateTokenBalances(account, tokens) {\r\n    if (tokens && tokens.length) {\r\n      for (const token of tokens) {\r\n        const tokenId = `${token.contract}:${token.token_id}`;\r\n        if (tokenId) {\r\n          account.updateTokenBalance(tokenId, token.balance.toString());\r\n        }\r\n      }\r\n    }\r\n    this.walletService.storeWallet();\r\n  }\r\n  getAllTransactions(account: Account, counter: string): Observable<any> {\r\n    const knownTokenIds: string[] = this.tokenService.knownTokenIds();\r\n    return fromPromise(this.indexerService.getOperations(account.address, knownTokenIds, this.walletService.wallet)).pipe(\r\n      flatMap((resp) => {\r\n        const operations = resp.operations;\r\n        this.handleUnknownTokenIds(resp.unknownTokenIds);\r\n        if (Array.isArray(operations)) {\r\n          const oldActivities = account.activities;\r\n          account.activities = operations;\r\n          const oldState = account.state;\r\n          account.state = counter;\r\n          this.walletService.storeWallet();\r\n          if (oldState !== '') { // Exclude inital loading\r\n            this.promptNewActivities(account, oldActivities, operations);\r\n          } else {\r\n            console.log('# Excluded ' + counter);\r\n          }\r\n          for (const activity of operations) {\r\n            const counterParty = this.getCounterparty(activity, account, false);\r\n            this.lookupService.check(counterParty);\r\n          }\r\n        } else {\r\n          console.log(operations);\r\n        }\r\n        return of({\r\n          upToDate: false\r\n        });\r\n      })\r\n    );\r\n  }\r\n  promptNewActivities(account: Account, oldActivities: Activity[], newActivities: Activity[]) {\r\n    for (const activity of newActivities) {\r\n      const index = oldActivities.findIndex((a) => a.hash === activity.hash);\r\n      if (index === -1 || (index !== -1 && oldActivities[index].status === 0)) {\r\n        const now = (new Date()).getTime();\r\n        const timeDiff = now - (activity?.timestamp ? activity.timestamp : now);\r\n        if (timeDiff < 3600000) { // 1 hour\r\n          if (activity.type === 'transaction') {\r\n            if (account.address === activity.source.address) {\r\n              this.messageService.addSuccess(account.shortAddress() + ': Sent ' + this.tokenService.formatAmount(activity.tokenId, activity.amount.toString()));\r\n            }\r\n            if (account.address === activity.destination.address) {\r\n              this.messageService.addSuccess(account.shortAddress() + ': Received ' + this.tokenService.formatAmount(activity.tokenId, activity.amount.toString()));\r\n            }\r\n          } else if (activity.type === 'delegation') {\r\n            this.messageService.addSuccess(account.shortAddress() + ': Delegate updated');\r\n          } else if (activity.type === 'origination') {\r\n            this.messageService.addSuccess(account.shortAddress() + ': Account originated');\r\n          } else if (activity.type === 'activation') {\r\n            this.messageService.addSuccess(account.shortAddress() + ': Account activated');\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  getCounterparty(transaction: Activity, account: Account, withLookup = true): string {\r\n    let counterParty = { address: '' };\r\n    let counterPartyAddress = '';\r\n    if (transaction.type === 'delegation') {\r\n      if (transaction.destination) {\r\n        counterParty = transaction.destination;\r\n      } else {\r\n        counterParty = { address: '' }; // User has undelegated\r\n      }\r\n    } else if (transaction.type === 'transaction') {\r\n      if (account.address === transaction.source.address) {\r\n        counterParty = transaction.destination; // to\r\n      } else {\r\n        counterParty = transaction.source; // from\r\n      }\r\n    } else if (transaction.type === 'origination') {\r\n      if (account.address === transaction.source.address) {\r\n        counterParty = transaction.destination;\r\n      } else {\r\n        counterParty = transaction.source;\r\n      }\r\n    } else {\r\n      counterParty = { address: '' };\r\n    }\r\n    if (withLookup) {\r\n      counterPartyAddress = this.lookupService.resolve(counterParty);\r\n    }\r\n    return counterPartyAddress;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { WalletType, KeyPair } from './../../interfaces';\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { CoordinatorService } from '../coordinator/coordinator.service';\r\nimport {\r\n  LegacyWalletV1,\r\n  LegacyWalletV2,\r\n  LegacyWalletV3,\r\n  HdWallet,\r\n  LedgerWallet,\r\n  TorusWallet,\r\n  EmbeddedTorusWallet\r\n} from '../wallet/wallet';\r\nimport { hd, utils } from '@tezos-core-tools/crypto-utils';\r\nimport { EncryptionService } from '../encryption/encryption.service';\r\nimport { TorusService } from '../torus/torus.service';\r\nimport { IndexerService } from '../indexer/indexer.service';\r\n\r\n@Injectable()\r\nexport class ImportService {\r\n  constructor(\r\n    private walletService: WalletService,\r\n    private coordinatorService: CoordinatorService,\r\n    private indexerService: IndexerService,\r\n    private encryptionService: EncryptionService,\r\n    private torusService: TorusService,\r\n  ) { }\r\n  pwdRequired(json: string) {\r\n    const walletData = JSON.parse(json);\r\n    if (walletData.provider !== 'Kukai') {\r\n      throw new Error(`Unsupported wallet format`);\r\n    }\r\n    if (walletData.walletType === 0 || walletData.walletType === 4) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  async importWalletFromJson(json: any, pwd: string): Promise<boolean> {\r\n    // From file\r\n    let seed;\r\n    let walletData;\r\n    try {\r\n      walletData = JSON.parse(json);\r\n      if (walletData.walletType === 4 && walletData.version === 3) {\r\n        //hd\r\n        seed = await this.encryptionService.decrypt(\r\n          walletData.encryptedSeed,\r\n          pwd,\r\n          walletData.iv,\r\n          3\r\n        );\r\n      } else if (walletData.walletType === 0) {\r\n        if (walletData.version === 1) {\r\n          console.log('v1');\r\n          seed = await this.encryptionService.decrypt(\r\n            walletData.encryptedSeed,\r\n            pwd,\r\n            walletData.pkh.slice(3, 19),\r\n            1\r\n          );\r\n          if (utils.seedToKeyPair(seed).pkh !== walletData.pkh) {\r\n            seed = '';\r\n          }\r\n        } else if (walletData.version === 2 || walletData.version === 3) {\r\n          seed = await this.encryptionService.decrypt(\r\n            walletData.encryptedSeed,\r\n            pwd,\r\n            walletData.iv,\r\n            walletData.version\r\n          );\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new Error('Failed to decrypt keystore file');\r\n    }\r\n    if (seed) {\r\n      return this.importWalletFromObject(walletData, seed).then(\r\n        (ans) => {\r\n          return ans;\r\n        },\r\n        (e) => {\r\n          console.error(e);\r\n          throw new Error('Failed to fetch account(s). Please check your connection.');\r\n        }\r\n      );\r\n    } else {\r\n      throw new Error('Wrong password');\r\n    }\r\n  }\r\n  async importWalletFromObject(data: any, seed: any): Promise<boolean> {\r\n    this.coordinatorService.stopAll();\r\n    if (data.walletType === 4 && data.version === 3) {\r\n      // HD\r\n      this.walletService.wallet = new HdWallet(\r\n        data.iv,\r\n        data.encryptedSeed,\r\n        data.encryptedEntropy\r\n      );\r\n    } else if (data.walletType === 0) {\r\n      if (data.version === 3) {\r\n        this.walletService.wallet = new LegacyWalletV3(\r\n          data.iv,\r\n          data.encryptedSeed,\r\n          data.encryptedEntropy\r\n        );\r\n      } else if (data.version === 2) {\r\n        this.walletService.wallet = new LegacyWalletV2(\r\n          data.iv,\r\n          data.encryptedSeed\r\n        );\r\n      } else if (data.version === 1) {\r\n        this.walletService.wallet = new LegacyWalletV1(\r\n          data.pkh.slice(3, 19),\r\n          data.encryptedSeed\r\n        );\r\n      } else {\r\n        throw new Error('Unsupported wallet file');\r\n      }\r\n    } else {\r\n      throw new Error('Unsupported wallet file');\r\n    }\r\n    let keys: KeyPair;\r\n    if (seed.length === 32) {\r\n      keys = utils.seedToKeyPair(seed);\r\n    } else if (seed.length === 64) {\r\n      keys = hd.keyPairFromAccountIndex(seed, 0);\r\n    } else {\r\n      throw new Error('Invalid seed length');\r\n    }\r\n    this.walletService.initStorage();\r\n    if (this.walletService.wallet instanceof HdWallet) {\r\n      let index = 0;\r\n      let state = 'X';\r\n      while (state) {\r\n        keys = hd.keyPairFromAccountIndex(seed, index);\r\n        const accountInfo = await this.indexerService\r\n          .accountInfo(keys.pkh);\r\n          state = accountInfo.counter;\r\n          console.log(accountInfo);\r\n        if (!state && accountInfo.unknownTokenIds?.length) {\r\n          state = 'X';\r\n        }\r\n        if (state || index === 0) {\r\n          this.walletService.addImplicitAccount(\r\n            keys.pk,\r\n            index++\r\n          );\r\n          await this.findContracts(keys.pkh);\r\n        }\r\n      }\r\n      this.walletService.wallet.index = index;\r\n    } else {\r\n      this.walletService.addImplicitAccount(keys.pk);\r\n      await this.findContracts(keys.pkh);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  async importWalletFromPk(pk: string, derivationPath: string, verifierDetails: any = null, sk: string = '', instanceId: string = ''): Promise<boolean> {\r\n    this.coordinatorService.stopAll();\r\n    if (derivationPath) {\r\n      return this.ledgerImport(pk, derivationPath);\r\n    } else if (verifierDetails) {\r\n      return this.torusImport(pk, verifierDetails, sk, instanceId);\r\n    }\r\n  }\r\n  async ledgerImport(pk: string, derivationPath: string) {\r\n    try {\r\n      this.walletService.initStorage();\r\n      this.walletService.wallet = new LedgerWallet();\r\n      this.walletService.addImplicitAccount(pk, derivationPath);\r\n      await this.findContracts(this.walletService.wallet.implicitAccounts[0].pkh);\r\n      return true;\r\n    } catch (err) {\r\n      console.warn(err);\r\n      this.walletService.clearWallet();\r\n      return false;\r\n    }\r\n  }\r\n  async torusImport(pk: string, verifierDetails: any, sk: string = '', instanceId: string = '') {\r\n    try {\r\n      if (verifierDetails.embedded) {\r\n        this.walletService.initStorage(instanceId);\r\n        this.walletService.wallet = new EmbeddedTorusWallet(verifierDetails.verifier, verifierDetails.id, verifierDetails.name, verifierDetails.origin, sk, instanceId);\r\n      } else {\r\n        this.walletService.initStorage();\r\n        this.walletService.wallet = new TorusWallet(verifierDetails.verifier, verifierDetails.id, verifierDetails.name);\r\n      }\r\n      if (verifierDetails.verifier === 'twitter') {\r\n        this.updateTwitterName(verifierDetails.id);\r\n      }\r\n      this.walletService.addImplicitAccount(pk);\r\n      return true;\r\n    } catch (err) {\r\n      console.warn(err);\r\n      this.walletService.clearWallet(instanceId);\r\n      return false;\r\n    }\r\n  }\r\n  async updateTwitterName(verifierId: string) {\r\n    const twitterId = verifierId.split('|')[1];\r\n    const { username } = await this.torusService.twitterLookup(undefined, twitterId);\r\n    if (username && this.walletService.wallet instanceof TorusWallet) {\r\n      this.walletService.wallet.name = '@' + username;\r\n    }\r\n  }\r\n  async findContracts(pkh: string) {\r\n    const addresses = await this.indexerService.getContractAddresses(pkh);\r\n    for (const KT of addresses) {\r\n      console.log('Found KT: ' + KT);\r\n      this.walletService.addOriginatedAccount(KT, pkh);\r\n    }\r\n    this.walletService.storeWallet();\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { WalletClient, BeaconMessageType, PermissionScope, PermissionResponseInput, P2PPairingRequest, BeaconErrorType, BeaconResponseInputMessage, BeaconMessage, OperationResponseInput } from '@airgap/beacon-sdk';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { CONSTANTS } from '../../../environments/environment';\r\nimport { Account, ImplicitAccount, OriginatedAccount } from '../../services/wallet/wallet';\r\nimport { Location } from '@angular/common';\r\nimport { BeaconService } from '../../services/beacon/beacon.service';\r\nimport { DeeplinkService } from '../../services/deeplink/deeplink.service';\r\nimport { emitMicheline, assertMichelsonData } from '@taquito/michel-codec';\r\nimport { valueDecoder } from '@taquito/local-forging/dist/lib/michelson/codec';\r\nimport { Uint8ArrayConsumer } from '@taquito/local-forging/dist/lib/uint8array-consumer';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\n\r\n@Component({\r\n  selector: 'app-uri-handler',\r\n  templateUrl: './uri-handler.component.html',\r\n  styleUrls: ['./uri-handler.component.scss']\r\n})\r\nexport class UriHandlerComponent implements OnInit {\r\n  permissionRequest: PermissionResponseInput = null;\r\n  operationRequest: any = null;\r\n  signRequest: any = null;\r\n  activeAccount: Account;\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    public messageService: MessageService,\r\n    public walletService: WalletService,\r\n    private location: Location,\r\n    private beaconService: BeaconService,\r\n    private deeplinkService: DeeplinkService,\r\n    private inputValidationService: InputValidationService\r\n  ) { }\r\n  ngOnInit(): void {\r\n    if (this.walletService.wallet) {\r\n      this.init();\r\n    }\r\n  }\r\n  async init() {\r\n    const pairingString = this.deeplinkService.popPairingJson();\r\n    if (pairingString) {\r\n      console.log(pairingString);\r\n      this.beaconService.preNotifyPairing(pairingString);\r\n    }\r\n    await this.connectApp().catch((error) => console.error('connect error', error));\r\n    if (pairingString) {\r\n      await this.beaconService.client.isConnected;\r\n      this.beaconService.addPeer(pairingString);\r\n    }\r\n  }\r\n  /* https://docs.walletbeacon.io/beacon/03.getting-started-wallet.html#setup */\r\n  connectApp = async (): Promise<void> => {\r\n    if (!this.beaconService.client) {\r\n      this.beaconService.client = new WalletClient({ name: 'Kukai Wallet' });\r\n    }\r\n    await this.beaconService.client.init(); // Establish P2P connection\r\n    this.beaconService.client\r\n      .connect(async (message: any) => {\r\n        console.log('### beacon message', message);\r\n        if (message.type !== BeaconMessageType.SignPayloadRequest && message.network.type !== CONSTANTS.NETWORK) {\r\n          console.warn(`Rejecting Beacon message because of network. Expected ${CONSTANTS.NETWORK} instead of ${message.network.type}`);\r\n          await this.beaconService.rejectOnNetwork(message);\r\n        } else if (!this.permissionRequest && !this.operationRequest && !this.signRequest) {\r\n          switch (message.type) {\r\n            case BeaconMessageType.PermissionRequest:\r\n              await this.handlePermissionRequest(message);\r\n              break;\r\n            case BeaconMessageType.OperationRequest:\r\n              if (await this.isSupportedOperationRequest(message)) {\r\n                this.operationRequest = message;\r\n              } else {\r\n                await this.beaconService.rejectOnUnknown(message);\r\n              }\r\n              break;\r\n            case BeaconMessageType.SignPayloadRequest:\r\n              if (await this.isSupportedSignPayload(message)) {\r\n                this.signRequest = message;\r\n              } else {\r\n                await this.beaconService.rejectOnUnknown(message);\r\n              }\r\n              break;\r\n            default:\r\n              await this.beaconService.rejectOnUnknown(message);\r\n              console.warn('Unknown message type', message);\r\n          }\r\n        }\r\n      })\r\n      .catch((error) => console.error('connect error', error));\r\n  }\r\n  async handlePermissionRequest(message: any) {\r\n    console.log('## permission request');\r\n    message.scopes = message.scopes.filter((scope: PermissionScope) => [PermissionScope.OPERATION_REQUEST, PermissionScope.SIGN].includes(scope));\r\n    if (message.scopes.length) {\r\n      if (this.walletService.wallet) {\r\n        this.permissionRequest = message;\r\n      } else {\r\n        console.warn('No wallet found');\r\n        await this.beaconService.rejectOnSourceAddress(message);\r\n      }\r\n    } else {\r\n      console.warn('No valid scope');\r\n    }\r\n  }\r\n  async isSupportedOperationRequest(message: any): Promise<boolean> {\r\n    if (!this.walletService.wallet) {\r\n      console.log('No wallet found');\r\n      return false;\r\n    } else if (!this.walletService.wallet.getImplicitAccount(message.sourceAddress)) {\r\n      console.warn('Source address not recogized');\r\n      await this.beaconService.rejectOnSourceAddress(message);\r\n      return false;\r\n    } else if (message.operationDetails.length > 1) {\r\n      for (const op of message.operationDetails) {\r\n        if (op.kind !== 'transaction') {\r\n          console.warn('Only transaction batches supported');\r\n          await this.beaconService.rejectOnTooManyOps(message);\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n    if (message.operationDetails[0].kind === 'transaction') {\r\n      for (let i = 0; i < message.operationDetails.length; i++) {\r\n        if (message.operationDetails[i].destination &&\r\n          message.operationDetails[i].parameters &&\r\n          this.walletService.wallet.getAccount(message.operationDetails[i].destination)) {\r\n          console.warn('Invocation of user controlled contract is disabled');\r\n          await this.beaconService.rejectOnPermission(message);\r\n          return false;\r\n        } else if (\r\n          !message.operationDetails[i].destination ||\r\n          !message.operationDetails[i].amount\r\n        ) {\r\n          console.warn('Missing destination or amount');\r\n          await this.beaconService.rejectOnUnknown(message);\r\n          return false;\r\n        } else if (this.invalidParameters(message.operationDetails[i].parameters)) {\r\n          await this.beaconService.rejectOnParameters(message);\r\n          return false;\r\n        }\r\n      }\r\n    } else if (message.operationDetails[0].kind === 'delegation') {\r\n      if (!message.operationDetails[0].delegate) {\r\n        console.warn('Invalid delegate');\r\n        await this.beaconService.rejectOnUnknown(message);\r\n      }\r\n    } else {\r\n      console.warn('Unsupported operation kind');\r\n      await this.beaconService.rejectOnUnknown(message);\r\n      return false;\r\n    }\r\n    this.activeAccount = this.walletService.wallet.getImplicitAccount(message.sourceAddress);\r\n    return true;\r\n  }\r\n  async isSupportedSignPayload(message: any): Promise<Boolean> {\r\n    if (!this.walletService.wallet) {\r\n      console.log('No wallet found');\r\n      return false;\r\n    } else if (!this.walletService.wallet.getImplicitAccount(message.sourceAddress)) {\r\n      console.warn('Source address not recogized');\r\n      await this.beaconService.rejectOnSourceAddress(message);\r\n      return false;\r\n    }\r\n    if (message.payload.slice(0, 2) === '0x') {\r\n      message.payload = message.payload.slice(2);\r\n    }\r\n    message.payload = message.payload.toLowerCase();\r\n    const hexString = message.payload;\r\n    console.log('hex', hexString);\r\n    if ((message.signingType !== 'raw' && message.signingType !== 'micheline') || !this.inputValidationService.hexString(hexString)) {\r\n      console.warn('Invalid sign payload');\r\n      await this.beaconService.rejectOnUnknown(message);\r\n      return false;\r\n    } else if (hexString.slice(0, 2) !== '05') {\r\n      console.warn('Unsupported prefix (expected 05)');\r\n      await this.beaconService.rejectOnUnknown(message);\r\n      return false;\r\n    }\r\n    try {\r\n      const parsedPayload = valueDecoder(Uint8ArrayConsumer.fromHexString(hexString.slice(2)));\r\n      console.log('Parsed sign payload', parsedPayload);\r\n    } catch (e) {\r\n      console.warn(e.message ? 'Decoding: ' + e.message : e);\r\n      await this.beaconService.rejectOnUnknown(message);\r\n      return false;\r\n    }\r\n    this.activeAccount = this.walletService.wallet.getImplicitAccount(message.sourceAddress);\r\n    return true;\r\n  }\r\n  invalidParameters(parameters: any): boolean {\r\n    try {\r\n      if (parameters) {\r\n        if (!parameters.value ||\r\n          !parameters.entrypoint) {\r\n          throw new Error('entrypoint and value expected');\r\n        }\r\n        assertMichelsonData(parameters.value);\r\n      }\r\n      return false;\r\n    } catch (e) {\r\n      return true;\r\n    }\r\n  }\r\n  /* operation request handling */\r\n  async operationResponse(opHash: any) {\r\n    if (!opHash) {\r\n      await this.beaconService.rejectOnUserAbort(this.operationRequest);\r\n    } else if (opHash === 'broadcast_error') {\r\n      await this.beaconService.rejectOnBroadcastError(this.signRequest);\r\n    } else {\r\n      const response: OperationResponseInput = {\r\n        type: BeaconMessageType.OperationResponse,\r\n        transactionHash: opHash,\r\n        id: this.operationRequest.id\r\n      };\r\n      await this.beaconService.client.respond(response);\r\n      console.log(response);\r\n    }\r\n    this.operationRequest = null;\r\n  }\r\n  /* permission handling */\r\n  async permissionResponse(publicKey: string) {\r\n    if (!publicKey) {\r\n      await this.beaconService.rejectOnUserAbort(this.permissionRequest);\r\n    } else {\r\n      await this.beaconService.approvePermissionRequest(this.permissionRequest, publicKey);\r\n      this.beaconService.syncBeaconState();\r\n    }\r\n    this.permissionRequest = null;\r\n  }\r\n  /* sign payload handling */\r\n  async signResponse(signature: string) {\r\n    if (!signature) {\r\n      await this.beaconService.rejectOnUserAbort(this.signRequest);\r\n    } else {\r\n      await this.beaconService.approveSignPayloadRequest(this.signRequest, signature);\r\n    }\r\n    console.log(signature);\r\n    this.signRequest = null;\r\n  }\r\n}\r\n","<div>\r\n  <app-send (operationResponse)=\"operationResponse($event)\" [beaconMode]=true [operationRequest]=operationRequest\r\n    [activeAccount]=activeAccount></app-send>\r\n  <app-delegate (operationResponse)=\"operationResponse($event)\" [beaconMode]=true [operationRequest]=operationRequest\r\n    [activeAccount]=activeAccount></app-delegate>\r\n  <app-permission-request (permissionResponse)=\"permissionResponse($event)\" [permissionRequest]=\"permissionRequest\">\r\n  </app-permission-request>\r\n  <app-sign-expr (signResponse)=\"signResponse($event)\" [signRequest]=\"signRequest\" [activeAccount]=activeAccount></app-sign-expr>\r\n</div>","<!-- The Modal -->\r\n<div *ngIf=\"signRequest\" id=\"myModal\" class=\"kukai-modal\">\r\n  <!-- Modal content -->\r\n  <div class=\"km-content\">\r\n    <div class=\"x\" (click)=\"rejectSigning()\"><img src=\"../../../assets/img/x.svg\"></div>\r\n    <div class=\"km-header\">\r\n      <H1 *ngIf=\"!isMessage\">Sign Micheline Expression</H1>\r\n      <H1 *ngIf=\"isMessage\">Message Signing</H1>\r\n    </div>\r\n    <div class=\"km-body\">\r\n      <label *ngIf=\"isMessage\">Message</label>\r\n      <ng-container *ngIf=\"!isMessage\">\r\n        <p class=\"previewAttention\">Warning! Only sign if you understand the expression or trust the source.</p>\r\n        <label>Micheline Expression</label>\r\n      </ng-container>\r\n      <textarea rows=\"5\" style=\"width: 100%\" readonly>{{ payload }}</textarea>\r\n      <span *ngIf=\"this.pwdInvalid\" class=\"danger margin\">{{ this.pwdInvalid }}</span>\r\n      <div class=\"row-group\" style=\"margin: 1.25rem 0 1.5rem;\">\r\n        <input *ngIf=\"!walletService.isLedgerWallet() && !walletService.isTorusWallet()\" [(ngModel)]=\"password\"\r\n          autocomplete=\"current-password\" placeholder=\"Password\" class=\"text password\" type=\"password\"\r\n          (input)=\"this.pwdInvalid = ''\" (change)=\"this.pwdInvalid = ''\" (keydown.enter)='sign()'>\r\n          <button class=\"purple confirm\" (click)=\"sign()\">\r\n            {{ walletService.isLedgerWallet() ? 'Sign with Ledger' : 'Sign'}}</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","import { Component, OnInit, SimpleChanges, Input, Output, EventEmitter, OnChanges } from '@angular/core';\r\nimport { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Account } from '../../services/wallet/wallet';\r\nimport { OperationService } from '../../services/operation/operation.service';\r\nimport { emitMicheline } from '@taquito/michel-codec';\r\nimport { valueDecoder } from '@taquito/local-forging/dist/lib/michelson/codec';\r\nimport { Uint8ArrayConsumer } from '@taquito/local-forging/dist/lib/uint8array-consumer';\r\nimport { LedgerService } from '../../services/ledger/ledger.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\n\r\n@Component({\r\n  selector: 'app-sign-expr',\r\n  templateUrl: './sign-expr.component.html',\r\n  styleUrls: ['./sign-expr.component.scss']\r\n})\r\nexport class SignExprComponent implements OnInit, OnChanges {\r\n  @Input() signRequest: any;\r\n  @Input() activeAccount: Account;\r\n  @Output() signResponse = new EventEmitter();\r\n  password = '';\r\n  pwdInvalid = '';\r\n  payload = '';\r\n  isMessage = false;\r\n  constructor(\r\n    public walletService: WalletService,\r\n    private messageService: MessageService,\r\n    public translate: TranslateService,\r\n    private operationService: OperationService,\r\n    private ledgerService: LedgerService,\r\n    private inputValidationService: InputValidationService\r\n  ) { }\r\n  modalRef1: BsModalRef;\r\n  ngOnInit(): void {\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (this.signRequest) {\r\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\r\n      document.body.style.marginRight = scrollBarWidth.toString();\r\n      document.body.style.overflow = 'hidden';\r\n      this.isMessage = this.inputValidationService.isMessageSigning(this.signRequest.payload);\r\n      const value = valueDecoder(Uint8ArrayConsumer.fromHexString(this.signRequest.payload.slice(2)));\r\n      const payload = emitMicheline(value, { indent: '  ', newline: '\\n' });\r\n      this.payload = this.isMessage ? value.string : payload;\r\n    }\r\n  }\r\n  async sign() {\r\n    if (this.walletService.isLedgerWallet()) {\r\n      this.requestLedgerSignature();\r\n    } else {\r\n      const pwd = this.password;\r\n      this.password = '';\r\n      await this.messageService.startSpinner(`Signing ${this.isMessage ? 'message' : 'payload'}...`);\r\n      let keys;\r\n      try {\r\n        keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\r\n      } catch (e) {\r\n        console.warn(e);\r\n        this.messageService.stopSpinner();\r\n      }\r\n      if (keys) {\r\n        this.pwdInvalid = '';\r\n        try {\r\n          const signature = this.operationService.sign(this.signRequest.payload, keys.sk).edsig;\r\n          this.acceptSigning(signature);\r\n        } catch (e) {\r\n          this.pwdInvalid = 'Signing failed';\r\n          console.warn(e);\r\n        } finally {\r\n          this.messageService.stopSpinner();\r\n        }\r\n      } else {\r\n        this.messageService.stopSpinner();\r\n        if (this.walletService.isTorusWallet()) {\r\n          this.pwdInvalid = `Authorization failed`;\r\n        } else {\r\n          this.pwdInvalid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD');\r\n        }\r\n      }\r\n    }\r\n  }\r\n  async requestLedgerSignature() {\r\n    await this.messageService.startSpinner('Waiting for Ledger signature...');\r\n    try {\r\n      const payload = this.signRequest.payload;\r\n      let signature = '';\r\n      if (payload.length <= 2290) {\r\n        signature = await this.ledgerService.signOperation(payload, this.walletService.wallet.implicitAccounts[0].derivationPath);\r\n      } else {\r\n        signature = await this.ledgerService.signHash(this.operationService.ledgerPreHash(payload), this.walletService.wallet.implicitAccounts[0].derivationPath);\r\n      }\r\n      if (signature) {\r\n        this.acceptSigning(this.operationService.hexsigToEdsig(signature));\r\n      } else {\r\n        this.pwdInvalid = 'Failed to sign transaction';\r\n      }\r\n    } finally {\r\n      this.messageService.stopSpinner();\r\n    }\r\n  }\r\n  rejectSigning() {\r\n    this.closeModal();\r\n    this.signResponse.emit(null);\r\n  }\r\n  acceptSigning(signature: string) {\r\n    this.messageService.addSuccess(this.isMessage ? 'Message signed!' : 'Payload signed!');\r\n    this.closeModal();\r\n    this.signResponse.emit(signature);\r\n  }\r\n  closeModal() {\r\n    // restore body scrollbar\r\n    document.body.style.marginRight = '';\r\n    document.body.style.overflow = '';\r\n    this.clear();\r\n  }\r\n  clear() {\r\n    this.password = '';\r\n    this.pwdInvalid = '';\r\n    this.payload = '';\r\n    this.isMessage = false;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { StartComponent } from './components/start/start.component';\r\nimport { NewWalletComponent } from './components/new-wallet/new-wallet.component';\r\nimport { MnemonicImportComponent } from './components/mnemonic-import/mnemonic-import.component';\r\nimport { ActivateComponent } from './components/activate/activate.component';\r\nimport { ConnectLedgerComponent } from './components/connect-ledger/connect-ledger.component';\r\nimport { AccountsComponent } from './components/accounts/accounts.component';\r\nimport { P404Component } from './views/error/404.component';\r\nimport { P500Component } from './views/error/500.component';\r\nimport { AccountViewComponent } from './components/account-view/account-view.component';\r\nimport { PrivacyPolicyComponent } from './components/agreement/privacy-policy/privacy-policy.component';\r\nimport { TermsOfUseComponent } from './components/agreement/terms-of-use/terms-of-use.component';\r\nimport { TorusComponent } from './components/torus/torus.component';\r\nimport { UriHandlerComponent } from './components/uri-handler/uri-handler.component';\r\nimport { LoggedInComponent } from './components/logged-in/logged-in.component';\r\nimport { SettingsComponent } from './components/settings/settings.component';\r\nimport { EmbeddedComponent } from './components/embedded/embedded.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: StartComponent },\r\n  { path: 'new-wallet', component: NewWalletComponent },\r\n  { path: 'import', component: MnemonicImportComponent },\r\n  { path: 'activate', component: ActivateComponent },\r\n  { path: '', component: LoggedInComponent,\r\n    children: [\r\n      { path: 'accounts/:uri', component: AccountsComponent },\r\n      { path: 'accounts', component: AccountsComponent },\r\n      { path: 'account/:address', component: AccountViewComponent },\r\n      { path: 'account', redirectTo: 'accounts'},\r\n      { path: 'settings', component: SettingsComponent },\r\n    ] },\r\n  { path: 'connect-ledger', component: ConnectLedgerComponent },\r\n  { path: 'direct-auth', component: TorusComponent },\r\n  { path: 'accounts', component: AccountsComponent },\r\n  { path: 'account/:address', component: AccountViewComponent },\r\n  { path: 'privacy-policy', component: PrivacyPolicyComponent },\r\n  { path: 'terms-of-use', component: TermsOfUseComponent },\r\n  { path: 'serviceworker', component: TermsOfUseComponent },\r\n  { path: 'embedded', component: EmbeddedComponent },\r\n  { path: '404', component: P404Component, data: { title: 'Page 404' } },\r\n  { path: '500', component: P500Component, data: { title: 'Page 500' } },\r\n  { path: '**', redirectTo: '404'},\r\n];\r\n\r\n@NgModule({\r\n  imports: [ RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' }) ],\r\n  exports: [ RouterModule ]\r\n})\r\nexport class AppRoutingModule { }\r\n","<div class=\"kukai-card\">\r\n  <span class=\"step-counter\">\r\n    —{{ activePanel }}/4—\r\n  </span>\r\n  <div *ngIf=\"activePanel==1\" (click)=\"hideBlur = false\">\r\n    <H1>Back up your seed</H1>\r\n    <p class=\"description\">When you create a new wallet, new Tezos seed words are generated. Your seed words are the master key of your wallet accounts and any value they hold.</p>\r\n    <div class=\"grey-card\">\r\n      <div class=\"whitebox\" (mouseout)=\"hideBlur = false\" (click)=\"$event.stopPropagation()\">{{ MNEMONIC.string }}</div>\r\n      <div *ngIf=\"!hideBlur\" class=\"seed-blur\" (click)=\"hideBlur = true ; $event.stopPropagation()\">\r\n        <span class=\"black\">Click here to reveal your seed words</span>\r\n      </div>\r\n      <p class=\"description red\" style=\"justify-content: center\">Make sure to back it up, write it down, and keep it incredibly safe.</p>\r\n      <div class=\"buttons\"><a routerLink=\"/\"><button class=\"button back\">Back</button></a><button class=\"button next\" (click)=\"verifyView()\">Next</button></div>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"activePanel==2\">\r\n    <H1>Verify your seed</H1>\r\n    <div class=\"grey-card\">\r\n      <p class=\"description\">{{ formatVerifyDescription(MNEMONIC.verify[0] + 1) }}</p>\r\n      <progress max=\"{{ MNEMONIC.wordsToVerify }}\" value=\"{{ MNEMONIC.wordsToVerify - MNEMONIC.verify.length }}\"></progress>\r\n      <div *ngIf=\"MNEMONIC.verify.length\" class=\"word-verify\">\r\n        <div class=\"word-hint\">\r\n          <span class=\"word-index\">{{ indexFormat(MNEMONIC.verify[0] - 1) }}</span>\r\n          <span class=\"word-value\">{{ valueFormat(MNEMONIC.verify[0] - 1) }}</span>\r\n        </div>\r\n        <div class=\"word-input\">\r\n          <span class=\"word-index\"><ng-container *ngIf=\"MNEMONIC.verify.length\">Word {{ MNEMONIC.verify[0] + 1 }}</ng-container></span>\r\n          <input id=\"wordInput\" class=\"text\" type=\"text\" (input)=\"checkWord()\" (change)=\"checkWord()\" [(ngModel)]=\"wordInput\" [disabled]=\"!MNEMONIC.verify.length\" autofocus>\r\n        </div>\r\n        <div class=\"word-hint\">\r\n          <span class=\"word-index\">{{ indexFormat(MNEMONIC.verify[0] + 1) }}</span>\r\n          <span class=\"word-value\">{{ valueFormat(MNEMONIC.verify[0] + 1) }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"buttons\"><a routerLink=\"/\"><button class=\"button back\">Cancel</button></a><button class=\"button next\" [class.disabled-button]=\"MNEMONIC.verify.length\" (click)=\"pwdView()\">Next</button></div>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"activePanel==3\">\r\n    <H1>Set a password</H1>\r\n    <div class=\"grey-card\">\r\n      <p class=\"description bold blue\">This password will be used to create an encrypted keystore file.</p>\r\n      <p class=\"description\" style=\"margin-top: 1.25rem\">When performing operations that need to be signed with your secret key, this password will be required</p>\r\n      <input type=\"password\" style=\"margin-top: 2.5rem\" placeholder=\"{{ 'NEWWALLETCOMPONENT.PASSWORD' | translate }}\" class=\"text\" autocomplete=\"new-password\" [(ngModel)]=\"pwd1\" (keyup)=\"calcStrength()\">\r\n      <small class=\"grey\" style=\"margin-top: 0.5rem\"> {{ 'NEWWALLETCOMPONENT.PASSWORDSTRENGTH' | translate }} — {{ pwdStrength }}</small><BR>\r\n      <input type=\"password\" style=\"margin-top: 1.5rem\" placeholder=\"{{ 'NEWWALLETCOMPONENT.CONFIRMPASSWORD' | translate }}\" class=\"text\" autocomplete=\"new-password\" [(ngModel)]=\"pwd2\">\r\n      <div class=\"buttons\"><a routerLink=\"/\"><button class=\"button back\">Cancel</button></a><button class=\"button next\" [class.disabled-button]=\"!pwd1\" (click)=\"encryptWallet()\">Next</button></div>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"activePanel==4\">\r\n    <H1 style=\"background-color: #5963FF\">Wallet created!</H1>\r\n    <div class=\"grey-card\">\r\n      <p class=\"description bold\">Your wallet is now set up and ready to be used.</p>\r\n      <p class=\"description\">Download your encrypted keystore file and import it when you want to access your wallet.</p>\r\n      <div class=\"whitebox final\">\r\n        <p class=\"description bold pkh\">Your public account address:&#10;&#13;{{ getPkh() }}</p>\r\n      </div>\r\n      <div class=\"buttons\">\r\n        <button class=\"button next\" (click)=\"download()\">Download</button>\r\n        <button class=\"button next\" [class.disabled-button]=\"!ekfDownloaded\" (click)=\"done()\">Open Wallet</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>","import { Component, OnInit, Input, HostBinding } from '@angular/core';\r\nimport { WalletService } from '../../services/wallet/wallet.service';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { ExportService } from '../../services/export/export.service';\r\nimport { ImportService } from '../../services/import/import.service';\r\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Router } from '@angular/router';\r\n\r\n\r\n@Component({\r\n  selector: 'app-new-wallet',\r\n  templateUrl: './new-wallet.component.html',\r\n  styleUrls: ['./new-wallet.component.scss']\r\n})\r\nexport class NewWalletComponent implements OnInit {\r\n  wordInput: string;\r\n  @HostBinding('class.tacos') showTacos = false;\r\n  @Input() pwd1 = '';\r\n  @Input() pwd2 = '';\r\n  @Input() userMnemonic = '';\r\n  hideBlur = false;\r\n  pwdStrength = '';\r\n  ekfDownloaded = false;\r\n  activePanel = 0;\r\n  data: any;\r\n  seed: any;\r\n  pkh: string;\r\n  pk: string;\r\n  MNEMONIC: {\r\n    string: string,\r\n    array: string[],\r\n    verify: number[],\r\n    wordsToVerify: number\r\n  };\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private walletService: WalletService,\r\n    private messageService: MessageService,\r\n    private exportService: ExportService,\r\n    private importService: ImportService,\r\n    private inputValidationService: InputValidationService,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.generateSeed();\r\n  }\r\n  generateSeed() {\r\n    const mnemonic = this.walletService.createNewWallet();\r\n    this.MNEMONIC = {\r\n      string: mnemonic,\r\n      array: mnemonic.split(' '),\r\n      verify: [],\r\n      wordsToVerify: 5\r\n    };\r\n    // shuffle\r\n    const mnemonicLength = this.MNEMONIC.array.length;\r\n    while (this.MNEMONIC.verify.length < this.MNEMONIC.wordsToVerify) {\r\n      const index = Math.floor(Math.random() * Math.floor(mnemonicLength));\r\n      if (!this.MNEMONIC.verify.includes(index)) {\r\n        this.MNEMONIC.verify.push(index);\r\n      }\r\n    }\r\n    this.MNEMONIC.verify.sort((a, b) => a - b);\r\n    this.activePanel++;\r\n  }\r\n  checkWord() {\r\n    this.wordInput = this.wordInput.toLowerCase().trim();\r\n    if (this.wordInput === this.MNEMONIC.array[this.MNEMONIC.verify[0]]) {\r\n      this.MNEMONIC.verify.shift();\r\n      this.wordInput = '';\r\n    }\r\n    if (!this.MNEMONIC.verify) {\r\n      // Remove focus from input box\r\n      document.getElementById('wordInput').blur();\r\n    }\r\n  }\r\n  formatVerifyDescription(index: number): string {\r\n    if (this.MNEMONIC.verify.length === 0) {\r\n      return 'Seed backup has been verified!';\r\n    }\r\n    switch (index) {\r\n      case 1:\r\n      case 21:\r\n        return `Fill in the ${index}st word to verify your seed backup`;\r\n      case 2:\r\n      case 22:\r\n        return `Fill in the ${index}nd word to verify your seed backup`;\r\n      case 3:\r\n      case 23:\r\n        return `Fill in the ${index}rd word to verify your seed backup`;\r\n      default:\r\n        return `Fill in the ${index}th word to verify your seed backup`;\r\n    }\r\n  }\r\n  indexFormat(index: number): string {\r\n    if (this.MNEMONIC.verify.length === 0) {\r\n      return '';\r\n    } else if (index < 0 || index >= this.MNEMONIC.array.length) {\r\n      return '';\r\n    } else {\r\n      return 'Word ' + (index + 1);\r\n    }\r\n  }\r\n  valueFormat(index: number): string {\r\n    if (this.MNEMONIC.verify.length === 0) {\r\n      return '';\r\n    } else if (index < 0 || index > this.MNEMONIC.array.length) {\r\n      return '';\r\n    } else {\r\n      return this.MNEMONIC.array[index];\r\n    }\r\n  }\r\n  verifyView() {\r\n    if (this.MNEMONIC.verify.length) {\r\n      this.activePanel++;\r\n    } else {\r\n      throw new Error('Unexpected verify array');\r\n    }\r\n  }\r\n  pwdView() {\r\n    this.activePanel++;\r\n    this.userMnemonic = '';\r\n  }\r\n\r\n  mnemonicMatch(): boolean {\r\n    return (this.MNEMONIC.string === this.userMnemonic);\r\n  }\r\n  async encryptWallet() {\r\n    if (this.validPwd()) {\r\n      this.messageService.startSpinner('Encrypting wallet...');\r\n      const pwd = this.pwd1;\r\n      this.pwd1 = '';\r\n      this.pwd2 = '';\r\n      const ans = await this.walletService.createEncryptedWallet(this.MNEMONIC.string, pwd, '', true);\r\n      this.seed = ans.seed;\r\n      this.data = ans.data;\r\n      this.pkh = ans.pkh;\r\n      this.pk = ans.pk;\r\n      this.MNEMONIC.string = '';\r\n      this.MNEMONIC.array = [];\r\n      this.MNEMONIC.verify = [];\r\n      this.activePanel++;\r\n      this.messageService.stopSpinner();\r\n      if (document.body.offsetWidth >= 480) {\r\n        this.showTacos = true;\r\n      }\r\n    }\r\n  }\r\n  validPwd(): boolean {\r\n    if (!this.inputValidationService.password(this.pwd1)) {\r\n      this.messageService.addWarning(this.translate.instant('MNEMONICIMPORTCOMPONENT.PASSWORDWEAK'), 5);\r\n      return false;\r\n    } else if (this.pwd1 !== this.pwd2) {\r\n      this.messageService.addWarning(this.translate.instant('MNEMONICIMPORTCOMPONENT.NOMATCHPASSWORDS'), 5);\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n  calcStrength() {\r\n    this.pwdStrength = this.inputValidationService.passwordStrengthDisplay(this.pwd1);\r\n  }\r\n  async done() {\r\n    const seed = this.seed;\r\n    this.seed = null;\r\n    await this.importService.importWalletFromObject(this.data, seed);\r\n    this.walletService.storeWallet();\r\n    this.data = null;\r\n    this.messageService.addSuccess('Your new wallet is now set up and ready to use!');\r\n    this.router.navigate([`/account/${this.walletService.wallet.implicitAccounts[0].address}`]);\r\n  }\r\n  export(): string {\r\n    return JSON.stringify(this.data);\r\n  }\r\n  getPkh(): string {\r\n    return this.pkh;\r\n  }\r\n  download() {\r\n    this.exportService.downloadWallet(this.data);\r\n    this.ekfDownloaded = true;\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Location } from '@angular/common';\r\nimport { MessageService } from '../../services/message/message.service';\r\nimport { TorusService } from '../../services/torus/torus.service';\r\n\r\n@Component({\r\n  selector: 'app-messages',\r\n  templateUrl: './messages.component.html',\r\n  styleUrls: ['./messages.component.scss']\r\n})\r\nexport class MessagesComponent implements OnInit {\r\n  constructor(\r\n    public messageService: MessageService,\r\n    private location: Location,\r\n    public torusService: TorusService\r\n    ) { }\r\n  readonly subject = 'Sent you Tezos tokens';\r\n  ngOnInit() {\r\n  }\r\n  removeMessage(index: number) {\r\n    this.messageService.messages.splice(index, 1);\r\n  }\r\n  getHostName() {\r\n    return location.hostname;\r\n  }\r\n  notifyFormat(message: any) {\r\n    if (message.email) {\r\n      return this.mailtoFormat(message);\r\n    } else if (message.username) {\r\n      return this.redditPmFormat(message);\r\n    } else if (message.twitterId) {\r\n      return this.twitterPmFormat(message);\r\n    } else {\r\n      throw new Error('Invalid message');\r\n    }\r\n  }\r\n  mailtoFormat(message: any): string {\r\n    const subject = encodeURI(this.subject);\r\n    const body = this.encodedBody(message.amount, 'Google', `https://${this.getHostName()}/direct-auth\\n\\n`);\r\n    return `mailto:${message.email}?subject=${subject}&body=${body}`;\r\n  }\r\n  redditPmFormat(message: any) {\r\n    // https://www.reddit.com/message/compose?to=USERNAME&subject=SUBJECT&message=MESSAGE\r\n    const subject = encodeURI(this.subject);\r\n    const body = this.encodedBody(`${message.amount}`, 'Reddit', `[kukai.app](https://${this.getHostName()}/direct-auth)`);\r\n    return `https://www.reddit.com/message/compose?to=${message.username}&subject=${subject}&message=${body}`;\r\n  }\r\n  twitterPmFormat(message: any) {\r\n    // https://twitter.com/messages/compose?recipient_id=USER_ID&text=MESSAGE\r\n    const body = this.encodedBody(message.amount, 'Twitter', `https://${this.getHostName()}/direct-auth`);\r\n    return `https://twitter.com/messages/compose?recipient_id=${message.twitterId}&text=${body}`;\r\n  }\r\n  encodedBody(amount: string, accountType: string, url: string): string {\r\n    const s = (accountType === 'Reddit') ? '  ' : '';\r\n    const b = (accountType === 'Reddit') ? '**' : '';\r\n    const t = (accountType === 'Twitter') ? 'Tezos ' : '';\r\n    return encodeURI(`Hi,${s}\\nI sent you ${b}${amount}${b} using the Kukai wallet.\\n\\nYou can access your ${t}wallet with your ${accountType} account at: ${url}`);\r\n  }\r\n  getAlias(message: any) {\r\n    return message.email ? message.email :\r\n      message.username ? message.username :\r\n      message.handler ? message.handler :\r\n      'recipient';\r\n  }\r\n}\r\n","<div class='msg-container'>\r\n  <div *ngFor=\"let message of messageService.messages ; let i = index\">\r\n    <alert *ngIf=\"!message.timeout\" [type]=\"message.type\">\r\n      <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"removeMessage(i)\">\r\n        <span aria-hidden=\"true\">&times;</span>\r\n      </button>\r\n      <span *ngIf=\"!message.email && !message.username && !message.twitterId && message.msg\">{{ message.msg }}</span>\r\n      <span *ngIf=\"message.email || message.username || message.twitterId\">Click <a target=\"_blank\" href=\"{{ notifyFormat(message) }}\">here to notify</a> {{ getAlias(message) }} via {{ message.msg }}: <b>{{ message.amount }}</b> sent</span>\r\n    </alert>\r\n    <alert *ngIf=\"message.timeout\" [type]=\"message.type\" [dismissOnTimeout]=\"message.timeout\">\r\n      <span *ngIf=\"message.msg\">{{ message.msg }}</span><img *ngIf=\"message.loader\" class=\"loader\" src=\"../../../assets/img/wait.svg\"></alert>\r\n  </div>\r\n</div>","import { Injectable } from '@angular/core';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';  // Multiple instances created ?\r\n\r\nimport { WalletService } from '../wallet/wallet.service';\r\nimport { MessageService } from '../message/message.service';\r\nimport { TzrateService } from '../tzrate/tzrate.service';\r\nimport { OperationService } from '../operation/operation.service';\r\nimport { Account } from '../wallet/wallet';\r\nimport { isNullOrUndefined } from 'util';\r\n\r\n@Injectable()\r\nexport class BalanceService {\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private walletService: WalletService,\r\n    private messageService: MessageService,\r\n    private tzrateService: TzrateService,\r\n    private operationService: OperationService\r\n  ) { }\r\n\r\n  getBalanceAll() {\r\n    for (const account of this.walletService.wallet.getAccounts()) {\r\n      this.getAccountBalance(account);\r\n    }\r\n  }\r\n  getAccountBalance(account: Account) {\r\n    console.log('for ' + account.address);\r\n    this.operationService.getBalance(account.address)\r\n      .subscribe((ans: any) => {\r\n        if (ans.success) {\r\n          this.updateAccountBalance(account, Number(ans.payload.balance));\r\n        } else {\r\n          console.log('Balance Error: ' + JSON.stringify(ans.payload.msg));\r\n        }\r\n      });\r\n  }\r\n  updateAccountBalance(account: Account, newBalance: number) {\r\n    if (account.balanceXTZ === null || account.balanceXTZ === undefined || newBalance !== account.balanceXTZ) {\r\n      account.balanceXTZ = newBalance;\r\n      this.updateTotalBalance();\r\n      this.tzrateService.updateFiatBalances();\r\n      this.walletService.storeWallet();\r\n    }\r\n  }\r\n  updateTotalBalance() {\r\n    let balance = 0;\r\n    let change = false;\r\n    for (const account of this.walletService.wallet.getAccounts()) {\r\n      if (!(account.balanceXTZ === null || account.balanceXTZ === undefined)) {\r\n        balance = balance + Number(account.balanceXTZ);\r\n        change = true;\r\n      }\r\n    }\r\n    if (change) {\r\n      this.walletService.wallet.totalBalanceXTZ = balance;\r\n    }\r\n  }\r\n}\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n  window.console.log = function() {};\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.log(err));\r\n"]}